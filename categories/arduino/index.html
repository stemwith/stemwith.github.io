<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>카테고리: arduino - stemwith</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="stemwith"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="stemwith"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="for stem education"><meta property="og:type" content="blog"><meta property="og:title" content="stemwith"><meta property="og:url" content="http://stemwith.github.io/"><meta property="og:site_name" content="stemwith"><meta property="og:description" content="for stem education"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="http://stemwith.github.io/img/og_image.png"><meta property="article:author" content="chemidot"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://stemwith.github.io"},"headline":"stemwith","image":["http://stemwith.github.io/img/og_image.png"],"author":{"@type":"Person","name":"chemidot"},"publisher":{"@type":"Organization","name":"stemwith","logo":{"@type":"ImageObject","url":"http://stemwith.github.io/img/logo.svg"}},"description":"for stem education"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400&amp;family=Roboto" rel="stylesheet"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-151970975-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-151970975-1');</script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/rss2.xml" title="stemwith" type="application/rss+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="stemwith" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">카테고리</a></li><li class="is-active"><a href="#" aria-current="page">arduino</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-10-30T09:27:53.000Z" title="2019. 10. 30. 오후 5:27:53">2019-10-30</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-20T11:38:45.116Z" title="2021. 9. 20. 오후 7:38:45">2021-09-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">10분안에 읽기 (약 1491 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/30/4WD-Bluetooth/">4WD Bluetooth</a></h1><div class="content"><p>지금까지 배운 RC카, 블루투스 모듈 사용법, 컨트롤러 사용법을 종합하여 Bluetooth로 조종하는 4WD를 만들어 보겠습니다. IR리모트를 사용한 RC카를 베이스로 하여 IR수신부를 빼고, 블루투스 모듈인 HC-06만 연결하면 됩니다.</p>
<br>

<h2 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h2><p><img src="/image/4wd-bt-17.png"></p>
<br>

<h2 id="Bluetooth-Serial-Controller-설정"><a href="#Bluetooth-Serial-Controller-설정" class="headerlink" title="Bluetooth Serial Controller 설정"></a>Bluetooth Serial Controller 설정</h2><p>여기서는 4WD를 블루투스로 조종하기 위한 콘트롤러를 만들어 봅니다.</p>
<br>

<ol>
<li>먼저 Bluetooth Serial Controller를 실행시키세요. (블루투스 페어링이나 앱 설치방법은 이전의 글을 참고하세요.)  아래화면은 TERMINAL Mode인 상태입니다. 여기서 스페너 모양 아이콘을 눌러 PREFERCE로 진입하세요.</li>
</ol>
<p>![](/image/4wd-bt-01.png =432x768)</p>
<br>

<ol start="2">
<li>PREFERENCE 화면에서 아무곳이나 누른 뒤, 위로 스크롤하여</li>
</ol>
<p>![](/image/4wd-bt-02.png =432x768)</p>
<br>

<ol start="3">
<li>9 BUTTON MODE를 활성화 시키고, TERMINAL MODE를 꺼주세요.</li>
</ol>
<p>![](/image/4wd-bt-03.png =432x768)</p>
<br>

<ol start="4">
<li>그러면 이런 화면이 나타납니다. 이제 각각의 버튼을 정의해보겠습니다.</li>
</ol>
<p>![](/image/4wd-bt-04.png =432x768)</p>
<br>

<ol start="5">
<li>다시 스페너 모양 아이콘을 눌러 PREFERENCE로 들어간 뒤, BUTTON-Name을 선택합니다.</li>
</ol>
<p>![](/image/4wd-bt-05.png =432x768)</p>
<br>

<ol start="6">
<li>button2, button4, button5, button6, button8을 각각 누른 뒤, 각 버튼 별로 ‘전진’, ‘왼쪽’, ‘정지’, ‘오른쪽’, ‘후진’이라고 이름을 붙여줍니다.</li>
</ol>
<p>![](/image/4wd-bt-06.png =432x768)</p>
<br>

<ol start="7">
<li>다시 PREFERENCE에서 Command를 누르세요.</li>
</ol>
<p>![](/image/4wd-bt-07.png =432x768)</p>
<br>

<ol start="8">
<li>Command에서 정의해주는 값이 제일 중요한데요. 각 버튼을 누를때, 아두이노로 전달되는 값을 정의해주는 것이기 때문입니다. button2, button4, button5, button6, button8을 각각 누른 뒤, 각 버튼 별로 ‘F’, ‘L’, ‘O’, ‘R’, ‘B’이라고 입력값을 넣어주세요. 이 값은 스케치 작성시 사용해야 하므로 꼭 기억해두어야 합니다.</li>
</ol>
<p>![](/image/4wd-bt-08.png =432x768)</p>
<br>

<ol start="9">
<li>이제 Visibility로 갑니다.</li>
</ol>
<p>![](/image/4wd-bt-09.png =432x768)</p>
<br>

<ol start="10">
<li>여기서는 필요없는 버튼을 지워줄 수 있어요. 실제 사용되는 버튼에만 체크하고, 나머지 버튼은 체크 해제합니다.</li>
</ol>
<p>![](/image/4wd-bt-10.png =432x768)</p>
<br>

<ol start="11">
<li>그러면, 아래와 같은 멋진 블루투스 컨트롤러가 나타납니다.</li>
</ol>
<p>![](/image/4wd-bt-11.png =432x768)</p>
<br>

<ol start="12">
<li>이 상태에서 돋보기 모양 아이콘을 눌러 HC-06에 접속해 봅니다. 여기서부터는 블루투스 페어링 과정에서 설명했던 부분과 똑같습니다. </li>
</ol>
<p>![](/image/4wd-bt-12.png =432x768)</p>
<br>

<ol start="13">
<li>모듈ID인 SKS100을 누르면 페어링을 시도하고요.</li>
</ol>
<p>![](/image/4wd-bt-13.png =432x768)</p>
<br>

<ol start="14">
<li>만일 페어링할 모듈이 나타나지 않으면, Scan for devices로 모듈을 찾아 페어링을 해봅니다.</li>
</ol>
<p>![](/image/4wd-bt-14.png =432x768)</p>
<br>

<ol start="15">
<li>페어링을 시도하는 중이네요.</li>
</ol>
<p>![](/image/4wd-bt-15.png =432x768)</p>
<br>

<ol start="16">
<li>페어링 완료! 이제 컨트롤러 사용을 위한 모든 준비과정이 완료되었습니다.</li>
</ol>
<p>![](/image/4wd-bt-16.png =432x768)</p>
<br>

<br>

<h2 id="4WD-블루투스-초음파센서-자동차"><a href="#4WD-블루투스-초음파센서-자동차" class="headerlink" title="4WD 블루투스 초음파센서 자동차"></a>4WD 블루투스 초음파센서 자동차</h2><p>위 회로에 초음파 센서 하나만 덧붙여봅니다. 50cm 이내에 물체가 접근하면 후진했다가 정지하도록 되어있습니다. (실제로는 50cm보다 훨씬 짧은 거리내에서 후진을 시작하네요.)</p>
<br>

<h3 id="schematic-1"><a href="#schematic-1" class="headerlink" title="schematic"></a>schematic</h3><p><img src="/image/4wd-bt-18.png"></p>
<br>

<h3 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Initialize Bluetooth</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"><span class="function">SoftwareSerial <span class="title">BTSerial</span><span class="params">(<span class="number">7</span>, <span class="number">3</span>)</span></span>;  <span class="comment">// HC-06 TX,RX</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize TB6612FNG Motor drive</span></span><br><span class="line"><span class="keyword">int</span> STBY = <span class="number">10</span>;  <span class="comment">// STBY pin on TB6612FNG. Must be HIGH to enable motor</span></span><br><span class="line"><span class="keyword">int</span> A_PWM = <span class="number">5</span>;  <span class="comment">// Left motor speed control using analogWrite() function. Value between 0 - 255</span></span><br><span class="line"><span class="keyword">int</span> A_IN1 = <span class="number">9</span>;  <span class="comment">// Left motor - LOW should go forward</span></span><br><span class="line"><span class="keyword">int</span> A_IN2 = <span class="number">8</span>;  <span class="comment">// Left motor - HIGH should go forward</span></span><br><span class="line"><span class="keyword">int</span> B_PWM = <span class="number">6</span>;  <span class="comment">// Right motor speed control using analogWrite() function. Value between 0 - 255</span></span><br><span class="line"><span class="keyword">int</span> B_IN1 = <span class="number">11</span>; <span class="comment">// Right motor - LOW should go forward</span></span><br><span class="line"><span class="keyword">int</span> B_IN2 = <span class="number">12</span>; <span class="comment">// Right motor - HIGH should go forward</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> L_MaxSpeed = <span class="number">255</span>;   <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> R_MaxSpeed = <span class="number">255</span>;   <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> L_TurnSpeed = <span class="number">128</span>;  <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> R_TurnSpeed = <span class="number">128</span>;  <span class="comment">//set motor speed to max speed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> LR_Direct = <span class="number">0</span>;      <span class="comment">//for Direction (0:clockwise, 1:count-clockwise)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize Ultrasonic Sensor</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TRIG 2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ECHO 4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> val;</span><br><span class="line"><span class="keyword">long</span> val_distance;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  pinMode(A_PWM, OUTPUT);                        <span class="comment">// Motor</span></span><br><span class="line">  pinMode(A_IN1, OUTPUT);</span><br><span class="line">  pinMode(A_IN2, OUTPUT);</span><br><span class="line">  pinMode(B_PWM, OUTPUT);</span><br><span class="line">  pinMode(B_IN1, OUTPUT);</span><br><span class="line">  pinMode(B_IN2, OUTPUT);</span><br><span class="line">  pinMode(STBY, OUTPUT);</span><br><span class="line">  </span><br><span class="line">  pinMode(TRIG, OUTPUT);                         <span class="comment">// Ultrasonic Sensor</span></span><br><span class="line">  pinMode(ECHO, INPUT);</span><br><span class="line">  </span><br><span class="line">  Serial.begin(<span class="number">9600</span>);</span><br><span class="line">  BTSerial.begin(<span class="number">9600</span>);                          <span class="comment">// Start Bluetooth</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (!BTSerial.available()) &#123;                <span class="comment">// 처음 입력이 있을때까지</span></span><br><span class="line">  stop();                                        <span class="comment">// 정지</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  distance();                                    <span class="comment">// 거리 측정</span></span><br><span class="line">  Serial.println(val_distance);                 <span class="comment">// 거리 출력</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (BTSerial.available()) &#123;                    <span class="comment">// Check for Bluetooth input</span></span><br><span class="line">    val = BTSerial.read();                       <span class="comment">// 입력값 val에 저장</span></span><br><span class="line">    Serial.println(val);                        <span class="comment">// 입력값 출력</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (val_distance &gt; <span class="number">50</span>) &#123;  <span class="comment">// 거리가 50cm 이상이면 입력값 실행</span></span><br><span class="line">    parseCommand(val);                           <span class="comment">// parse the input</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;                                       <span class="comment">// 거리가 50cm 이내이면 </span></span><br><span class="line">    stop();</span><br><span class="line">    delay(<span class="number">20</span>);</span><br><span class="line">    b_stop();                                    <span class="comment">// 거리가 50cm 이상이 될 때까지 후진 후, 정지</span></span><br><span class="line">  &#125;</span><br><span class="line">  delay(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">parseCommand</span><span class="params">(<span class="keyword">char</span> input)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (input) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;F&#x27;</span>:</span><br><span class="line">      go_forward();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>:  </span><br><span class="line">      go_backward();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;L&#x27;</span>:  </span><br><span class="line">      <span class="keyword">if</span>(LR_Direct==<span class="number">0</span>) &#123;</span><br><span class="line">        go_f_left();</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(LR_Direct==<span class="number">1</span>) &#123;</span><br><span class="line">        go_b_left();</span><br><span class="line">      &#125;     </span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;R&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span>(LR_Direct==<span class="number">0</span>) &#123;</span><br><span class="line">        go_f_right();</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(LR_Direct==<span class="number">1</span>) &#123;</span><br><span class="line">        go_b_right();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;O&#x27;</span>:</span><br><span class="line">      stop();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;  </span><br><span class="line">  delay(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">distance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  digitalWrite(TRIG, LOW);                       <span class="comment">// Start Ultrasonic sensor</span></span><br><span class="line">  delayMicroseconds(<span class="number">2</span>);</span><br><span class="line">  digitalWrite(TRIG, HIGH);</span><br><span class="line">  delayMicroseconds(<span class="number">10</span>);</span><br><span class="line">  digitalWrite(TRIG, LOW);</span><br><span class="line"></span><br><span class="line">  val_distance = pulseIn(ECHO, HIGH) / <span class="number">58.2</span>;     <span class="comment">// 거리 측정</span></span><br><span class="line">&#125;       </span><br><span class="line"></span><br><span class="line"><span class="comment">// Move specific motor at speed and direction</span></span><br><span class="line"><span class="comment">// motor: A(Left) -&gt; 0, B(Right) -&gt; 1</span></span><br><span class="line"><span class="comment">// speed: 0 is off, and 255 is full speed</span></span><br><span class="line"><span class="comment">// direction: 0 clockwise, 1 counter-clockwise</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> motorLR, <span class="keyword">int</span> speed, boolean inPin1, boolean inPin2)</span> </span>&#123;</span><br><span class="line">  digitalWrite(STBY, HIGH);        <span class="comment">// Disable Standby</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (motorLR == <span class="number">0</span>) &#123;</span><br><span class="line">    analogWrite(A_PWM, speed);</span><br><span class="line">    digitalWrite(A_IN1, inPin1);</span><br><span class="line">    digitalWrite(A_IN2, inPin2);   </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (motorLR == <span class="number">1</span>) &#123;</span><br><span class="line">    analogWrite(B_PWM, speed);</span><br><span class="line">    digitalWrite(B_IN1, inPin1);</span><br><span class="line">    digitalWrite(B_IN2, inPin2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_forward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;F&quot;</span>);</span><br><span class="line">  move(<span class="number">0</span>, L_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  move(<span class="number">1</span>, R_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  LR_Direct = <span class="number">0</span>;              <span class="comment">// Forward</span></span><br><span class="line">  delay(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_backward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">  move(<span class="number">0</span>, L_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line">  move(<span class="number">1</span>, R_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  LR_Direct = <span class="number">1</span>;              <span class="comment">// Backward</span></span><br><span class="line">  delay(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_f_left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;F_L&quot;</span>);</span><br><span class="line">  move(<span class="number">0</span>, L_TurnSpeed, <span class="number">0</span>, <span class="number">1</span>); <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  move(<span class="number">1</span>, R_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  delay(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_b_left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;B_R&quot;</span>);</span><br><span class="line">  move(<span class="number">0</span>, L_TurnSpeed, <span class="number">1</span>, <span class="number">0</span>); <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line">  move(<span class="number">1</span>, R_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  delay(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_f_right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;F_R&quot;</span>);</span><br><span class="line">  move(<span class="number">0</span>, L_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  move(<span class="number">1</span>, R_TurnSpeed, <span class="number">0</span>, <span class="number">1</span>); <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  delay(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_b_right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;B_R&quot;</span>);</span><br><span class="line">  move(<span class="number">0</span>, L_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line">  move(<span class="number">1</span>, R_TurnSpeed, <span class="number">1</span>, <span class="number">0</span>); <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  delay(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">b_stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;B_STOP&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> (val_distance &lt; <span class="number">50</span>) &#123;                    <span class="comment">// 거리가 50cm 이내인 경우 반복</span></span><br><span class="line">    go_backward();                               <span class="comment">// 후진</span></span><br><span class="line">    delay(<span class="number">100</span>);</span><br><span class="line">    distance();                                  <span class="comment">// 거리를 다시 측정</span></span><br><span class="line">    delay(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (!BTSerial.available()) &#123;                <span class="comment">// 입력이 없으면</span></span><br><span class="line">    stop();                                      <span class="comment">// 정지상태 유지</span></span><br><span class="line">  &#125;</span><br><span class="line">  LR_Direct = <span class="number">0</span>;                                 <span class="comment">// 앞으로 갈 준비</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;STOP&quot;</span>);</span><br><span class="line">  digitalWrite(STBY, LOW);                       <span class="comment">// Enable Standby</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-10-29T09:27:53.000Z" title="2019. 10. 29. 오후 5:27:53">2019-10-29</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-11-01T15:22:05.260Z" title="2021. 11. 1. 오후 11:22:05">2021-11-02</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">24분안에 읽기 (약 3608 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/29/DC%EB%AA%A8%ED%84%B0-4WD-%EC%9E%90%EB%8F%99%EC%B0%A8-%EB%A7%8C%EB%93%A4%EA%B8%B0/">DC모터 + 4WD 자동차 만들기 (TB6612FNG)</a></h1><div class="content"><h3 id="DC모터-사용하기"><a href="#DC모터-사용하기" class="headerlink" title="DC모터 사용하기"></a>DC모터 사용하기</h3><p>아두이노의 5V, 3.3V핀으로는 모터에 필요한 충분한 전압과 전류를 공급하기 어렵다. 그러므로 사용하려는 모터에 맞는 전압과 전류의 공급을 위한 모터드라이버를 사용해야 한다. 아두이노에서 주로 사용하는 모듈은 L293D, L298N와 TB6612FNG 등이 있으며, 여기서는 TB6612FNG 모터드라이버와 함께, 모터 및 아두이노 단독사용을 위하여 별도의 외부전원을 사용한다. <del>외부 전원으로는 모터를 위한 1.5V AA*4개와 함께 아두이노 단독사용을 위한 9V 사각전지(6F22)를 추가로 연결하였다.</del> </p>
<blockquote>
<p>1.5V AA 6개 혹은 3.7V 18650 2개를 직렬로 연결하여 사용하면, 9V 사각전지(6F22)가 필요하지 않으므로 이 방법을 추천한다. 또한 AA 건전지를 사용하는 경우 4WD기준 연속사용시간은 10분 정도뿐일 정도로 전지 소모가 매우 빠르므로, 충전이 가능한 18650 사용을 추천한다.</p>
</blockquote>
<br>

<h4 id="TB6612FNG"><a href="#TB6612FNG" class="headerlink" title="TB6612FNG"></a>TB6612FNG</h4><table>
<thead>
<tr>
<th align="center">VM<br>VCC<br>GND(*)<br>AOUT1<br>AOUT2<br>BOUT2<br>BOUT1<br>GND</th>
<th align="center"><img src="/image/t/tb6612fng-01.png"></th>
<th align="center">PWMA<br>AIN2<br>AIN1<br>STBY<br>BIN1<br>BIN2<br>PWMB<br>GND</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center"><img src="/image/t/tb6612fng-02.png" style="zoom:80%;"></td>
<td align="center"></td>
</tr>
</tbody></table>
<ul>
<li>VM (모터 전압) = 15V max</li>
<li>VCC (로직 전압) = 2.7 ~ 5.5V</li>
<li><strong>GND</strong><ul>
<li>TB6612fng 모듈을 여러개 테스트한 결과, <strong>3번핀 GND</strong>에 연결할 경우 <strong>작동이 안되는</strong> 몇몇 제품이 있었음</li>
<li>그러므로 <strong>8번핀, 9번핀의 GND 사용을 권장</strong>함</li>
</ul>
</li>
<li>출력전류: 정전류 1.2A (3.2A peak)까지 (모터 2개 사용시 합산 전류임)</li>
<li>모터 제어모드: CW, CCW, short-brake, STOP, stand-by</li>
<li>두개의 모터 출력을 개별 제어하며, <strong>100kHz</strong>의 PWM으로 속도 제어</li>
<li>써멀 셧다운 및 저전압 감지회로 내장</li>
</ul>
<br>

<h5 id="Pin의-사용"><a href="#Pin의-사용" class="headerlink" title="Pin의 사용"></a>Pin의 사용</h5><table>
<thead>
<tr>
<th>핀번호</th>
<th>모터드라이브1</th>
<th>아두이노</th>
<th>외부전원</th>
<th>모터 / 역할</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>VM</td>
<td></td>
<td>(+) (DC모터에 사용하는 전압 사용)</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>VCC</td>
<td>+5V</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>GND (사용 비추천)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>A_OUT1</td>
<td></td>
<td></td>
<td>모터A</td>
</tr>
<tr>
<td>5</td>
<td>A_OUT2</td>
<td></td>
<td></td>
<td>모터A</td>
</tr>
<tr>
<td>6</td>
<td>B_OUT2</td>
<td></td>
<td></td>
<td>모터B</td>
</tr>
<tr>
<td>7</td>
<td>B_OUT1</td>
<td></td>
<td></td>
<td>모터B</td>
</tr>
<tr>
<td>8</td>
<td>GND</td>
<td></td>
<td>(-)</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>GND</td>
<td>GND</td>
<td></td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>B_PWM</td>
<td>6</td>
<td></td>
<td>모터B 속도제어</td>
</tr>
<tr>
<td>11</td>
<td>B_IN2</td>
<td>12</td>
<td></td>
<td>모터B 방향제어</td>
</tr>
<tr>
<td>12</td>
<td>B_IN1</td>
<td>11</td>
<td></td>
<td>모터B 방향제어</td>
</tr>
<tr>
<td>13</td>
<td>STBY</td>
<td>10</td>
<td></td>
<td>모터 상태신호</td>
</tr>
<tr>
<td>14</td>
<td>A_IN1</td>
<td>9</td>
<td></td>
<td>모터A 방향제어</td>
</tr>
<tr>
<td>15</td>
<td>A_IN2</td>
<td>8</td>
<td></td>
<td>모터A 방향제어</td>
</tr>
<tr>
<td>16</td>
<td>A_PWM</td>
<td>5</td>
<td></td>
<td>모터A 속도제어</td>
</tr>
</tbody></table>
<ul>
<li>속도제어에 사용하는 A_PWM, B_PWM은 아두이노의 PWM이 가능한 핀에 연결하여야 합니다. 여기서는 ~5, ~6번 핀 사용.</li>
</ul>
<br>


<h5 id="주의-Pin-Map이-다른-모듈의-경우"><a href="#주의-Pin-Map이-다른-모듈의-경우" class="headerlink" title="주의: Pin Map이 다른 모듈의 경우"></a>주의: Pin Map이 다른 모듈의 경우</h5><p>TB6612FNG를 여러 개 구입하여 사용해본 결과, 위의 핀맵과 조금 다른 모듈도 있었다. </p>
<table>
<thead>
<tr>
<th>핀번호</th>
<th>모터드라이브1</th>
<th>아두이노</th>
<th>외부전원</th>
<th>모터 / 역할</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>GND</td>
<td>GND</td>
<td>(-)</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>VCC (2.7~5.5V)</td>
<td>+5V</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>A_OUT1</td>
<td></td>
<td></td>
<td>모터A</td>
</tr>
<tr>
<td>4</td>
<td>A_OUT2</td>
<td></td>
<td></td>
<td>모터A</td>
</tr>
<tr>
<td>5</td>
<td>B_OUT2</td>
<td></td>
<td></td>
<td>모터B</td>
</tr>
<tr>
<td>6</td>
<td>B_OUT1</td>
<td></td>
<td></td>
<td>모터B</td>
</tr>
<tr>
<td>7</td>
<td>VM (15V max)</td>
<td></td>
<td>(+) (DC모터 요구 전압 사용)</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>GND</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>GND</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>B_PWM</td>
<td>6</td>
<td></td>
<td>모터B 속도제어</td>
</tr>
<tr>
<td>11</td>
<td>B_IN2</td>
<td>12</td>
<td></td>
<td>모터B 방향제어</td>
</tr>
<tr>
<td>12</td>
<td>B_IN1</td>
<td>11</td>
<td></td>
<td>모터B 방향제어</td>
</tr>
<tr>
<td>13</td>
<td>NC(STBY)</td>
<td>10</td>
<td></td>
<td>모터 상태신호</td>
</tr>
<tr>
<td>14</td>
<td>A_IN1</td>
<td>9</td>
<td></td>
<td>모터A 방향제어</td>
</tr>
<tr>
<td>15</td>
<td>A_IN2</td>
<td>8</td>
<td></td>
<td>모터A 방향제어</td>
</tr>
<tr>
<td>16</td>
<td>A_PWM</td>
<td>5</td>
<td></td>
<td>모터A 속도제어</td>
</tr>
</tbody></table>
<br>

<h4 id="TB6612FNG와-DC모터의-연결"><a href="#TB6612FNG와-DC모터의-연결" class="headerlink" title="TB6612FNG와 DC모터의 연결"></a>TB6612FNG와 DC모터의 연결</h4><h5 id="Pin-Map"><a href="#Pin-Map" class="headerlink" title="Pin Map"></a>Pin Map</h5><p>TB6612FNG 모터드라이브는 2채널 형태이며, 만일 2WD 자동차를 만든다면 디지털핀 7개가 필요하다. 4개의 DC모터를 사용하여 4WD 자동차를 만드는 방법은 3가지로 나눠 생각해볼 수 있는데, 모든 바퀴를 각각 컨트롤 하는 방법, 왼쪽 바퀴와 오른쪽 바퀴로 나누어 컨트롤 하는 방법, 앞 바퀴와 뒷 바퀴로 나누어 컨트롤 하는 방법 등이 있다.</p>
<ul>
<li>모든 바퀴를 각각 컨트롤 하는 경우 : 모터드라이브 2개와 디지털핀 14개 사용<ul>
<li>그런데, 아두이노에서 실제 사용할 수 있는 디지털핀의 개수가 12개(2~13번)이므로, 2개의 디지털핀이 부족하다.<ul>
<li>아날로그핀을 디지털핀과 동일하게 사용할 수 있으므로, 2개의 아날로그핀을 추가로 사용한다.</li>
<li>또는 스케치 업로드시에만 0,1번 핀을 빼두었다가, 스케치 업로드가 끝나면 0,1번 핀을 사용한다. 이렇게 사용하면 0~13번까지 총 14개의 디지털핀을 확보할 수 있다.</li>
</ul>
</li>
</ul>
</li>
<li><strong>왼쪽과 오른쪽 바퀴로 나누어 컨트롤</strong> 하는 방법 : 디지털핀 7개 사용 (아래 본문에서 사용한 방법)</li>
<li>앞과 뒷 바퀴로 나누어 컨트롤 하는 방법 : 디지털핀 7개 사용. (단, 조향을 위한 추가적인 방법을 고려해야 함.)  </li>
</ul>
<br>

<h4 id="H-SW-Control-Function"><a href="#H-SW-Control-Function" class="headerlink" title="H-SW Control Function"></a>H-SW Control Function</h4><table>
<thead>
<tr>
<th>Input</th>
<th></th>
<th></th>
<th></th>
<th>Output</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>IN1</td>
<td>IN2</td>
<td>PWM</td>
<td>STBY</td>
<td>OUT1</td>
<td>OUT2</td>
<td>Mode</td>
</tr>
<tr>
<td>H</td>
<td>H</td>
<td>H/L</td>
<td>H</td>
<td>L</td>
<td>L</td>
<td>Short Brake</td>
</tr>
<tr>
<td>L</td>
<td>H</td>
<td>H</td>
<td>H</td>
<td>L</td>
<td>H</td>
<td>Count-Clockwise</td>
</tr>
<tr>
<td>L</td>
<td>H</td>
<td>L</td>
<td>H</td>
<td>L</td>
<td>L</td>
<td>Short Brake</td>
</tr>
<tr>
<td>H</td>
<td>L</td>
<td>H</td>
<td>H</td>
<td>H</td>
<td>L</td>
<td>Clockwise</td>
</tr>
<tr>
<td>H</td>
<td>L</td>
<td>L</td>
<td>H</td>
<td>L</td>
<td>L</td>
<td>Short Brake</td>
</tr>
<tr>
<td>L</td>
<td>L</td>
<td>H</td>
<td>H</td>
<td>OFF(High impedance)</td>
<td>OFF(High impedance)</td>
<td>Stop</td>
</tr>
<tr>
<td>H/L</td>
<td>H/L</td>
<td>H/L</td>
<td>L</td>
<td>OFF(High impedance)</td>
<td>OFF(High impedance)</td>
<td>Standby</td>
</tr>
</tbody></table>
<br>

<p>출력 결과는 아래와 같으며,</p>
<ul>
<li>IN1이 LOW, IN2가 HIGH, PWM으로 신호를 출력할 경우 시계 반대 방향(CCW)으로 회전</li>
<li>IN1이 HIGH, IN2가 LOW, PWM으로 신호를 출력할 경우 시계 방향(CW)으로 회전</li>
<li>그 밖의 경우는 모두 stop 상태로 해석하면 된다.</li>
</ul>
<br>

<h3 id="모터-1개-컨트롤하기"><a href="#모터-1개-컨트롤하기" class="headerlink" title="모터 1개 컨트롤하기"></a>모터 1개 컨트롤하기</h3><p>여기서 사용하는 DC모터는 아래의 형태를 가진 기어드모터이며, 아두이노를 사용하여 자동차를 만드는데 많이 사용되는 저렴이 모터이다.</p>
<p><img src="/image/4wd-01.jpg"></p>
<br>

<h4 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h4><h5 id="UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우"><a href="#UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우" class="headerlink" title="UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우"></a>UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우</h5><p><img src="/image/4wd-02.png"></p>
<br>

<h5 id="UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우"><a href="#UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우" class="headerlink" title="UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우"></a>UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우</h5><ul>
<li>UNO 보드의 Vin에 외부전원(7.4V) (+)에 연결: 6.6V~12V 범위의 전원 연결 가능 (7.2V 이상 추천)</li>
<li>UNO 보드의 GND를 TB6612fng 모듈의 GND에 연결</li>
</ul>
<p><img src="/image/4wd-03.png"></p>
<br>

<h4 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> STBY = <span class="number">10</span>;            <span class="comment">// Standby</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Motor A</span></span><br><span class="line"><span class="keyword">int</span> A_PWM = <span class="number">5</span>;            <span class="comment">// Speed Control</span></span><br><span class="line"><span class="keyword">int</span> A_IN1 = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">int</span> A_IN2 = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(STBY, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_PWM, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN2, OUTPUT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, <span class="number">128</span>, <span class="number">0</span>);          <span class="comment">// motor A(right wheels), half speed, moving forward</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);              <span class="comment">// go for 1 second</span></span><br><span class="line">  <span class="built_in">stop</span>();                   <span class="comment">// stop</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">250</span>);               <span class="comment">// hold for 250ms until move again</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, <span class="number">128</span>, <span class="number">1</span>);          <span class="comment">// motor A(right wheels), half speed, moving backward</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">stop</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">250</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> motor, <span class="keyword">int</span> speed, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- Move specific motor at speed and direction</span></span><br><span class="line"><span class="comment">- motor: A -&gt; 1</span></span><br><span class="line"><span class="comment">- speed: 0 is off, and 255 is full speed</span></span><br><span class="line"><span class="comment">= direction: 0 clockwise, 1 counter-clockwise</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, HIGH);        <span class="comment">// Disable Standby</span></span><br><span class="line"></span><br><span class="line">  boolean inPin1 = LOW;            <span class="comment">// Defalut(direction=0) - Clockwise</span></span><br><span class="line">  boolean inPin2 = HIGH;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(direction == <span class="number">1</span>) &#123;             <span class="comment">// Count-clockwise</span></span><br><span class="line">    inPin1 = HIGH;</span><br><span class="line">    inPin2 = LOW;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(motor == <span class="number">1</span>)&#123;                  <span class="comment">// if motor == 1, right wheel</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN1, inPin1);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN2, inPin2);</span><br><span class="line">    <span class="built_in">analogWrite</span>(A_PWM, speed);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;                           <span class="comment">// if motor is not 1, left wheel</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="built_in">stop</span>() &#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, LOW);         <span class="comment">// Enable Standby</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h5 id="회전-방향이-생각했던-방향과-반대로-회전하는-경우"><a href="#회전-방향이-생각했던-방향과-반대로-회전하는-경우" class="headerlink" title="회전 방향이 (생각했던 방향과) 반대로 회전하는 경우"></a>회전 방향이 (생각했던 방향과) 반대로 회전하는 경우</h5><p>A_IN1핀과 A_IN2 핀의 번호를 바꿔준다. 즉, 위 스케치에서</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> A_IN1 = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">int</span> A_IN2 = <span class="number">9</span>;</span><br></pre></td></tr></table></figure>

<p>부분을</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> A_IN1 = <span class="number">9</span>;</span><br><span class="line"><span class="keyword">int</span> A_IN2 = <span class="number">8</span>;</span><br></pre></td></tr></table></figure>

<p>로 바꿔준다.</p>
<br>

<h3 id="4WD-자동차-만들기"><a href="#4WD-자동차-만들기" class="headerlink" title="4WD 자동차 만들기"></a>4WD 자동차 만들기</h3><h4 id="schematic-1"><a href="#schematic-1" class="headerlink" title="schematic"></a>schematic</h4><h5 id="UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우-1"><a href="#UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우-1" class="headerlink" title="UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우"></a>UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우</h5><p><img src="/image/4wd-04.png"></p>
<br>

<h5 id="UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우-1"><a href="#UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우-1" class="headerlink" title="UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우"></a>UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우</h5><ul>
<li>UNO 보드의 Vin에 외부전원(7.4V) (+)에 연결: 6.6V~12V 범위의 전원 연결 가능 (7.2V 이상 추천)</li>
<li>UNO 보드의 GND를 TB6612fng 모듈의 GND에 연결</li>
</ul>
<p><img src="/image/4wd-05.png"></p>
<br>

<h4 id="sketch-1"><a href="#sketch-1" class="headerlink" title="sketch"></a>sketch</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// front wheel : B1 - A1</span></span><br><span class="line"><span class="comment">// rear  wheel : B2 - A2 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> STBY = <span class="number">10</span>;            <span class="comment">// Standby</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Motor A 1 &amp; 2(Right)</span></span><br><span class="line"><span class="keyword">int</span> A_PWM = <span class="number">5</span>;             <span class="comment">// Speed Control</span></span><br><span class="line"><span class="keyword">int</span> A_IN1 = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">int</span> A_IN2 = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Motor B 1 &amp; 2(Left)</span></span><br><span class="line"><span class="keyword">int</span> B_PWM = <span class="number">6</span>;             <span class="comment">// Speed Control</span></span><br><span class="line"><span class="keyword">int</span> B_IN1 = <span class="number">11</span>;</span><br><span class="line"><span class="keyword">int</span> B_IN2 = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(STBY, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_PWM, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN2, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_PWM, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_IN1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_IN2, OUTPUT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, <span class="number">128</span>, <span class="number">0</span>);                  <span class="comment">// motor A(right wheels), half speed, moving forward</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">2</span>, <span class="number">128</span>, <span class="number">0</span>);                  <span class="comment">// motor B(left wheels), half speed, moving forward</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                      <span class="comment">// go for 1 second</span></span><br><span class="line">  <span class="built_in">stop</span>();                           <span class="comment">// stop</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">250</span>);                       <span class="comment">// hold for 250ms until move again</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, <span class="number">128</span>, <span class="number">1</span>);                  <span class="comment">// motor A(right wheels), half speed, moving backward</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">2</span>, <span class="number">128</span>, <span class="number">1</span>);                  <span class="comment">// motor B(left wheels), half speed, moving backward</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">stop</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">250</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> motor, <span class="keyword">int</span> speed, <span class="keyword">int</span> direction)</span> </span>&#123;   <span class="comment">//Move specific motor at speed and direction</span></span><br><span class="line"><span class="comment">//motor: A(Right) -&gt; 1, B(Left) -&gt; 2</span></span><br><span class="line"><span class="comment">//speed: 0 is off, and 255 is full speed</span></span><br><span class="line"><span class="comment">//direction: 0 clockwise, 1 counter-clockwise</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, HIGH);        <span class="comment">// Disable Standby</span></span><br><span class="line"></span><br><span class="line">  boolean inPin1 = LOW;            <span class="comment">// Defalut(direction=0) - Clockwise</span></span><br><span class="line">  boolean inPin2 = HIGH;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(direction == <span class="number">1</span>) &#123;             <span class="comment">// Count-clockwise</span></span><br><span class="line">    inPin1 = HIGH;</span><br><span class="line">    inPin2 = LOW;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(motor == <span class="number">1</span>)&#123;                  <span class="comment">// if motor == 1, right wheel</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN1, inPin1);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN2, inPin2);</span><br><span class="line">    <span class="built_in">analogWrite</span>(A_PWM, speed);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;                         <span class="comment">// if motor is not 1, left wheel</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(B_IN1, inPin1);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(B_IN2, inPin2);</span><br><span class="line">    <span class="built_in">analogWrite</span>(B_PWM, speed);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, LOW);        <span class="comment">// Enable Standby</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h3 id="IR-리모컨으로-4WD-컨트롤하기"><a href="#IR-리모컨으로-4WD-컨트롤하기" class="headerlink" title="IR 리모컨으로 4WD 컨트롤하기"></a>IR 리모컨으로 4WD 컨트롤하기</h3><p>IR리모컨을 사용하여 RC카를 컨트롤 하기 위해서는 모터와 회로에서 발생하는 노이즈를 제거하기 위한 104 케패시터(0.1uF)를 사용하는 것이 원칙입니다. 반드시 사용해야 하는 것은 아니지만, 회로보호를 위해 캐패시터가 있는 경우에는 IR 수신부의 (+)와 (-)에 병렬연결하세요. 이에 더하여 후진시 방향전환도 가능하도록 수정해 봅니다.</p>
<br>

<h4 id="schematic-2"><a href="#schematic-2" class="headerlink" title="schematic"></a>schematic</h4><h5 id="UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우-2"><a href="#UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우-2" class="headerlink" title="UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우"></a>UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우</h5><p><img src="/image/4wd-06.png"></p>
<br>

<h5 id="UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우-2"><a href="#UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우-2" class="headerlink" title="UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우"></a>UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우</h5><p><img src="/image/4wd-07.png"></p>
<br>

<br>

<h4 id="IRremote-라이브러리-추가하기"><a href="#IRremote-라이브러리-추가하기" class="headerlink" title="IRremote 라이브러리 추가하기"></a>IRremote 라이브러리 추가하기</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;boarddefs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;IRremote.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;IRremoteInt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ir_Lego_PF_BitStreamEncoder.h&gt;</span></span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="사용할-리모컨-버튼-HEX값"><a href="#사용할-리모컨-버튼-HEX값" class="headerlink" title="사용할 리모컨 버튼 HEX값"></a>사용할 리모컨 버튼 HEX값</h4><table>
<thead>
<tr>
<th>Remote Button</th>
<th>unsigned int data</th>
<th>define</th>
</tr>
</thead>
<tbody><tr>
<td>▲ (전진 / 속도 증가)</td>
<td>0XFF18E7</td>
<td>BTN_U</td>
</tr>
<tr>
<td>▼ (후진 / 속도 감소)</td>
<td>0XFFA4B5</td>
<td>BTN_D</td>
</tr>
<tr>
<td>◀ (좌회전 / 좌회전각 증가)</td>
<td>0XFF10EF</td>
<td>BTN_L</td>
</tr>
<tr>
<td>▶ (우회전 / 우회전각 증가)</td>
<td>0XFF5AA5</td>
<td>BTN_R</td>
</tr>
<tr>
<td>OK (정지)</td>
<td>0XFF38C7</td>
<td>BTN_O</td>
</tr>
</tbody></table>
<p>보유하고 있는 리모컨의 종류마다 HEX값이 다르므로, HEX값은 다를 수 있습니다. HEX값을 알아내는 방법은 IR Remote를 다루는 페이지를 참고하세요.</p>
<br>

<h4 id="sketch-2"><a href="#sketch-2" class="headerlink" title="sketch"></a>sketch</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Initialize IR remote</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;boarddefs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;IRremote.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;IRremoteInt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ir_Lego_PF_BitStreamEncoder.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> RECV_PIN = <span class="number">13</span>;              <span class="comment">// IR Signal pin</span></span><br><span class="line"><span class="function">IRrecv <span class="title">irrecv</span><span class="params">(RECV_PIN)</span></span>;</span><br><span class="line">decode_results results;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_F 0xFF18E7  <span class="comment">// Forward Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_B 0xFF4AB5  <span class="comment">// Backward Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_L 0xFF10EF  <span class="comment">// Left Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_R 0xFF5AA5  <span class="comment">// Right Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_O 0xFF38C7  <span class="comment">// OK Button</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize TB6612FNG Motor drive</span></span><br><span class="line"><span class="keyword">int</span> STBY = <span class="number">10</span>;  <span class="comment">// STBY pin on TB6612FNG. Must be HIGH to enable motor</span></span><br><span class="line"><span class="keyword">int</span> A_PWM = <span class="number">5</span>;  <span class="comment">// Right motor speed control using analogWrite() function. Value between 0 - 255</span></span><br><span class="line"><span class="keyword">int</span> A_IN1 = <span class="number">9</span>;  <span class="comment">// Right motor - LOW should go forward</span></span><br><span class="line"><span class="keyword">int</span> A_IN2 = <span class="number">8</span>;  <span class="comment">// Right motor - HIGH should go forward</span></span><br><span class="line"><span class="keyword">int</span> B_PWM = <span class="number">6</span>;  <span class="comment">// Left motor speed control using analogWrite() function. Value between 0 - 255</span></span><br><span class="line"><span class="keyword">int</span> B_IN1 = <span class="number">11</span>; <span class="comment">// Left motor - LOW should go forward</span></span><br><span class="line"><span class="keyword">int</span> B_IN2 = <span class="number">12</span>; <span class="comment">// Left motor - HIGH should go forward</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> R_MaxSpeed = <span class="number">255</span>;   <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> L_MaxSpeed = <span class="number">255</span>;   <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> R_TurnSpeed = <span class="number">128</span>;  <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> L_TurnSpeed = <span class="number">128</span>;  <span class="comment">//set motor speed to max speed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> LR_Direct = <span class="number">0</span>;      <span class="comment">//for Direction</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(A_PWM, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN2, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_PWM, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_IN1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_IN2, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(STBY, OUTPUT);</span><br><span class="line">  </span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  irrecv.<span class="built_in">enableIRIn</span>();                           <span class="comment">// Start the receiver</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (irrecv.<span class="built_in">decode</span>(&amp;results)) &#123;                 <span class="comment">// Read IR remote control</span></span><br><span class="line">    <span class="comment">//Serial.println(results.value, HEX);        // for debug</span></span><br><span class="line">    irrecv.<span class="built_in">resume</span>();                             <span class="comment">// Receive the next value</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in"><span class="keyword">switch</span></span>(results.value) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">case</span> BTN_F:</span><br><span class="line">      <span class="built_in">go_forward</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_B:  </span><br><span class="line">      <span class="built_in">go_backward</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_L:  </span><br><span class="line">      <span class="keyword">if</span>(LR_Direct==<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">go_f_left</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(LR_Direct==<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">go_b_left</span>();</span><br><span class="line">      &#125;     </span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_R:</span><br><span class="line">      <span class="keyword">if</span>(LR_Direct==<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">go_f_right</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(LR_Direct==<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">go_b_right</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_O:</span><br><span class="line">      <span class="built_in">stop</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Move specific motor at speed and direction</span></span><br><span class="line"><span class="comment">// motor: A(Right) -&gt; 0, B(Left) -&gt; 1</span></span><br><span class="line"><span class="comment">// speed: 0 is off, and 255 is full speed</span></span><br><span class="line"><span class="comment">// direction: 0 clockwise, 1 counter-clockwise</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> motorLR, <span class="keyword">int</span> speed, boolean inPin1, boolean inPin2)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, HIGH);        <span class="comment">// Disable Standby</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (motorLR == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">analogWrite</span>(A_PWM, speed);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN1, inPin1);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN2, inPin2);   </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (motorLR == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">analogWrite</span>(B_PWM, speed);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(B_IN1, inPin1);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(B_IN2, inPin2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_forward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  LR_Direct = <span class="number">0</span>;              <span class="comment">// Forward</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_backward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line">  LR_Direct = <span class="number">1</span>;              <span class="comment">// Backward</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_f_left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F_L&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_TurnSpeed, <span class="number">0</span>, <span class="number">1</span>); <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_b_left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F_R&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_TurnSpeed, <span class="number">1</span>, <span class="number">0</span>); <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_f_right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F_R&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_TurnSpeed, <span class="number">0</span>, <span class="number">1</span>); <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_b_right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;B_R&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_TurnSpeed, <span class="number">1</span>, <span class="number">0</span>); <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;STOP&quot;</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, LOW);    <span class="comment">// Enable Standby</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h3 id="초음파-센서-장착"><a href="#초음파-센서-장착" class="headerlink" title="초음파 센서 장착"></a>초음파 센서 장착</h3><p>초음파 센서를 장착하여 전진시 일정한 거리 내에  장애물이 있으면 자동차를 멈춰보도록 하겠습니다. Trig는 아두이노 2번핀, Echo는 4번핀에 연결하였습니다.</p>
<br>

<h4 id="schematic-3"><a href="#schematic-3" class="headerlink" title="schematic"></a>schematic</h4><h5 id="UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우-3"><a href="#UNO보드와-컴퓨터를-USB선으로-연결하여-사용할-경우-3" class="headerlink" title="UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우"></a>UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우</h5><p><img src="/image/4wd-08.png"></p>
<br>

<h5 id="UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우-3"><a href="#UNO보드와-컴퓨터의-연결없이-Vin핀을-사용하여-단독으로-사용할-경우-3" class="headerlink" title="UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우"></a>UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우</h5><p><img src="/image/4wd-09.png"></p>
<br>

<h4 id="sketch-3"><a href="#sketch-3" class="headerlink" title="sketch"></a>sketch</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Initialize IR remote</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;boarddefs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;IRremote.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;IRremoteInt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ir_Lego_PF_BitStreamEncoder.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> RECV_PIN = <span class="number">13</span>;       <span class="comment">// IR Signal pin</span></span><br><span class="line"><span class="function">IRrecv <span class="title">irrecv</span><span class="params">(RECV_PIN)</span></span>;</span><br><span class="line">decode_results results;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_F 0xFF18E7  <span class="comment">// Forward Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_B 0xFF4AB5  <span class="comment">// Backward Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_L 0xFF10EF  <span class="comment">// Left Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_R 0xFF5AA5  <span class="comment">// Right Button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BTN_O 0xFF38C7  <span class="comment">// OK Button</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize TB6612FNG Motor drive</span></span><br><span class="line"><span class="keyword">int</span> STBY = <span class="number">10</span>;  <span class="comment">// STBY pin on TB6612FNG. Must be HIGH to enable motor</span></span><br><span class="line"><span class="keyword">int</span> A_PWM = <span class="number">5</span>;  <span class="comment">// Right motor speed control using analogWrite() function. Value between 0 - 255</span></span><br><span class="line"><span class="keyword">int</span> A_IN1 = <span class="number">9</span>;  <span class="comment">// Right motor - LOW should go forward</span></span><br><span class="line"><span class="keyword">int</span> A_IN2 = <span class="number">8</span>;  <span class="comment">// Right motor - HIGH should go forward</span></span><br><span class="line"><span class="keyword">int</span> B_PWM = <span class="number">6</span>;  <span class="comment">// Left motor speed control using analogWrite() function. Value between 0 - 255</span></span><br><span class="line"><span class="keyword">int</span> B_IN1 = <span class="number">11</span>; <span class="comment">// Left motor - LOW should go forward</span></span><br><span class="line"><span class="keyword">int</span> B_IN2 = <span class="number">12</span>; <span class="comment">// Left motor - HIGH should go forward</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> R_MaxSpeed = <span class="number">255</span>;   <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> L_MaxSpeed = <span class="number">255</span>;   <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> R_TurnSpeed = <span class="number">128</span>;  <span class="comment">//set motor speed to max speed</span></span><br><span class="line"><span class="keyword">int</span> L_TurnSpeed = <span class="number">128</span>;  <span class="comment">//set motor speed to max speed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> LR_Direct = <span class="number">0</span>;      <span class="comment">//for Direction</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize Ultrasonic Sensor</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TRIG 2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ECHO 4</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(A_PWM, OUTPUT);                        <span class="comment">// Motor</span></span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(A_IN2, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_PWM, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_IN1, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(B_IN2, OUTPUT);</span><br><span class="line">  <span class="built_in">pinMode</span>(STBY, OUTPUT);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">pinMode</span>(TRIG, OUTPUT);                         <span class="comment">// Ultrasonic Sensor</span></span><br><span class="line">  <span class="built_in">pinMode</span>(ECHO, INPUT);</span><br><span class="line"></span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  irrecv.<span class="built_in">enableIRIn</span>();                           <span class="comment">// Start the receiver</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(TRIG, LOW);                       <span class="comment">// Start Ultrasonic sensor</span></span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(TRIG, HIGH);</span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(TRIG, LOW);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">long</span> distance = <span class="built_in">pulseIn</span>(ECHO, HIGH) / <span class="number">58.2</span>;    <span class="comment">// 거리 측정</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (irrecv.<span class="built_in">decode</span>(&amp;results)) &#123;                 <span class="comment">// Read IR remote control</span></span><br><span class="line">    <span class="comment">//Serial.println(results.value, HEX);        // for debug</span></span><br><span class="line">    irrecv.<span class="built_in">resume</span>(); <span class="comment">// Receive the next value</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (distance &lt; <span class="number">10</span>) &#123;                            <span class="comment">// 거리가 10cm 이내이면 정지</span></span><br><span class="line">    <span class="built_in">stop</span>();</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;                                          <span class="comment">// 거리가 10cm 이상이면,</span></span><br><span class="line">  	<span class="built_in"><span class="keyword">switch</span></span>(results.value) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">case</span> BTN_F:</span><br><span class="line">      <span class="built_in">go_forward</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_B:  </span><br><span class="line">      <span class="built_in">go_backward</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_L:  </span><br><span class="line">      <span class="keyword">if</span>(LR_Direct==<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">go_f_left</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(LR_Direct==<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">go_b_left</span>();</span><br><span class="line">      &#125;     </span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_R:</span><br><span class="line">      <span class="keyword">if</span>(LR_Direct==<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">go_f_right</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(LR_Direct==<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">go_b_right</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">case</span> BTN_O:</span><br><span class="line">      <span class="built_in">stop</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Move specific motor at speed and direction</span></span><br><span class="line"><span class="comment">// motor: A(Right) -&gt; 0, B(Left) -&gt; 1</span></span><br><span class="line"><span class="comment">// speed: 0 is off, and 255 is full speed</span></span><br><span class="line"><span class="comment">// direction: 0 clockwise, 1 counter-clockwise</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> motorLR, <span class="keyword">int</span> speed, boolean inPin1, boolean inPin2)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, HIGH);        <span class="comment">// Disable Standby</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (motorLR == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">analogWrite</span>(A_PWM, speed);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN1, inPin1);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(A_IN2, inPin2);   </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (motorLR == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">analogWrite</span>(B_PWM, speed);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(B_IN1, inPin1);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(B_IN2, inPin2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_forward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  LR_Direct = <span class="number">0</span>;              <span class="comment">// Forward</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_backward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line"></span><br><span class="line">  LR_Direct = <span class="number">1</span>;              <span class="comment">// Backward</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_f_left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F_L&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_TurnSpeed, <span class="number">0</span>, <span class="number">1</span>); <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_b_left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F_R&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_TurnSpeed, <span class="number">1</span>, <span class="number">0</span>); <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_f_right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;F_R&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_TurnSpeed, <span class="number">0</span>, <span class="number">1</span>); <span class="comment">// Right motor, Right Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// Left motor, Left Speed, forward(0,1)</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_b_right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;B_R&quot;</span>);</span><br><span class="line">  <span class="built_in">move</span>(<span class="number">0</span>, R_TurnSpeed, <span class="number">1</span>, <span class="number">0</span>); <span class="comment">// Right motor, Right Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">move</span>(<span class="number">1</span>, L_MaxSpeed, <span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// Left motor, Left Speed, backward(1,0)</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;STOP&quot;</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(STBY, LOW);    <span class="comment">// Enable Standby</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-10-28T13:48:56.000Z" title="2019. 10. 28. 오후 9:48:56">2019-10-28</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-19T00:59:22.862Z" title="2021. 9. 19. 오전 8:59:22">2021-09-19</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">22분안에 읽기 (약 3270 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/28/Arduino-%EB%9D%BC%EC%9D%B8%ED%8A%B8%EB%A0%88%EC%9D%B4%EC%84%9C-L298N/">Arduino, 라인트레이서, L298N</a></h1><div class="content"><h1 id="라인트레이서-만들기"><a href="#라인트레이서-만들기" class="headerlink" title="라인트레이서 만들기"></a>라인트레이서 만들기</h1><p>검은색 라인을 따라 움직이는 라인트레이서 자동차를 만들어보겠습니다.</p>
<br>

<h2 id="TCRT5000-IR-reflective-sensor"><a href="#TCRT5000-IR-reflective-sensor" class="headerlink" title="TCRT5000 IR reflective sensor"></a>TCRT5000 IR reflective sensor</h2><p>라인트레이서 제작시 가장 널리 사용되는 IR 센서입니다. 감지하는 부분이 검은색으로 되어 있는 부분이라면 IR이 모두 흡수되고, 흰색으로 되어 있는 부분에서는 모두 반사되는 원리를 이용합니다.</p>
<p><img src="/image/LT-03.png"></p>
<ul>
<li>  장애물이 없는 경우: 1 반환</li>
<li>  센서와 12mm이내의 거리에 밝은색이 위치하는 경우: 0 반환</li>
<li>  센서와 12mm이내의 거리에 검은색이 위치하는 경우: 1 반환</li>
<li>  검은색의 경우도 아주 가까이 가져가면 적외선 수신량이 증가하여 0의 값을 반환할 수 있으므로, 라인트레이서 구성시 감지하는 적당한 거리를 찾는 것이 중요합니다.</li>
<li>  10~12mm 정도의 거리에서 측정하는 것을 추천</li>
<li>  AO 단자를 이용할 경우 아날로그 신호로 처리도 가능</li>
</ul>
<blockquote>
<p>(위 스펙과는 별도로) 라인트레이서 제작시에는 경험상 센서가 바닥면으로부터 2cm정도 떨어지도록 설치하는 것을 추천합니다. </p>
</blockquote>
<br>

<h3 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h3><p><img src="/image/tcrt5000.png"></p>
<br>

<h3 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> pin_sensor = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(pin_sensor, INPUT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	i = <span class="built_in">digitalRead</span>(pin_sensor)</span><br><span class="line">    Serial.<span class="built_in">println</span>(i);                 <span class="comment">// 검은색(1), 밝은색(0) 출력</span></span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h2 id="모터드라이버-L298N"><a href="#모터드라이버-L298N" class="headerlink" title="모터드라이버 L298N"></a>모터드라이버 L298N</h2><p>자동차 구동에 있어 가장 중요한 것이 모터일 것입니다. 그런데, 대부분의 모터는 구동을 위한 전력값이 커서 아두이노의 자체 출력으로는 구동이 불가능합니다. 그러므로 건전지, SMPS 등의 외부 전원을 사용하여 모터에 충분한 전력을 공급하고, 이를 제어하기위한 모터드라이버를 반드시 사용해야 합니다.</p>
<p>많은 종류의 모터드라이버가 있으나, 아두이노에서 사용하는 대표적인 모터드라이브는 L298N, TB6612FNG 등이 있으며, 여기서는 2CH의 2A출력이 가능한 L298N을 사용하여 간단한 라인트레이서를 제작해보겠습니다.</p>
<p>![](/image/LT-01.png =638x550)</p>
<br>

<h3 id="Pinout"><a href="#Pinout" class="headerlink" title="Pinout"></a>Pinout</h3><ul>
<li><p>모터A 출력 : 왼쪽 모터를 연결한다.</p>
</li>
<li><p>모터B 출력 : 오른쪽 모터를 연결한다.</p>
</li>
<li><p>12V (입력) : 외부전원을 입력한다. (5~35V)</p>
<ul>
<li>12V 이상의 외부전원을 입력하는 경우, 레귤레이터 보호를 위해 5V 점퍼선을 제거해야 함</li>
</ul>
</li>
<li><p>5V (입력/출력)</p>
<ul>
<li>  점퍼핀이 연결되어 있는 경우 5V 출력 (단, 5V출력으로 사용하려면 외부전원을 12V이하로 주어야 하며, 그 이상의 전압을 인가하는 경우 레귤레이터가 손상됨)</li>
<li>점퍼핀 없는 경우 5V 입력을 통해 L298N에 전원 인가</li>
</ul>
</li>
<li><p>Enable 모터A : 왼쪽 모터 PWM (점퍼를 제거하고, INPUT핀 양옆의 핀에 PWM신호 입력)</p>
</li>
<li><p>Enable 모터B : 오른쪽 모터 PWM (점퍼를 제거하고, INPUT핀 양옆의 핀에 PWM신호 입력)</p>
</li>
<li><p>PWM을 사용하는 경우 모터에 인가하는 전원이 6V(AA*4개)인 경우 PWM값이 낮으면 모터가 회전하지 않으므로 코딩시 주의한다.</p>
</li>
<li><p>INPUT : IN1, IN2, IN3, IN4</p>
<table>
<thead>
<tr>
<th>Direction</th>
<th>IN1</th>
<th>IN2</th>
<th>IN3</th>
<th>IN4</th>
</tr>
</thead>
<tbody><tr>
<td>Go</td>
<td>HIGH</td>
<td>HIGH</td>
<td>LOW</td>
<td>LOW</td>
</tr>
<tr>
<td>Back</td>
<td>LOW</td>
<td>LOW</td>
<td>HIGH</td>
<td>HIGH</td>
</tr>
<tr>
<td>Brake</td>
<td>LOW</td>
<td>LOW</td>
<td>LOW</td>
<td>LOW</td>
</tr>
<tr>
<td>Left_Turn</td>
<td>HIGH</td>
<td>LOW</td>
<td>LOW</td>
<td>LOW</td>
</tr>
<tr>
<td>Right_Turn</td>
<td>LOW</td>
<td>HIGH</td>
<td>LOW</td>
<td>LOW</td>
</tr>
<tr>
<td>Left_Back_Turn</td>
<td>LOW</td>
<td>LOW</td>
<td>HIGH</td>
<td>LOW</td>
</tr>
<tr>
<td>Right_Back_Turm</td>
<td>LOW</td>
<td>LOW</td>
<td>LOW</td>
<td>HIGH</td>
</tr>
</tbody></table>
</li>
</ul>
<br>

<h3 id="Jumper"><a href="#Jumper" class="headerlink" title="Jumper"></a>Jumper</h3><ul>
<li>Enable 모터A<ul>
<li>  점퍼를 연결시키지 않으면 PWM사용</li>
<li>  점퍼 연결시 왼쪽 모터에 5V (즉, PWM을 사용하지 않는 경우에만 연결)</li>
</ul>
</li>
<li>Enable 모터B<ul>
<li>  점퍼를 연결시키지 않으면 PWM사용</li>
<li>  점퍼 연결시 오른쪽 모터 5V (즉, PWM을 사용하지 않는 경우에만 연결)</li>
</ul>
</li>
<li>  5V (※ Pinout의 5V 부분 참고)</li>
</ul>
<br>

<h2 id="전원"><a href="#전원" class="headerlink" title="전원"></a>전원</h2><ul>
<li>  대부분의 초보자를 위한 4WD 제작 키트는 AA건전지 4개를 직렬연결할 수 있는 전지소켓을 포함하여 판매하는 경우가 많지만</li>
<li>  But, 제작 경험으로 볼 때 AA건전지 4개로 얻을 수 있는 전력만으로는 원활한 구동이 불가능합니다.</li>
<li>  AA건전지 6개를 직렬로 연결하여 9V정도를 공급하는 것을 추천하며 (사용시간 10~15분정도 가능)</li>
<li>  18650 리튬이온전지 2개를 연결하여 7.4V를 공급하면 가장 좋습니다.</li>
</ul>
<br>

<h2 id="모터"><a href="#모터" class="headerlink" title="모터"></a>모터</h2><p>아두이노 기초 실습용으로 많이 쓰이는 이름없는 중국산 모터입니다.</p>
<p><img src="/image/LT-02.jpg"></p>
<table>
<thead>
<tr>
<th>기어비 48:1</th>
<th>RPM(무부하)</th>
<th>전류 mA (무부하)</th>
<th>토크(kg·cm)</th>
</tr>
</thead>
<tbody><tr>
<td>3V</td>
<td>120</td>
<td>40</td>
<td>3.2</td>
</tr>
<tr>
<td>6V</td>
<td>240</td>
<td>70</td>
<td>5.5</td>
</tr>
</tbody></table>
<br>

<br>

<h1 id="프레임-조립"><a href="#프레임-조립" class="headerlink" title="프레임 조립"></a>프레임 조립</h1><br>

<h2 id="준비물"><a href="#준비물" class="headerlink" title="준비물"></a>준비물</h2><p><img src="/image/LT-04.png"></p>
<br>


<h2 id="조립과정"><a href="#조립과정" class="headerlink" title="조립과정"></a>조립과정</h2><ol>
<li>모터 4개와 M-F형태의 8가닥 리드선을 준비하고 모터에 리드선을 납땜할 준비를 합니다.</li>
</ol>
<p><img src="/image/LT-05.jpg"></p>
<br>

<ol start="2">
<li>DC모터를 보면 양쪽에 (+)(-)극을 연결하는 단자가 있습니다.</li>
</ol>
<p><img src="/image/LT-06.jpg"></p>
<br>

<ol start="3">
<li>준비한 8가닥의 M-F리드선을 2가닥씩 묶어 4갈래로 전체 길이의 1/2의 길이만큼 나누어 준비한뒤,</li>
</ol>
<p><img src="/image/LT-07.jpg"></p>
<br>

<ol start="4">
<li>2개의 가닥 중 한 부분을 모터의 (+)(-)단자에 끼우고,</li>
</ol>
<p><img src="/image/LT-08.jpg"></p>
<br>

<ol start="5">
<li>각각을 납땜합니다. 총 4개의 모터를 납땜하여 아래 모습처럼 만듭니다.</li>
</ol>
<p><img src="/image/LT-09.jpg"></p>
<br>

<p>  ※ (주의) 납땜시, 아래 그림처럼 리드선이 모터의 본체에 닿으면 안됩니다.</p>
<p><img src="/image/LT-10.jpg"></p>
<br>

<p>​     처음 납땜할 때부터 닿지 않도록 하는 것이 좋지만, 납땜을 이미 진행한 후에 리드선이 본체에 닿아 있다면 아래의 그림처럼 끝 부분을 살짝 휘어두거나, 니퍼로 잘라내도록 합니다.</p>
<p><img src="/image/LT-11.jpg"></p>
<br>

<ol start="6">
<li>외부 전원으로 사용할 건전지소켓을 준비합니다. (사진상에는 1.5V AA건전지 4개가 직렬로 연결되는 건전지소켓을 사용하였지만, 4개의 모터를 구동하기 위해서는 1.5V AA건전지를 6개 직렬로 연결하여 9V 전압을 사용하는 것을 추천합니다. 단, 9V사각전지(6F22) 1개로 사용하는 것은 전류가 약하므로 사용불가!)</li>
</ol>
<p><img src="/image/LT-12.jpg"></p>
<br>

<p>​    건전지소켓에 나와있는 리드선의 끝부분을 스트리퍼를 사용하여 피복을 조금더 벗겨냅니다. 또한 빨간색과 검은색 점퍼선 2개를 별로로 준비한뒤, 한쪽 단자를 잘라내고, 스트리퍼로 피복을 벗겨냅니다.</p>
<br>

<ol start="7">
<li>건전지소켓의 리드선과 점퍼선을 붙여 떨어지지 않도록 단단히 납땜한 후,</li>
</ol>
<p><img src="/image/LT-13.jpg"></p>
<br>

<ol start="8">
<li>합선되지 않도록 절연테이프나 열수축튜브로 각각을 잘 감싸둡니다.</li>
</ol>
<p><img src="/image/LT-14.jpg"></p>
<br>

<ol start="9">
<li>이제 아크릴판을 준비합니다.</li>
</ol>
<p><img src="/image/LT-15.jpg"></p>
<br>

<ol start="10">
<li>아래 그림의 Step1~2과정과 같이 모터를 고정할 아크릴 조각을 끼울 것입니다.</li>
</ol>
<p><img src="/image/LT-16.png"></p>
<br>

<p>​    우선, 모터를 고정할 아크릴 조각 2개를 고정할 위치를 확인합니다. 총 4개의 모터를 고정할 것이므로 아크릴 조각 8개가 필요합니다.</p>
<p><img src="/image/LT-17.jpg"></p>
<br>

<ol start="11">
<li>모터고정 아크릴 조각을 아래 사진처럼 끼웁니다. 하나는 구멍에 집어 넣고, 나머지 하나는 측면의 홈에 살짝 걸쳐둡니다.</li>
</ol>
<p><img src="/image/LT-18.jpg"></p>
<br>

<ol start="12">
<li>이제 모터를 설치하겠습니다.</li>
</ol>
<p><img src="/image/LT-19.png"></p>
<br>

<p><img src="/image/LT-20.png"></p>
<br>

<p>​    나사와 너트를 2개씩 준비한 후</p>
<p><img src="/image/LT-21.jpg"></p>
<br>

<p>​    아크릴 조각 2개 사이에 모터를 위치시킨 후, 모터 몸체이 있는 나사 구멍에 나사 2개를 통과시켜</p>
<p><img src="/image/LT-22.jpg"></p>
<br>

<p>​    아래 사진 같이 고정합니다.</p>
<p><img src="/image/LT-23.jpg"></p>
<br>

<p>13. 모터를 고정한 후, 바퀴축의 안쪽 부분에 바퀴의 균형을 잡아줄 동그란 아크릴 조각을 끼워줍니다.</p>
<p><img src="/image/LT-24.jpg"></p>
<br>

<p>​     4개의 모터를 같은 방법으로 고정시켜 아래와 같은 형태를 만듭니다. 주의할 것은 모터의 단자가 위치한 은색부분의 모터본체 부분이 서로 맞닿는 형태로 조립을 해야 합니다.</p>
<p><img src="/image/LT-25.jpg"></p>
<br>

<ol start="14">
<li>바퀴를 끼웁니다.</li>
</ol>
<p><img src="/image/LT-26.png"></p>
<br>

<ol start="15">
<li>금속기둥을 세우고 상판을 덮습니다. (아크릴상판이 없는 경우는 생략 가능)</li>
</ol>
<p><img src="/image/LT-27.png"></p>
<br>

<p><img src="/image/LT-28.png"></p>
<br>

<ol start="16">
<li>기판 아래면에 모터가 위치하도록 위아래를 뒤집은 후에, 기판 윗면에 TCRT5000 IR Reflective Sensor, 아두이노, 브레드보드, L298N 모터드라이브, 9V 전지소켓을 차례대로 올리고 나사볼트와 절연테이프 등으로 고정합니다. 대략 아래 사진과 비슷하게 고정하면 됩니다.</li>
</ol>
<p><img src="/image/LT-29.jpg"></p>
<br>


<h2 id="아두이노와의-연결"><a href="#아두이노와의-연결" class="headerlink" title="아두이노와의 연결"></a>아두이노와의 연결</h2><br>

<h3 id="schematic-1"><a href="#schematic-1" class="headerlink" title="schematic"></a>schematic</h3><p><img src="/image/LT-30.png"></p>
<br>

<h3 id="회로연결"><a href="#회로연결" class="headerlink" title="회로연결"></a>회로연결</h3><br>

<h4 id="모터-↔-모터드라이버"><a href="#모터-↔-모터드라이버" class="headerlink" title="모터 ↔ 모터드라이버"></a>모터 ↔ 모터드라이버</h4><table>
<thead>
<tr>
<th></th>
<th>L/F 모터 U단자</th>
<th>L/F 모터 D단자</th>
<th>L/R 모터 U단자</th>
<th>L/R 모터 D단자</th>
<th>R/F 모터 U단자</th>
<th>R/F 모터 D단자</th>
<th>R/R 모터 U단자</th>
<th>R/R모터 D단자</th>
</tr>
</thead>
<tbody><tr>
<td>L298N OUT1</td>
<td></td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>L298N OUT2</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>L298N OUT3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>○</td>
<td></td>
<td>○</td>
</tr>
<tr>
<td>L298N OUT4</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
</tbody></table>
<br>

<h4 id="모터드라이버-↔-전지소켓-↔-아두이노"><a href="#모터드라이버-↔-전지소켓-↔-아두이노" class="headerlink" title="모터드라이버 ↔ 전지소켓 ↔ 아두이노"></a>모터드라이버 ↔ 전지소켓 ↔ 아두이노</h4><table>
<thead>
<tr>
<th></th>
<th>전지소켓 (+)</th>
<th>전지소켓(-)</th>
<th>아두이노</th>
</tr>
</thead>
<tbody><tr>
<td>L298N 12V</td>
<td>○</td>
<td></td>
<td>Vin</td>
</tr>
<tr>
<td>L298N GND</td>
<td></td>
<td>GND (아두이노)</td>
<td>GND</td>
</tr>
<tr>
<td>L298N 5V</td>
<td></td>
<td></td>
<td>5V</td>
</tr>
</tbody></table>
<br>

<h4 id="모터드라이브-ENABLE-amp-INPUT-↔-아두이노"><a href="#모터드라이브-ENABLE-amp-INPUT-↔-아두이노" class="headerlink" title="모터드라이브 ENABLE &amp; INPUT ↔ 아두이노"></a>모터드라이브 ENABLE &amp; INPUT ↔ 아두이노</h4><table>
<thead>
<tr>
<th></th>
<th>아두이노</th>
</tr>
</thead>
<tbody><tr>
<td>L298N EN(A)</td>
<td>5</td>
</tr>
<tr>
<td>L298N IN1</td>
<td>8</td>
</tr>
<tr>
<td>L298N IN2</td>
<td>9</td>
</tr>
<tr>
<td>L298N IN3</td>
<td>10</td>
</tr>
<tr>
<td>L298N IN4</td>
<td>11</td>
</tr>
<tr>
<td>L298N EN(B)</td>
<td>6</td>
</tr>
</tbody></table>
<br>

<h4 id="TCRT5000-Sensor-↔-아두이노"><a href="#TCRT5000-Sensor-↔-아두이노" class="headerlink" title="TCRT5000 Sensor ↔ 아두이노"></a>TCRT5000 Sensor ↔ 아두이노</h4><table>
<thead>
<tr>
<th></th>
<th>아두이노</th>
</tr>
</thead>
<tbody><tr>
<td>#1 TCRT5000 VCC</td>
<td>5V</td>
</tr>
<tr>
<td>#1 TCRT5000 GND</td>
<td>GND</td>
</tr>
<tr>
<td>#1 TCRT5000 DO</td>
<td>2</td>
</tr>
<tr>
<td>#1 TCRT5000 AO</td>
<td>–</td>
</tr>
<tr>
<td>#2 TCRT5000 VCC</td>
<td>5V</td>
</tr>
<tr>
<td>#2 TCRT5000 GND</td>
<td>GND</td>
</tr>
<tr>
<td>#2 TCRT5000 DO</td>
<td>3</td>
</tr>
<tr>
<td>#2 TCRT5000 AO</td>
<td>–</td>
</tr>
</tbody></table>
<br>

<h3 id="sketch-1"><a href="#sketch-1" class="headerlink" title="sketch"></a>sketch</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* L298N - 2CH Motor Driver</span></span><br><span class="line"><span class="comment">Direction         IN1    IN2    IN3    IN4</span></span><br><span class="line"><span class="comment">-------------------------------------------</span></span><br><span class="line"><span class="comment">GO                HIGH   HIGH   LOW    LOW</span></span><br><span class="line"><span class="comment">BACK              LOW    LOW    HIGH   HIGH</span></span><br><span class="line"><span class="comment">BRAKE             LOW    LOW    LOW    LOW</span></span><br><span class="line"><span class="comment">LEFT_TURN         HIGH   LOW    LOW    LOW</span></span><br><span class="line"><span class="comment">RIGHT_TURN        LOW    HIGH   LOW    LOW</span></span><br><span class="line"><span class="comment">LEFT_BACK_TURN    LOW    LOW    HIGH   LOW</span></span><br><span class="line"><span class="comment">RIGHT_BACK_TURN   LOW    LOW    LOW    HIGH</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">PWM: 6V시 최소값 200이상은 되야 바퀴회전 가능 (너무 낮은 전압에서 회전 안됨)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 모터_전진컨트롤</span></span><br><span class="line"><span class="keyword">int</span> Left_motor_IN1 = <span class="number">8</span>;       <span class="comment">// IN1</span></span><br><span class="line"><span class="keyword">int</span> Right_motor_IN2 = <span class="number">9</span>;      <span class="comment">// IN2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 모터_후진컨트롤</span></span><br><span class="line"><span class="keyword">int</span> Left_motor_IN3 = <span class="number">10</span>;      <span class="comment">// IN3</span></span><br><span class="line"><span class="keyword">int</span> Right_motor_IN4 = <span class="number">11</span>;     <span class="comment">// IN4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 모터_속도컨트롤</span></span><br><span class="line"><span class="keyword">int</span> Left_PWM = <span class="number">5</span>;               <span class="comment">// 왼쪽모터 속도</span></span><br><span class="line"><span class="keyword">int</span> Right_PWM = <span class="number">6</span>;              <span class="comment">// 오른쪽모터 속도</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// IR Sensor</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Left_Sensor = <span class="number">2</span>;    <span class="comment">// 왼쪽센서</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Right_Sensor = <span class="number">3</span>;   <span class="comment">// 오른쪽센서</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Left_Sensor_Value;        <span class="comment">// 검은색:1</span></span><br><span class="line"><span class="keyword">int</span> Right_Sensor_Value;       <span class="comment">// 흰색:0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  pinMode(Left_motor_IN1, OUTPUT);      <span class="comment">// PIN 8</span></span><br><span class="line">  pinMode(Right_motor_IN2, OUTPUT);     <span class="comment">// PIN 9</span></span><br><span class="line">  </span><br><span class="line">  pinMode(Left_motor_IN3, OUTPUT);      <span class="comment">// PIN 10</span></span><br><span class="line">  pinMode(Right_motor_IN4, OUTPUT);     <span class="comment">// PIN 11</span></span><br><span class="line"></span><br><span class="line">  pinMode(Left_PWM, OUTPUT);            <span class="comment">// PIN 5</span></span><br><span class="line">  pinMode(Right_PWM, OUTPUT);           <span class="comment">// PIN 6</span></span><br><span class="line">  </span><br><span class="line">  pinMode(Left_Sensor, INPUT);          <span class="comment">// 왼쪽센서</span></span><br><span class="line">  pinMode(Right_Sensor, INPUT);         <span class="comment">// 오른쪽센서</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 전진</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  digitalWrite(Left_motor_IN1, HIGH);   <span class="comment">// 왼쪽모터   전진_정지</span></span><br><span class="line">  digitalWrite(Right_motor_IN2, HIGH);  <span class="comment">// 오론쪽모터 전진_정지</span></span><br><span class="line">  </span><br><span class="line">  digitalWrite(Left_motor_IN3, LOW);    <span class="comment">// 왼쪽모터   후진_회전</span></span><br><span class="line">  digitalWrite(Right_motor_IN4, LOW);   <span class="comment">// 오른쪽모터 후진_회전</span></span><br><span class="line">  </span><br><span class="line">  analogWrite(Left_PWM, <span class="number">255</span>);           <span class="comment">// PWM값(0~255), 모터 회전속도 조절</span></span><br><span class="line">  analogWrite(Right_PWM, <span class="number">255</span>);          <span class="comment">// PWM값(0~255), 모터 회전속도 조절</span></span><br><span class="line">  delay(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 후진</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">back</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  digitalWrite(Left_motor_IN1, LOW);    <span class="comment">// 왼쪽모터   전진_정지</span></span><br><span class="line">  digitalWrite(Right_motor_IN2, LOW);   <span class="comment">// 오론쪽모터 전진_정지</span></span><br><span class="line">  </span><br><span class="line">  digitalWrite(Left_motor_IN3, HIGH);   <span class="comment">// 왼쪽모터   후진_회전</span></span><br><span class="line">  digitalWrite(Right_motor_IN4, HIGH);  <span class="comment">// 오른쪽모터 후진_회전</span></span><br><span class="line">  </span><br><span class="line">  analogWrite(Left_PWM, <span class="number">255</span>);           <span class="comment">// PWM값(0~255), 모터 회전속도 조절</span></span><br><span class="line">  analogWrite(Right_PWM, <span class="number">255</span>);          <span class="comment">// PWM값(0~255), 모터 회전속도 조절</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 정지</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">brake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  digitalWrite(Left_motor_IN1, LOW);    <span class="comment">// 왼쪽모터   전진_정지</span></span><br><span class="line">  digitalWrite(Right_motor_IN2, LOW);   <span class="comment">// 오론쪽모터 전진_정지</span></span><br><span class="line">  </span><br><span class="line">  digitalWrite(Left_motor_IN3, LOW);    <span class="comment">// 왼쪽모터   후진_정지</span></span><br><span class="line">  digitalWrite(Right_motor_IN4, LOW);   <span class="comment">// 오른쪽모터 후진_정지</span></span><br><span class="line">  delay(<span class="number">5</span>);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 좌회전</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">turn_left</span><span class="params">()</span></span>&#123;</span><br><span class="line">  digitalWrite(Left_motor_IN1, LOW);    <span class="comment">// 왼쪽모터   전진_정지</span></span><br><span class="line">  digitalWrite(Right_motor_IN2, HIGH);  <span class="comment">// 오론쪽모터 전진_회전</span></span><br><span class="line">  </span><br><span class="line">  digitalWrite(Left_motor_IN3, LOW);    <span class="comment">// 왼쪽모터   후진_정지</span></span><br><span class="line">  digitalWrite(Right_motor_IN4, LOW);   <span class="comment">// 오른쪽모터 후진_정지</span></span><br><span class="line"></span><br><span class="line">  analogWrite(Right_PWM, <span class="number">255</span>);           <span class="comment">// PWM값(0~255), 모터 회전속도 조절</span></span><br><span class="line">  delay(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 우회전</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">turn_right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  digitalWrite(Left_motor_IN1, HIGH);   <span class="comment">// 왼쪽모터   전진_회전</span></span><br><span class="line">  digitalWrite(Right_motor_IN2, LOW);   <span class="comment">// 오론쪽모터 전진_정지</span></span><br><span class="line">  </span><br><span class="line">  digitalWrite(Left_motor_IN3, LOW);    <span class="comment">// 왼쪽모터   후진_정지</span></span><br><span class="line">  digitalWrite(Right_motor_IN4, LOW);   <span class="comment">// 오른쪽모터 후진_정지</span></span><br><span class="line"></span><br><span class="line">  analogWrite(Left_PWM, <span class="number">255</span>);           <span class="comment">// PWM값(0~255), 모터 회전속도 조절</span></span><br><span class="line">  delay(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//신호가 있으면(흰색) LOW,  신호가 없으면(검은색) HIGH</span></span><br><span class="line">  Right_Sensor_Value = digitalRead(Right_Sensor);</span><br><span class="line">  Left_Sensor_Value = digitalRead(Left_Sensor);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 전진: 왼쪽센서 검은색, 오른쪽센서 검은색</span></span><br><span class="line">  <span class="keyword">if</span> (Left_Sensor_Value == HIGH &amp;&amp; Right_Sensor_Value == HIGH)</span><br><span class="line">    go();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 좌회전: 왼쪽센서 검은색, 오른쪽센서 흰색</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Left_Sensor_Value == HIGH &amp; Right_Sensor_Value == LOW)</span><br><span class="line">    turn_left();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 우회전: 왼쪽센서 흰색, 오른쪽센서 검은색</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Left_Sensor_Value == LOW &amp; Right_Sensor_Value == HIGH) </span><br><span class="line">    turn_right();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 정지: 왼쪽센서 흰색, 오른쪽센서 흰색</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    brake();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h3 id="센서-감도-조정"><a href="#센서-감도-조정" class="headerlink" title="센서 감도 조정"></a>센서 감도 조정</h3><ul>
<li>  센서 반응을 살피면서 TCRT5000 모듈에 붙어 있는 감도조절기를 십자드라이버로 돌려 라인트레이싱에 가장 최적인 감도를 찾아야 한다.</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-10-26T14:24:07.000Z" title="2019. 10. 26. 오후 10:24:07">2019-10-26</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-20T11:44:00.749Z" title="2021. 9. 20. 오후 7:44:00">2021-09-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">14분안에 읽기 (약 2066 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/26/Arduino-Bluetooth-%ED%8E%98%EC%96%B4%EB%A7%81/">Arduino, Bluetooth 페어링</a></h1><div class="content"><p>아두이노에서 블루투스를 이용하는 방법을 알아보겠습니다.</p>
<br>

<h2 id="Bluetooth-module-선택"><a href="#Bluetooth-module-선택" class="headerlink" title="Bluetooth module 선택"></a>Bluetooth module 선택</h2><ul>
<li><p><strong>아이폰</strong> : MLT-BT05(AT-09) BLE 모듈 사용 (이 모듈은 안드로이도에서도 사용 가능)</p>
<p>HC-06, HC-05는 아이폰에서 SPP(Serial Port Profile) 통신이 지원하지 않는 이유로 사용할 수 없습니다. 그러므로 아이폰으로 블루투스 통신을 하기 위해서는 MLT-BT-BT05, AT-09, CC2541, HM-10, HC-02, RN-42 같은 BLE(Bluetooth Low Energy) 모듈을 사용합니다. 연결방법이나 AT명령어 세트는 HC-06과 비슷해요. 주의 할 점은, 시리얼 모니터에서 <strong>Both NL &amp; CR</strong> 모드를 선택해주어야 하는 것입니다.</p>
</li>
</ul>
<p><img src="/image/BT-01.jpg"></p>
<ul>
<li>  <strong>안드로이드</strong> : HC-06(or HC-05) 블루투스 모듈 사용 (이 모듈은 아이폰에서 사용 불가)</li>
</ul>
<p><img src="/image/BT-02.jpg"></p>
<blockquote>
<p>※ 요즘은 잘 사용하지 않지만, HC-05를 사용하기도 합니다. 생김새가 거의 비슷하지만, 몇가지 차이점이 있는데요. 보통 HC-06과 구별하기 위하여, HC-05에는 칩 위에 V형태로 체크를 해두거나, 화이트로 하얀색 점을 찍어두는 경우가 많습니다. 그리고, 가장 큰 차이점은 HC-05의 경우 6개의 핀이 모두 존재해요.</p>
<p><img src="/image/BT-05.jpg"></p>
</blockquote>
<blockquote>
<p>※ 예전에는 HC-05는 Master, HC-06은 Slave로 나누어 쓰는 경우가 많았지만, HC-06의 버전이 1.7이상인 경우 Master, Slave를 선택하여 사용할 수 있게 되면서 HC-05는 잘 사용하지 않게 되었습니다.</p>
</blockquote>
<br>

<h2 id="MLT-BT05-HC-06을-사용하는-경우"><a href="#MLT-BT05-HC-06을-사용하는-경우" class="headerlink" title="MLT-BT05, HC-06을 사용하는 경우"></a>MLT-BT05, HC-06을 사용하는 경우</h2><br>

<h3 id="Pin-Map"><a href="#Pin-Map" class="headerlink" title="Pin Map"></a>Pin Map</h3><table>
<thead>
<tr>
<th></th>
<th></th>
<th align="center"></th>
<th>Arduino Uno</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>STATE</td>
<td align="center">(실제 핀 없거나 미사용)</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>RXD</td>
<td align="center">Receive Data (수신)</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>TXD</td>
<td align="center">Transmit Data (송신)</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>GND</td>
<td align="center">GND</td>
<td>GND</td>
</tr>
<tr>
<td>5</td>
<td>VCC</td>
<td align="center">+5V</td>
<td>+5V</td>
</tr>
<tr>
<td>6</td>
<td>KEY</td>
<td align="center">(실제 핀 없거나 미사용)</td>
<td></td>
</tr>
</tbody></table>
<br>

<h3 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h3><p><img src="/image/BT-03.jpg"></p>
<br>

<h3 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">SoftwareSerial <span class="title">BTSerial</span><span class="params">(<span class="number">2</span>, <span class="number">3</span>)</span></span>; <span class="comment">//Connect MLT-BT05 or HC-06 TX,RX </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   Serial.begin(<span class="number">9600</span>);</span><br><span class="line">   Serial.println(<span class="string">&quot;Hello!&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// set the data rate for the BT port</span></span><br><span class="line">   BTSerial.begin(<span class="number">9600</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (BTSerial.available())</span><br><span class="line">    Serial.write(BTSerial.read());</span><br><span class="line">  <span class="keyword">if</span> (Serial.available())</span><br><span class="line">    BTSerial.write(Serial.read());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="HC-05를-사용하는-경우"><a href="#HC-05를-사용하는-경우" class="headerlink" title="HC-05를 사용하는 경우"></a>HC-05를 사용하는 경우</h2><br>

<h3 id="Pin-Map-1"><a href="#Pin-Map-1" class="headerlink" title="Pin Map"></a>Pin Map</h3><table>
<thead>
<tr>
<th>HC-05 Pin</th>
<th></th>
<th align="center"></th>
<th>Arduino Uno</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>STATE</td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>RXD</td>
<td align="center">Receive Data</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>TXD</td>
<td align="center">Transmit Date</td>
<td>7</td>
</tr>
<tr>
<td>4</td>
<td>GND</td>
<td align="center">GND</td>
<td>GND</td>
</tr>
<tr>
<td>5</td>
<td>VCC</td>
<td align="center">+5V</td>
<td>+5V</td>
</tr>
<tr>
<td>6</td>
<td>KEY (ENABLE)</td>
<td align="center">AT command 진입을 위한 핀</td>
<td>8</td>
</tr>
</tbody></table>
<blockquote>
<p>※ TXD로 UNO의 7번핀을 사용했으나, HC-06처럼 2번핀을 사용해도 됩니다. 단, schematic과 sketch도 2번 핀에 맞추어 수정해주세요.</p>
</blockquote>
<br>

<h3 id="schematic-1"><a href="#schematic-1" class="headerlink" title="schematic"></a>schematic</h3><p><img src="/image/BT-04.jpg"></p>
<br>

<h3 id="sketch-1"><a href="#sketch-1" class="headerlink" title="sketch"></a>sketch</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KEY 8</span></span><br><span class="line"><span class="function">SoftwareSerial <span class="title">BTSerial</span><span class="params">(<span class="number">7</span>, <span class="number">3</span>)</span></span>; <span class="comment">//Connect HC-05 TX,RX </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   pinMode(KEY, OUTPUT);       <span class="comment">//for HC-05</span></span><br><span class="line">   digitalWrite(KEY, HIGH);</span><br><span class="line">   Serial.begin(<span class="number">9600</span>);</span><br><span class="line">   Serial.println(<span class="string">&quot;Hello!&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// set the data rate for the BT port</span></span><br><span class="line">   BTSerial.begin(<span class="number">38400</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (BTSerial.available())</span><br><span class="line">     Serial.write(BTSerial.read());</span><br><span class="line">   <span class="keyword">if</span> (Serial.available())</span><br><span class="line">     BTSerial.write(Serial.read());</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="블루투스-모듈을-처음-사용하는-경우"><a href="#블루투스-모듈을-처음-사용하는-경우" class="headerlink" title="블루투스 모듈을 처음 사용하는 경우"></a>블루투스 모듈을 처음 사용하는 경우</h2><p>모듈을 처음 사용한다면, AT 명령어 세트를 사용하여 세팅을 해주어야 합니다. 또한 이전에 사용한 경험이 있더라도 블루투스 모듈ID, 페어링 암호 등을 새롭게 세팅할 필요가 있는 경우에도 동일합니다.</p>
<br>

<h3 id="MLT-BT05-AT-09-의-AT-Command"><a href="#MLT-BT05-AT-09-의-AT-Command" class="headerlink" title="MLT-BT05(AT-09)의 AT Command"></a>MLT-BT05(AT-09)의 AT Command</h3><table>
<thead>
<tr>
<th>명령어</th>
<th align="center">Serial Monitor 출력 결과</th>
<th>의미</th>
</tr>
</thead>
<tbody><tr>
<td>AT</td>
<td align="center">OK</td>
<td>접속상태 확인</td>
</tr>
<tr>
<td>AT+NAMESKS100</td>
<td align="center">OKsetname</td>
<td>블루투스 모듈ID 지정 (default MLT-BT05)</td>
</tr>
<tr>
<td>AT+PIN</td>
<td align="center">PASSWORD 출력</td>
<td>패스워드 확인</td>
</tr>
<tr>
<td>AT+PIN1234</td>
<td align="center">OKsetPIN</td>
<td>페어링 암호 설정 (default: <strong>123456</strong>)</td>
</tr>
<tr>
<td>AT+BAUD4</td>
<td align="center">OK9600</td>
<td>통신속도 설정 (4 → 9600bps) (default: 0 → 115200bps)</td>
</tr>
<tr>
<td>AT+VERSION</td>
<td align="center">OKVERSION=4.0</td>
<td>MLT-BT05 버전 확인</td>
</tr>
<tr>
<td>AT+LADDR</td>
<td align="center">+LADDR=(MAC Address)</td>
<td>MAC Address 확인</td>
</tr>
<tr>
<td>AT+ROLE=0</td>
<td align="center">OK+ROLE:0</td>
<td>SLAVE mode (default)</td>
</tr>
<tr>
<td>AT+ROLE=1</td>
<td align="center">OK+ROLE:1</td>
<td>MASTER mode</td>
</tr>
<tr>
<td>AT+ROLE=2</td>
<td align="center">OK+ROLE:2</td>
<td>sensor mode</td>
</tr>
<tr>
<td>AT+ROLE=3</td>
<td align="center">OK+ROLE:3</td>
<td>iBeacon mode</td>
</tr>
<tr>
<td>AT+ROLE=4</td>
<td align="center">OK+ROLE:4</td>
<td>WeChat mode</td>
</tr>
<tr>
<td>AT+ROLE</td>
<td align="center">OK+ROLE:</td>
<td>Role 확인</td>
</tr>
</tbody></table>
<p>※ <a href="/attach/MLT-BT05.pdf">AT Command set 다운로드</a></p>
<br>

<h3 id="HC-06의-AT-Command"><a href="#HC-06의-AT-Command" class="headerlink" title="HC-06의 AT Command"></a>HC-06의 AT Command</h3><table>
<thead>
<tr>
<th>명령어</th>
<th align="center">Serial Monitor 출력 결과</th>
<th>의미</th>
</tr>
</thead>
<tbody><tr>
<td>AT</td>
<td align="center">OK</td>
<td>접속상태 확인</td>
</tr>
<tr>
<td>AT+NAMESKS100</td>
<td align="center">OKsetname</td>
<td>블루투스 모듈ID 지정 (SKS100)</td>
</tr>
<tr>
<td>AT+PIN</td>
<td align="center">PASSWORD출력</td>
<td>패스워드 확인</td>
</tr>
<tr>
<td>AT+PIN1234</td>
<td align="center">OKsetPIN</td>
<td>페어링 암호 설정 (default: <strong>1234</strong>)</td>
</tr>
<tr>
<td>AT+BAUD4</td>
<td align="center">OK9600</td>
<td>통신속도 설정 (4 → 9600bps) (default: 4 → 9600bps)</td>
</tr>
<tr>
<td>AT+VERSION</td>
<td align="center">OKlinvorV1.8</td>
<td>HC-06 버전 확인</td>
</tr>
<tr>
<td>AT+ROLE=S</td>
<td align="center">OK+ROLE:S</td>
<td>SLAVE 역할</td>
</tr>
<tr>
<td>AT+ROLE=M</td>
<td align="center">OK+ROLE:M</td>
<td>MASTER 역할 (v1.7 이상만 가능)</td>
</tr>
<tr>
<td>AT+ROLE</td>
<td align="center">OK+ROLE:</td>
<td>MASTER/SLAVE 확인</td>
</tr>
</tbody></table>
<br>

<h3 id="HC-05의-AT-Command"><a href="#HC-05의-AT-Command" class="headerlink" title="HC-05의 AT Command"></a>HC-05의 AT Command</h3><blockquote>
<p>※ HC-05는 AT Command를 사용하는 경우, KEY(Enable) 핀을 연결해주어야 합니다. (schematic 참고)</p>
</blockquote>
<table>
<thead>
<tr>
<th>명령어</th>
<th align="center">Serial Monitor 출력 결과</th>
<th>의미</th>
</tr>
</thead>
<tbody><tr>
<td>AT</td>
<td align="center">OK</td>
<td>접속상태 확인</td>
</tr>
<tr>
<td>AT+NAMESKS100</td>
<td align="center">OKsetname</td>
<td>블루투스 모듈ID 지정 (SKS100)</td>
</tr>
<tr>
<td>AT+PSWD=0000</td>
<td align="center">OKsetPIN</td>
<td>페어링 암호 설정 (0000)</td>
</tr>
<tr>
<td>AT+BAUD6</td>
<td align="center">OK9600</td>
<td>통신속도 설정 (6 → 38400bps)</td>
</tr>
<tr>
<td>AT+VERSION</td>
<td align="center">OKlinvorV1.8</td>
<td>HC-06 버전 확인</td>
</tr>
<tr>
<td>AT+ROLE=0</td>
<td align="center">OK+ROLE:0</td>
<td>SLAVE 역할</td>
</tr>
<tr>
<td>AT+ROLE=1</td>
<td align="center">OK+ROLE:1</td>
<td>MASTER 역할</td>
</tr>
<tr>
<td>AT+ROLE=?</td>
<td align="center">OK+ROLE:</td>
<td>MASTER/SLAVE 확인</td>
</tr>
</tbody></table>
<br>

<br>

<h1 id="스마트폰과의-페어링-과정"><a href="#스마트폰과의-페어링-과정" class="headerlink" title="스마트폰과의 페어링 과정"></a>스마트폰과의 페어링 과정</h1><br>

<h2 id="시리얼모니터에서"><a href="#시리얼모니터에서" class="headerlink" title="시리얼모니터에서"></a>시리얼모니터에서</h2><p>HC-06과의 페어링 과정을 보도록 하겠습니다. (다른 블루투스 모듈도 유사하게 진행하면 됩니다.)</p>
<br>

<ol>
<li>먼저 아두이노IDE의 시리얼 모니터를 엽니다.</li>
</ol>
<blockquote>
<p>※ 이때, 주의할 점이 있는데요. <strong>시리얼 모니터를 열기 전에 스마트폰과 HC-06의 블루투스 연결은 해제된 상태</strong>여야 합니다. 기존에 HC-06과 스마트폰을 연결한 적이 있다면, 자기도 모르게 블루투스 연결이 자동으로 되어 있을 수 있는데요. 이런 경우에는 시리얼 모니터가 열리지 않아요.</p>
</blockquote>
<ul>
<li>  <strong>MLT-BT05</strong>: 시리얼모니터의 하단에 “<strong>Both NL &amp; CR</strong>”, “9600 보드레이트” 선택</li>
<li>  <strong>HC-06</strong>: 시리얼창의 하단에 “<strong>line ending 없음</strong>”, “9600 보드레이트 선택</li>
<li>  <strong>HC-05</strong>: 시리얼창의 하단에 “<strong>Both NL &amp; CR</strong>”, “9600 보드레이트” 선택</li>
</ul>
<br>

<ol start="2">
<li>위 스케치를 <strong>사용하는 모듈에 맞게 선택하여</strong> 아두이노에 업로드 한 상태에서 시리얼 모니터를 열면, Hello! 라는 글자가 뜹니다. (업로드한 스케치에 따라 Hello!는 안나올 수도 있음)<br><img src="/image/BT-06.jpg"></li>
</ol>
<br>

<ol start="3">
<li>AT를 입력하고,<br><img src="/image/BT-07.jpg"></li>
</ol>
<br>

<ol start="4">
<li>전송을 누르면 OK가 뜹니다. 이것은 아두이노IDE를 통해 블루투스 모듈과 연결이 정상적으로 되었음을 의미해요.<br><img src="/image/BT-08.jpg"></li>
</ol>
<br>

<ol start="5">
<li>블루투스 모듈ID를 설정해보겠습니다. SKS100이라는 ID로 지정하기 위해 <strong>AT+NAMESKS100</strong>이라고 입력한 뒤, 전송을 누릅니다. (모듈ID는 본인이 사용할 이름으로 바꾸어 지정합니다.)<br><img src="/image/BT-09.jpg"></li>
</ol>
<br>

<ol start="6">
<li>그러면 OKsetname이라고 출력이 되면서, 블루투스 모듈ID가 SKS100으로 셋팅이 됩니다.<br><img src="/image/BT-09-1.jpg"></li>
</ol>
<br>

<ol start="7">
<li>이번에는 페어링 암호 설정입니다. AT+PIN0000을 입력하고 전송을 누르면<br><img src="/image/BT-10.jpg"></li>
</ol>
<br>

<ol start="8">
<li>OKsetPIN이 출력되면서 페어링 암호가 0000으로 설정됩니다.<br><img src="/image/BT-11.jpg"></li>
</ol>
<br>

<ol start="9">
<li>통신속도 설정입니다. HC-06은 주로 9600bps를 사용하며, 이를 위해 AT+BAUD4를 입력한 뒤 전송을 누릅니다. (HC-06의 경우 default 속도가 9600bps이므로 이 과정은 생략 가능하며, 다른 모듈을 사용하는 경우에는 각 모듈의 AT Command를 확인하여 통신속도를 변경해주어야 합니다.)<br><img src="/image/BT-12.jpg"></li>
</ol>
<br>

<ol start="10">
<li>OK9600이 출력되요.<br><img src="/image/BT-13.jpg"></li>
</ol>
<br>

<p>여기까지 진행하면 대체적으로 HC-06을 사용할 준비가 된 것입니다.</p>
<br>

<h2 id="스마트폰에서"><a href="#스마트폰에서" class="headerlink" title="스마트폰에서"></a>스마트폰에서</h2><ol>
<li>이제 스마트폰에서 블루투스 모드를 켜세요. (아래 화면은 스마트폰 기종마다 조금은 다를 수 있습니다. 화면이 다르더라도 거의 비슷할 거에요.) 그리고 새로고침을 통해 블루투스 기기를 찾습니다.<br>![](/image/BT-14.png =432x768)</li>
</ol>
<br>

<ol start="2">
<li>‘거의 이용하지 않는 기기’ 하나를 찾았네요. 그곳을 누르면 조금전에 설정한 블루투스 모듈ID인 SKS100이 보입니다. 여기를 누르세요.<br>![](/image/BT-15.png =432x768)</li>
</ol>
<br>

<ol start="3">
<li>블루투스 모듈과 페어링을 하기 위한 암호 입력화면이 나오고, 여기에 AT명령어를 통해 입력한 암호를 넣어줍니다.<br>![](/image/BT-14-1.png =432x768)</li>
</ol>
<br>

<ol start="4">
<li>그러면 스마트폰이 SKS100 모듈에 페어링을 시도합니다.<br>![](/image/BT-16.png =432x768)</li>
</ol>
<br>

<ol start="5">
<li>거의 이용하지 않는 블루투스 기기 부분을 누르면<br>![](/image/BT-17.png =432x768)</li>
</ol>
<br>

<ol start="6">
<li>페어링된 기기 목록에 SKS100이 뜹니다. 여기까지 진행하면, 스마트폰과 블루투스 모듈이 페어링 완료된 거에요.<br>![](/image/BT-18.png =432x768)</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-10-20T14:10:53.000Z" title="2019. 10. 20. 오후 10:10:53">2019-10-20</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-20T11:42:20.286Z" title="2021. 9. 20. 오후 7:42:20">2021-09-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">8분안에 읽기 (약 1233 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/20/Arduino-Bluetooth-Blynk/">Arduino, Bluetooth, Blynk</a></h1><div class="content"><h1 id="Bluetooth-module-설정"><a href="#Bluetooth-module-설정" class="headerlink" title="Bluetooth module 설정"></a>Bluetooth module 설정</h1><p>Arduino, Blutooth 페어링 문서 참고</p>
<br>

<h1 id="Blynk-설정"><a href="#Blynk-설정" class="headerlink" title="Blynk 설정"></a>Blynk 설정</h1><br>

<h2 id="Blynk-라이브러리-설치"><a href="#Blynk-라이브러리-설치" class="headerlink" title="Blynk 라이브러리 설치"></a>Blynk 라이브러리 설치</h2><ol>
<li> docs.blynk.cc 접속 – Downloads – Blynk Library</li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/blynkkk/blynk-library/releases/tag/v0.6.1">https://github.com/blynkkk/blynk-library/releases/tag/v0.6.1</a><ul>
<li>  Blynk_Release_v0.6.1.zip 다운로드</li>
</ul>
</li>
<li> 압축을 풀면 libraries, tools 폴더가 보임</li>
<li>이 두 폴더를 아두이노IDE의 기본 스케치북 위치로 복사하여 붙여넣기 함<ul>
<li>  기존의 libraries 폴더와 합쳐짐</li>
<li>기본 스케치북 위치 확인 방법<ul>
<li>  아두이노IDE – 파일 – 환경설정 – 설정탭 – 스케치북 위치</li>
</ul>
</li>
</ul>
</li>
</ol>
<br>

<h2 id="스마트폰에-Blynk-App-다운로드-하여-설치하기"><a href="#스마트폰에-Blynk-App-다운로드-하여-설치하기" class="headerlink" title="스마트폰에 Blynk App 다운로드 하여 설치하기"></a>스마트폰에 Blynk App 다운로드 하여 설치하기</h2><ul>
<li>  아이폰 : 애플 앱스토어</li>
<li>  안드로이드 : 구글 플레이스토어</li>
</ul>
<br>

<br>

<h1 id="버튼-위젯을-이용한-LED-On-Off-하기"><a href="#버튼-위젯을-이용한-LED-On-Off-하기" class="headerlink" title="버튼 위젯을 이용한 LED On/Off 하기"></a>버튼 위젯을 이용한 LED On/Off 하기</h1><br>

<h2 id="Blynk-계정생성-및-Auth-Token-받기"><a href="#Blynk-계정생성-및-Auth-Token-받기" class="headerlink" title="Blynk 계정생성 및 Auth Token 받기"></a>Blynk 계정생성 및 Auth Token 받기</h2><ol>
<li> Blynk App 실행</li>
<li> Create New Account : 주로 사용하는 e-mail을 사용하여 계정 생성</li>
<li>Blynk에서 New Project 생성<ul>
<li>아이폰용 MLT-BT05의 경우<ul>
<li>  Project Name 설정: BLE Test</li>
<li>  CHOOSE DEVICE: Arduino UNO</li>
<li>  CONNECTION TYPE: BLE</li>
<li>  설정 후 Create 버튼</li>
</ul>
</li>
<li>안드로이드용 HC-06의 경우<ul>
<li>  Project Name 설정: HC-06 Test</li>
<li>  CHOOSE DEVICE: Arduino UNO</li>
<li>  CONNECTION TYPE: Bluetooth</li>
<li>  설정 후 Create 버튼</li>
</ul>
</li>
</ul>
</li>
<li>Auth Token 확인<ul>
<li>  가입시 지정한 이메일로 로그인하여 토큰 확인</li>
<li>  (매우 복잡한 형태의) 토큰을 복사하여 코딩시 사용할 것이므로, 컴퓨터로 확인!</li>
<li>  스마트폰으로 확인하는 것은 무의미함</li>
</ul>
</li>
</ol>
<br>

<h2 id="Blynk-위젯-설정"><a href="#Blynk-위젯-설정" class="headerlink" title="Blynk 위젯 설정"></a>Blynk 위젯 설정</h2><ol>
<li>아이폰용 MLT-BT05를 사용할 경우<ul>
<li>  생성된 프로젝트(BLE Test) 바탕화면으로 진입하면 Blynk App 상단의 초록색 메뉴바의 이름이 BLE Test로 바뀜</li>
<li>  여기서 ⊕버튼 터치한 후 Button위젯과 BLE위젯 추가</li>
<li>추가된 BUTTON 위젯 선택 후 설정<ul>
<li>  OUTPUT: Select pin: Digital D13 / MODE: SWITCH</li>
</ul>
</li>
</ul>
</li>
<li>안드로이드용 HC-06를 사용할 경우<ul>
<li>  생성된 프로젝트(HC-06 Test) 바탕화면으로 진입하면 Blynk App 상단의 초록색 메뉴바의 이름이 HC-06 Test로 바뀜</li>
<li>  여기서 ⊕버튼 터치한 후 Button위젯과 Bluetooth위젯 추가</li>
<li>추가된 BUTTON 위젯 선택 후 설정<ul>
<li>  OUTPUT: Select pin: Digital D13 / MODE: SWITCH</li>
</ul>
</li>
</ul>
</li>
</ol>
<br>

<h2 id="Blynk-연결하기"><a href="#Blynk-연결하기" class="headerlink" title="Blynk 연결하기"></a>Blynk 연결하기</h2><ol>
<li>아두이노 스케치 예제 불러오기<ul>
<li>  파일 – 예제 – Blynk – Boards_USB_Serial – Arduino_SoftwareSerial 선택</li>
<li>  예제의 char auth[] = “YourAuthToken”; 부분을 찾아서 쌍따옴표 사이의 YourAuthToken을 지운 뒤, 이메일에서 복사한 AuthToken 붙여넣기</li>
</ul>
</li>
<li> 아두이노 UNO에 스케치 업로드</li>
<li>스마트폰의 블루투스 기능을 키고,<ul>
<li>아이폰용 MLT-BT05의 경우<ul>
<li>  Bluetooth 모듈 설정에서 설정한 모듈ID 디바이스를 연결(예를 들어 MLT-BT05-<strong>T</strong>) (디폴트 연결PIN 123456)</li>
<li>  Blynk App에서 BLE버튼(블루투스 아이콘 모양) 터치 후 Connect BLE device 버튼을 누른 뒤,</li>
<li>  연결할 디바이스 MLT-BT05-T를 찾은 후 OK버튼 누름</li>
<li>  MLT-BT05-T connected 메시지가 나오면 연결 완료된 것임</li>
</ul>
</li>
<li>안드로이드용 HC-06의 경우<ul>
<li>  Bluetooth 모듈 설정에서 설정한 모듈ID 디바이스를 연결(예를 들어 HC-06-<strong>T</strong> 디바이스를 연결 (디폴트 연결PIN 1234)</li>
<li>  Blynk App에서 Bluetooth버튼(블루투스 아이콘 모양) 터치 후 Connect Bluetooth device 버튼을 누른 뒤,</li>
<li>  연결할 디바이스 HC-06-T를 찾은 후 OK버튼 누름</li>
<li>  HC-06-T connected 메시지가 나오면 연결 완료된 것임</li>
</ul>
</li>
</ul>
</li>
<li>Blynk App 상단의 뒤로 돌아가기 버튼을 누른 뒤, App 오른쪽 상단의 ▷(플레이버튼)버튼을 누름<ul>
<li>  App상단에 빨간색 숫자1이 보이면 아직 연결이 되지 않았다는 것을 의미함</li>
<li>  잠시 기다리면 빨간색 숫자1이 사라지고, 이 상태가 작동 준비가 완료된 것을 의미함</li>
</ul>
</li>
<li> BUTTON 아이콘을 눌러 ON/OFF → 아두이노 Built-in LED ON/OFF</li>
<li> Blynk App 오른쪽 상단의 □(정지버튼)을 누른 뒤, ⊕버튼 터치한 후 Text Input 위젯 추가</li>
</ol>
<br>

<br>


<h1 id="슬라이더-위젯을-이용한-LED-밝기-제어"><a href="#슬라이더-위젯을-이용한-LED-밝기-제어" class="headerlink" title="슬라이더 위젯을 이용한 LED 밝기 제어"></a>슬라이더 위젯을 이용한 LED 밝기 제어</h1><p>Built-in LED가 사용하는 13번핀은 PWM이 지원되지 않으므로, 11번핀을 사용한다.</p>
<p><img src="/image/BT-19.jpg"></p>
<br>

<h2 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h2><p>아두이노 스케치는 그대로 사용 (위의 “Blynk 연결하기” 부분 스케치 참고)</p>
<br>

<h2 id="Blynk-앱-설정"><a href="#Blynk-앱-설정" class="headerlink" title="Blynk 앱 설정"></a>Blynk 앱 설정</h2><ol>
<li> 버튼 위젯을 삭제: 버튼 위젯을 누르고 맨아래쪽으로 내려가서 Delete</li>
<li> Slider 위젯 추가: OUTPUT D11</li>
<li> Slider 위젯의 위치/크기 조절: Slider 위젯 아이콘을 1초이상 누르면 위치/크기를 조절할 수 있음 (가로 크기를 최대로 늘림)</li>
<li> App 오른쪽 상단의 ▷(플레이버튼)버튼을 누름</li>
<li> 슬라이드를 조절하여 LED의 밝기 조절 확인</li>
</ol>
<br>

<br>

<h1 id="과제"><a href="#과제" class="headerlink" title="과제"></a>과제</h1><p>3색 RGB LED를 zeRGBa 위젯으로 조정하여 여러 가지 색깔 만들어보기 (스케치는 위의 스케치를 그대로 사용)</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-10-18T14:46:21.000Z" title="2019. 10. 18. 오후 10:46:21">2019-10-18</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-19T01:01:30.210Z" title="2021. 9. 19. 오전 9:01:30">2021-09-19</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">8분안에 읽기 (약 1158 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/18/Blynk%EC%97%90-%EC%84%BC%EC%84%9C%EA%B0%92-%EC%B6%9C%EB%A0%A5%ED%95%98%EA%B8%B0/">Blynk에 센서값 출력하기</a></h1><div class="content"><h1 id="Blynk에-센서값-출력하기"><a href="#Blynk에-센서값-출력하기" class="headerlink" title="Blynk에 센서값 출력하기"></a>Blynk에 센서값 출력하기</h1><p>원문: <a target="_blank" rel="external nofollow noopener noreferrer" href="http://help.blynk.cc/en/articles/512056-how-to-display-any-sensor-data-in-blynk-app">http://help.blynk.cc/en/articles/512056-how-to-display-any-sensor-data-in-blynk-app</a></p>
<br>

<p>센서값을 Blynk로 출력하기 위해서는 Blynk가 연결되지 않은 상태에서 시리얼모니터에 센서값들을 출력할 수 있어야 한다. ​센서값을 출력하는 코드가 완성되면, 그 다음으로 Blynk에 센서값을 보내는 작업을 시작하는 것이 좋다.</p>
<p>Blynk앱에 센서값을 표시하는 방법에는 크게 두가지 방법이 있으며, 진행중인 프로젝트에 따라 적절한 방법을 선택하면 된다.</p>
<ul>
<li>  PULL : 이 경우에 블링크는 앱이 열려있는 동안에만 Blynk에서 값을 받는다.</li>
<li>  PUSH : 이 경우 하드웨어(아두이노 or ESP32 등)는 Blynk가 오프라인 상태일때도 센서값을 Blynk 서버에 저장하고, 앱을 열어 온라인 상태가 되면 앱으로 전송하여 센서값을 보여준다.</li>
</ul>
<br>

<br>

<h1 id="PULL"><a href="#PULL" class="headerlink" title="PULL"></a>PULL</h1><p>앱에서 센서값을 표시하는 가장 간단한 방법이며, Blynk 앱의 Virtual Pins이 구동중일때 센서값을 가져온다. (Blynk를 닫거나 백그라운드에서 실행될때 데이타는 요청되지 않는다.) 타이머를 사용할 필요가 없으므로 코딩이 단순한 편이지만, 데이터가 서버에 저장되지 않으므로 히스토리 그래프를 볼 수 없다는 단점이 있다.</p>
<br>

<h2 id="Blynk-앱-설정"><a href="#Blynk-앱-설정" class="headerlink" title="Blynk 앱 설정"></a>Blynk 앱 설정</h2><ol>
<li> 새 프로젝트를 만든다. (새로운 Auth Token값이 당신의 이메일에 전송된다)</li>
<li> Value Display 위젯을 추가한다.</li>
<li> 위젯 세팅으로 가서 PIN 항목을 Virtual Pin V5로 설정한다.</li>
<li> Reading Rate를 3초로 설정한다.</li>
</ol>
<br>

<h2 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h2><ol>
<li> Analog Pin에서 값을 (간단하게) 읽어들이는 경우에는 코드를 쓸 필요가 없다. 단지 예제파일을 오픈하여 하드웨어와 커넥션만 변경한다.</li>
<li> e-mail을 체크하여 Auth Token을 확인하고, 스케치에 Auth Token을 수정입력한다.</li>
<li> 하드웨어에 코드를 업로드한다.</li>
<li> Blynk에서 플레이버튼을 누른다.</li>
<li> 값이 표시되는 것을 볼 수 있다.</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BLYNK_READ(V5) &#123; <span class="comment">//Blynk app has something on V5</span></span><br><span class="line">  sensorData = analogRead(A0); <span class="comment">//reading the sensor on A0</span></span><br><span class="line">  Blynk.virtualWrite(V5, sensorData); <span class="comment">//sending to Blynk</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>이 코드는 매시간마다 Blynk가 <code>_READ</code> 요청을 Virtual Pin V5에 보내도록 한다. A0핀에서 센서값을 읽은 후, Blynk에서 Virtual Pin V5에 되돌려 준다.</p>
<br>

<br>

<h1 id="PUSH"><a href="#PUSH" class="headerlink" title="PUSH"></a>PUSH</h1><p>Virtual Pin을 통하여 일정 주기로 하드웨어로부터 센서값을 전송하고, 이때마다 Blynk가 값을 받아들인다.</p>
<p><img src="/image/blynk-sensor.png"></p>
<br>

<h2 id="주의할-점"><a href="#주의할-점" class="headerlink" title="주의할 점"></a>주의할 점</h2><p>void loop() 에서는 센서 값을 보낼 수 없다!!!</p>
<p>만약 void loop()문 내에 어떤 값을 넣게 되면 MCU가 아주 짧은 시간 간격으로 무한 반복하여 실행하게 되는데, Blynk는 인터넷을 통하여 값을 전송할 것이므로 Blynk 클라우드가 하드웨어로부터 오는 계속적인 데이터를 받게 될 것이다. Blynk 클라우드가 이러한 상황을 감지하면 자동적으로 접속을 끊게 된다.</p>
<p>그러므로 데이타를 일정 간격으로 보내야하며, 이를 위해 타이머를 사용하는 방법을 취한다. 일정간격으로 데이타를 보내는 방법에는 여러가지가 있지만, 가장 간단한 방법으로 BlynkTimer의 사용을 권장한다. BlynkTimer는 Blynk 라이브러리 패키지안에 포함되어 있으므로, Blynk 라이브러리만 제대로 설치되었다면 별도의 라이브러리를 설치하지 않아도 된다.</p>
<br>

<h2 id="Blynk-앱-설정-1"><a href="#Blynk-앱-설정-1" class="headerlink" title="Blynk 앱 설정"></a>Blynk 앱 설정</h2><ol>
<li> 새 프로젝트를 만든다. (새로운 Auth Token값이 당신의 이메일에 전송된다)</li>
<li> Value Display 위젯을 추가한다.</li>
<li> 위젯 세팅으로 가서 PIN 항목을 Virtual Pin V5로 설정한다.</li>
<li> Frequency를 PUSH로 설정한다.</li>
</ol>
<br>

<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><ol>
<li>timer라고 하는 BlynkTimer 오브젝트를 만든다.<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BlynkTimer timer; <span class="comment">// Announcing the timer</span></span><br></pre></td></tr></table></figure></li>
</ol>
<br>


<ol start="2">
<li>그 다음으로 일정 간격으로 실행하게 될 함수를 만든다. 이 함수는 A0에 연결된 센서로부터 값을 Virtual Pin V5를 통하여 전송한다.<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myTimerEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  sensorData = analogRead(A0);</span><br><span class="line">  Blynk.virtualWrite(V5, sensorData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<br>


<ol start="3">
<li>setup()문에서, 서브함수 myTimerEvent()가 매 1000ms, 즉 1초 간격으로 실행되도록 선언할 것이다.<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  timer.setInterval(<span class="number">1000L</span>, myTimerEvent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<br>


<ol start="4">
<li>loop문은 다음과 같이 설정한다.<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Blynk.run();</span><br><span class="line">  timer.run(); <span class="comment">// running timer every second</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-10-17T09:27:53.000Z" title="2019. 10. 17. 오후 5:27:53">2019-10-17</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-19T01:01:07.074Z" title="2021. 9. 19. 오전 9:01:07">2021-09-19</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">5분안에 읽기 (약 755 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/17/Bluetooth-%EC%8B%9C%EB%A6%AC%EC%96%BC-%ED%86%B5%EC%8B%A0/">Bluetooth Serial Controller 앱</a></h1><div class="content"><h1 id="Bluetooth-시리얼-통신"><a href="#Bluetooth-시리얼-통신" class="headerlink" title="Bluetooth 시리얼 통신"></a>Bluetooth 시리얼 통신</h1><p>Bluetooth Serial Controller 앱을 통하여 아두이노와 스마트폰 간의 간단한 시리얼 통신을 해보겠습니다. 이를 위해서는 먼저 <a href="2018/10/09/Arduino-Bluetooth-%ED%8E%98%EC%96%B4%EB%A7%81">Bluetooth 페어링</a> 문서를 참고하여 블루투스 모듈과 스마트폰을 페어링 해두어야 합니다. 페어링이 완료된 후 시리얼 통신을 진행합니다.</p>
<br>

<h2 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h2><p><img src="/image/BT-03.jpg"></p>
<br>

<h2 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"><span class="function">SoftwareSerial <span class="title">BTSerial</span><span class="params">(<span class="number">2</span>, <span class="number">3</span>)</span></span>; <span class="comment">//Connect HC-06 TX,RX </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   Serial.begin(<span class="number">9600</span>);</span><br><span class="line">   Serial.println(<span class="string">&quot;Hello!&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// set the data rate for the BT port</span></span><br><span class="line">   BTSerial.begin(<span class="number">9600</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (BTSerial.available())</span><br><span class="line">     Serial.write(BTSerial.read());</span><br><span class="line">   <span class="keyword">if</span> (Serial.available())</span><br><span class="line">     BTSerial.write(Serial.read());</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="스마트폰에-Bluetooth-Serial-Controller-앱-설치하기"><a href="#스마트폰에-Bluetooth-Serial-Controller-앱-설치하기" class="headerlink" title="스마트폰에 Bluetooth Serial Controller 앱 설치하기"></a>스마트폰에 Bluetooth Serial Controller 앱 설치하기</h2><ol>
<li>이제 Google Playstore를 통해서 스마트폰에 Bluetooth Serial Controller 앱을 설치합니다. (iOS는 유사한 프로그램으로 설치)</li>
</ol>
<p>![](/image/BTserialapp-01.png =432x768)</p>
<p>​    비슷한 역할을 하는 수많은 앱들이 있는데, 여러 앱을 설치하고 사용해본 결과, 이 앱이 사용하기에 유연함을 갖고 있는 것 같더군요.</p>
<br>

<p>​    설치되었습니다.</p>
<p>![](/image/BTserialapp-02.png =432x768)</p>
<br>

<ol start="2">
<li>설치 후 처음 실행을 하면, LANDSCAPE 모드(가로모드)로 실행이 되는데요. 그대로 사용해도 무방하지만 PORTRAIT 모드(세로 모드)로 바꿔보겠습니다. 먼저 PREFERENCE를 누르세요.</li>
</ol>
<p>![](/image/BTserialapp-03.png =768x432)</p>
<br>

<ol start="3">
<li>그러면 아래 화면이 뜹니다. 아무곳이나 누르고 위로 스크롤을 하면 아래에 숨겨져 있는 메뉴가 나타나게 되는데요.</li>
</ol>
<p>![](/image/BTserialapp-04.png =768x432)</p>
<br>

<ol start="4">
<li>OPTION - Orientation을 선택한 뒤,</li>
</ol>
<p>![](/image/BTserialapp-05.png =768x432)</p>
<br>

<ol start="5">
<li>PORTRAIT를 누릅니다.</li>
</ol>
<p>![](/image/BTserialapp-06.png =768x432)</p>
<br>

<ol start="6">
<li>이제 세로모드로 나타나요. 이제 HC-06모듈과 스마트폰과의 Serial 통신을 해보도록 하겠습니다. 다시 PREFERENCE를 누르고, TERMINAL MODE를 활성화 시키세요.</li>
</ol>
<p>![](/image/BTserialapp-07.png =432x768)</p>
<br>

<ol start="7">
<li>아래 화면이 TERMINAL Mode 화면입니다. 여기서 돋보기 모양을 누르고,</li>
</ol>
<p>![](/image/BTserialapp-08.png =432x768)</p>
<br>

<ol start="8">
<li>Paired Devices 목록에서 SKS100을 선택하세요. 그러면 TERMINAL이 HC-06에 접속하여, 서로간 통신할 수 있는 상태가 됩니다. </li>
</ol>
<p>![](/image/BTserialapp-09.png =432x768)</p>
<br>

<p>​    만일, 아래와 같이 Paired Devices 목록이 없으면, Scan for devices를 눌러 HC-06을 찾아보세요.</p>
<p>![](/image/BTserialapp-10.png =432x768)</p>
<br>

<ol start="9">
<li>TERMINAL이 SKS100에 접속을 시도합니다.</li>
</ol>
<p>![](/image/BTserialapp-11.png =432x768)</p>
<br>

<ol start="10">
<li>접속 완료!</li>
</ol>
<p>![](/image/BTserialapp-12.png =432x768)</p>
<br>

<h2 id="터미널과-Serial-통신하기"><a href="#터미널과-Serial-통신하기" class="headerlink" title="터미널과 Serial 통신하기"></a>터미널과 Serial 통신하기</h2><ol>
<li>이제 터미널 창에 Test를 입력하고 SEND를 눌러보세요.</li>
</ol>
<p>![](/image/BTserialapp-13.png =432x768)</p>
<br>

<ol start="2">
<li>그러면 화면에 Test가 출력됨과 동시에,</li>
</ol>
<p>![](/image/BTserialapp-14.png =432x768)</p>
<br>

<p>​     시리얼 모니터에 Test가 출력됩니다. 즉, TERMINAL에서 입력한 Test라는 글자가 HC-06을 통해, 아두이노와 연결되어 있는 컴퓨터의 시리얼 모니터에 출력된 것이에요.</p>
<p><img src="/image/BTserialapp-15.jpg"></p>
<br>

<ol start="3">
<li>이번에는 반대로 시리얼 모니터에 Good morning! 을 입력하고 전송을 누르면</li>
</ol>
<p>![](/image/BTserialapp-16.png =432x768)</p>
<br>

<p>​    스마트폰의 TERMINAL에 Good morning! 이 출력됩니다.</p>
<p><img src="/image/BTserialapp-17.jpg"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2018-11-30T09:27:53.000Z" title="2018. 11. 30. 오후 5:27:53">2018-11-30</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-19T01:05:44.067Z" title="2021. 9. 19. 오전 9:05:44">2021-09-19</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">5분안에 읽기 (약 767 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/11/30/Processing-%EA%B8%B0%EC%B4%88/">Processing 기초</a></h1><div class="content"><h1 id="Processing"><a href="#Processing" class="headerlink" title="Processing"></a>Processing</h1><ul>
<li>processing.org 에서 다운로드 (<a target="_blank" rel="external nofollow noopener noreferrer" href="https://processing.org/download/">다운로드 페이지</a>)</li>
<li>arduino sketch는 C++기반이고, processing sketch는 java기반입니다.</li>
</ul>
<br>

<h2 id="processing-sketch-예제"><a href="#processing-sketch-예제" class="headerlink" title="processing sketch 예제"></a>processing sketch 예제</h2><br>

<ol>
<li>예제1 : 프로세싱 윈도우 크기, 배경색, 점, 선, 사각형, 원, 텍스트, 폰트, 사진 입력</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line">  background(<span class="number">100</span>);        <span class="comment">// background(0,255,0);</span></span><br><span class="line">  strokeWeight(<span class="number">10</span>);       <span class="comment">// dot/line width</span></span><br><span class="line">  stroke(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>,<span class="number">100</span>);    <span class="comment">// dot/line color and transparency, noStroke();</span></span><br><span class="line">  point(<span class="number">200</span>,<span class="number">200</span>);         <span class="comment">// draw dot</span></span><br><span class="line">  line(<span class="number">0</span>,<span class="number">0</span>,<span class="number">200</span>,<span class="number">150</span>);      <span class="comment">// draw line</span></span><br><span class="line">  ellipse(<span class="number">300</span>,<span class="number">300</span>,<span class="number">50</span>,<span class="number">80</span>); <span class="comment">// draw circle(x,y,xr,yr)</span></span><br><span class="line">  fill(<span class="number">0</span>);                <span class="comment">// rect/text color, nofill();</span></span><br><span class="line">  rect(<span class="number">100</span>,<span class="number">250</span>,<span class="number">150</span>,<span class="number">300</span>);  <span class="comment">// draw rectangle(x1,y1,x2,y2)</span></span><br><span class="line">  </span><br><span class="line">  textSize(<span class="number">20</span>);</span><br><span class="line">  PFont font = createFont(<span class="string">&quot;NanumGothic&quot;</span>, <span class="number">32</span>);</span><br><span class="line">  textFont(font);</span><br><span class="line">  text(<span class="string">&quot;Hello World!&quot;</span>,<span class="number">200</span>,<span class="number">100</span>); <span class="comment">// text(string,x1,y2)</span></span><br><span class="line"></span><br><span class="line">  PImage img = loadImage(<span class="string">&quot;sks.jpg&quot;</span>);  <span class="comment">// file in &#x27;/sketch_XXXXXXa/data/&#x27; folder</span></span><br><span class="line">  image(img,<span class="number">20</span>,<span class="number">50</span>);       <span class="comment">// image(img,x,y,width,height);</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<ol start="2">
<li>예제2 : 마우스와 키보드 이벤트</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mousePressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(mouseButton == LEFT) &#123;</span><br><span class="line">    println(<span class="string">&quot;left button Pressed!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(mouseButton == RIGHT) &#123;</span><br><span class="line">    println(<span class="string">&quot;right button Pressed!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(mouseButton == CENTER) &#123;</span><br><span class="line">    println(<span class="string">&quot;center button Pressed!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">keyPressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  println(<span class="string">&quot;key Pressed!&quot;</span>);   <span class="comment">// Key event</span></span><br><span class="line">  println(key);              <span class="comment">// Key String</span></span><br><span class="line">  println(keyCode);          <span class="comment">// ASCII Code</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseReleased</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  println(<span class="string">&quot;button Released!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">keyReleased</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  println(<span class="string">&quot;key Released!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseClicked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  println(<span class="string">&quot;button Clicked!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseMoved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  println(<span class="string">&quot;mouse Moved!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseDragged</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  println(<span class="string">&quot;mouse Dragged!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseWheel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  println(<span class="string">&quot;mouse Wheel!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<ol start="3">
<li>예제3 : 마우스 움직이는 대로 원 그리기</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseMoved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  ellipse(mouseX,mouseY,<span class="number">50</span>,<span class="number">50</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<ol start="4">
<li>예제4 : 자유선 그리기</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseMoved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  line(pmouseX,pmouseY,mouseX,mouseY);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h1 id="Arduino와-Processing을-통해-arduino-보드의-기본-led-blink-하기"><a href="#Arduino와-Processing을-통해-arduino-보드의-기본-led-blink-하기" class="headerlink" title="Arduino와 Processing을 통해 arduino 보드의 기본 led blink 하기"></a>Arduino와 Processing을 통해 arduino 보드의 기본 led blink 하기</h1><br>

<h2 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h2><p>아두이노의 기본 LED를 사용할 것이므로 별도의 회로 연결없이 아두이노만 연결한다.</p>
<br>

<h2 id="library-등록"><a href="#library-등록" class="headerlink" title="library 등록"></a>library 등록</h2><ol>
<li><p>아두이노 사이트에서 프로세싱 라이브러리를 다운받은 후</p>
</li>
<li><p>압축을 풀었을 때 나오는 arduino폴더를 c:\Users\userID\processing\libraries\ 폴더에 복사한다.</p>
</li>
<li><p>프로세싱 프로그램에서 <code>스케치</code> → <code>내부라이브러리</code> → <code>Arduino (firmata)</code>를 선택하면,</p>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cc.arduino.*;</span><br><span class="line"><span class="keyword">import</span> org.firmata.*;</span><br><span class="line"><span class="keyword">import</span> processing.serial.*;</span><br></pre></td></tr></table></figure>

<p>가 등록된다.</p>
<br>

<h2 id="processing-sketch"><a href="#processing-sketch" class="headerlink" title="processing sketch"></a>processing sketch</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cc.arduino.*;</span><br><span class="line"><span class="keyword">import</span> org.firmata.*;</span><br><span class="line"><span class="keyword">import</span> processing.serial.*;</span><br><span class="line"></span><br><span class="line">Arduino arduino;</span><br><span class="line"><span class="keyword">int</span> ledPin = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line">  println(Arduino.list());</span><br><span class="line">  arduino = <span class="keyword">new</span> Arduino(<span class="keyword">this</span>, Arduino.list()[<span class="number">0</span>], <span class="number">57600</span>); <span class="comment">// Arduino.list()[0] or &quot;COM3&quot;</span></span><br><span class="line">  arduino.pinMode(ledPin, Arduino.OUTPUT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  arduino.digitalWrite(ledPin, Arduino.HIGH);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  arduino.digitalWrite(ledPin, Arduino.LOW);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="arduino-sketch"><a href="#arduino-sketch" class="headerlink" title="arduino sketch"></a>arduino sketch</h2><ol>
<li><p>arduino IDE에서 <code>파일</code> → <code>예제</code> → <code>firmata</code> → <code>standard firmata</code>를 불러들인 후</p>
</li>
<li><p>컴파일하고 업로드한다.</p>
</li>
</ol>
<br>

<h2 id="processing에서-실행하기"><a href="#processing에서-실행하기" class="headerlink" title="processing에서 실행하기"></a>processing에서 실행하기</h2><ol>
<li><p>processing에서 실행버튼을 눌러 실행해보기</p>
</li>
<li><p><code>파일</code> → <code>어플리케이션으로 내보내기</code>를 선택하여 윈도우, Mac, Linux용 실행파일을 만들어보기</p>
</li>
</ol>
<p>※ 어플리케이션으로 내보내기를 하기전에 processing sketch를 저장하여야 한다.</p>
<br>

<br>

<h1 id="Processing으로-led-제어하기"><a href="#Processing으로-led-제어하기" class="headerlink" title="Processing으로 led 제어하기"></a>Processing으로 led 제어하기</h1><br>

<h2 id="processing-sketch-사각형-스위치"><a href="#processing-sketch-사각형-스위치" class="headerlink" title="processing sketch : 사각형 스위치"></a>processing sketch : 사각형 스위치</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cc.arduino.*;</span><br><span class="line"><span class="keyword">import</span> org.firmata.*;</span><br><span class="line"><span class="keyword">import</span> processing.serial.*;</span><br><span class="line"></span><br><span class="line">Arduino arduino;</span><br><span class="line"><span class="keyword">int</span> ledPin = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line">  background(<span class="number">0</span>);</span><br><span class="line">  fill(<span class="number">255</span>);</span><br><span class="line">  noStroke();</span><br><span class="line">  rect(width/<span class="number">2</span>, <span class="number">0</span>, width/<span class="number">2</span>, height);</span><br><span class="line">  text(<span class="string">&quot;LED OFF&quot;</span>, <span class="number">30</span>, <span class="number">30</span>);</span><br><span class="line">  fill(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  text(<span class="string">&quot;LED ON&quot;</span>, <span class="number">230</span>, <span class="number">30</span>);</span><br><span class="line">  </span><br><span class="line">  println(Arduino.list());</span><br><span class="line">  arduino = <span class="keyword">new</span> Arduino(<span class="keyword">this</span>, Arduino.list()[<span class="number">0</span>], <span class="number">57600</span>);</span><br><span class="line">  arduino.pinMode(ledPin, Arduino.OUTPUT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseMoved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(mouseX &lt; width/<span class="number">2</span>) &#123;</span><br><span class="line">    arduino.digitalWrite(ledPin, Arduino.LOW);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    arduino.digitalWrite(ledPin, Arduino.HIGH);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="processing-sketch-그라데이션-가변저항"><a href="#processing-sketch-그라데이션-가변저항" class="headerlink" title="processing sketch : 그라데이션 가변저항"></a>processing sketch : 그라데이션 가변저항</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cc.arduino.*;</span><br><span class="line"><span class="keyword">import</span> org.firmata.*;</span><br><span class="line"><span class="keyword">import</span> processing.serial.*;</span><br><span class="line"></span><br><span class="line">Arduino arduino;</span><br><span class="line"><span class="keyword">int</span> ledPin = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;width; i++) &#123;</span><br><span class="line">    stroke(map(i, <span class="number">0</span>, width-<span class="number">1</span>, <span class="number">0</span>, <span class="number">255</span>)); <span class="comment">// 색깔을 점차 변화시키면서</span></span><br><span class="line">    line(i, <span class="number">0</span>, i, height);              <span class="comment">// 선을 그려, 그라데이션 효과를 만들어 냄</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  println(Arduino.list());</span><br><span class="line">  arduino = <span class="keyword">new</span> Arduino(<span class="keyword">this</span>, Arduino.list()[<span class="number">0</span>], <span class="number">57600</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouseMoved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  arduino.analogWrite(ledPin, <span class="keyword">int</span>(map(mouseX, <span class="number">0</span>, width-<span class="number">1</span>, <span class="number">0</span>, <span class="number">255</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2018-10-02T05:18:00.000Z" title="2018. 10. 2. 오후 1:18:00">2018-10-02</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-20T11:41:24.346Z" title="2021. 9. 20. 오후 7:41:24">2021-09-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">9분안에 읽기 (약 1339 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/02/1602-LCD-Display/">1602 LCD, 조도, 초음파, 온습도</a></h1><div class="content"><p>1602 LCD 중에서 (I2C 모듈이 추가되어 있지 않은) 가장 기본적인 형태, 즉 1602 LCD만 있는 상태에서의 출력방법을 알아보겠습니다.</p>
<br>

<h2 id="라이브러리-설치하기"><a href="#라이브러리-설치하기" class="headerlink" title="라이브러리 설치하기"></a>라이브러리 설치하기</h2><p>이 경우에는 Arduino IDE에 기본적으로 포함되어 있는 LiquidCrystal 라이브러리를 이용한다.</p>
<ul>
<li>  <strong>스케치</strong>&gt; <strong>라이브러리 포함하기</strong>&gt; <strong>LiquidCrystal</strong><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;LiquidCrystal.h&gt;</span></span></span><br></pre></td></tr></table></figure></li>
</ul>
<br>


<h2 id="Pin-Map"><a href="#Pin-Map" class="headerlink" title="Pin Map"></a>Pin Map</h2><table>
<thead>
<tr>
<th>LCD Pin</th>
<th></th>
<th align="center"></th>
<th>Arduino Uno</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>VSS</td>
<td align="center">LCD GND</td>
<td>GND</td>
</tr>
<tr>
<td>2</td>
<td>VDD</td>
<td align="center">LCD 전원</td>
<td>+5V</td>
</tr>
<tr>
<td>3</td>
<td>VO</td>
<td align="center">글자 대비값</td>
<td>(가변저항 추가/미사용시 3.3㏀ 거쳐서 GND)</td>
</tr>
<tr>
<td>4</td>
<td>RS</td>
<td align="center">레지스터 설정</td>
<td>12</td>
</tr>
<tr>
<td>5</td>
<td>RW</td>
<td align="center">읽기/쓰기모드 설정</td>
<td>GND</td>
</tr>
<tr>
<td>6</td>
<td>E</td>
<td align="center">쓰기모드 활성화</td>
<td>11</td>
</tr>
<tr>
<td>7</td>
<td>D0</td>
<td align="center">데이터 핀</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>D1</td>
<td align="center">″</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>D2</td>
<td align="center">″</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>D3</td>
<td align="center">″</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>D4</td>
<td align="center">″</td>
<td>5</td>
</tr>
<tr>
<td>12</td>
<td>D5</td>
<td align="center">″</td>
<td>4</td>
</tr>
<tr>
<td>13</td>
<td>D6</td>
<td align="center">″</td>
<td>3</td>
</tr>
<tr>
<td>14</td>
<td>D7</td>
<td align="center">″</td>
<td>2</td>
</tr>
<tr>
<td>15</td>
<td>A</td>
<td align="center">배경밝기 전압입력</td>
<td>(가변저항 추가)</td>
</tr>
<tr>
<td>16</td>
<td>K</td>
<td align="center">배경밝기 GND</td>
<td>(가변저항 추가)</td>
</tr>
</tbody></table>
<br>

<h2 id="function"><a href="#function" class="headerlink" title="function"></a>function</h2><table>
<thead>
<tr>
<th>function</th>
<th>기능</th>
</tr>
</thead>
<tbody><tr>
<td>LiquidCrystal()</td>
<td>LCD 클래스 생성(LCD interface 설정)</td>
</tr>
<tr>
<td>begin()</td>
<td>LCD 화면 초기화(column과 row 설정)</td>
</tr>
<tr>
<td>clear()</td>
<td>LCD 화면을 지우고 커서를 (0,0) 위치로 옮김</td>
</tr>
<tr>
<td>home()</td>
<td>커서를 (0,0) 위치로 옮김</td>
</tr>
<tr>
<td>setCursor()</td>
<td>커서를 특정 위치로 옮김</td>
</tr>
<tr>
<td>write()</td>
<td>현재 커서에 한 문자를 출력</td>
</tr>
<tr>
<td>print()</td>
<td>현재 커서부터 출력 (Serial.print() 함수와 유사)</td>
</tr>
<tr>
<td>cursor(), nocursor()</td>
<td>커서 표시 O or X</td>
</tr>
<tr>
<td>display(), noDisplay()</td>
<td>LCD 화면에 정보 표시 O or X</td>
</tr>
<tr>
<td>scrollDisplayLeft(), scrollDisplayRight()</td>
<td>LCD 내용과 커서를 좌/우로 한 칸 스크롤</td>
</tr>
<tr>
<td>autoscroll(), noautoscroll()</td>
<td>문자 출력 시 이전 내용을 스크롤 할 지를 결정</td>
</tr>
<tr>
<td>leftToRight(), rightToLeft()</td>
<td>문자 출력 후 커서의 이동 위치 결정 (문자 출력 방향 결정)</td>
</tr>
<tr>
<td>createChar()</td>
<td>사용자 문자 등록, 총 8개까지 가능</td>
</tr>
</tbody></table>
<br>

<h2 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h2><p><img src="/image/1602-01.jpg"></p>
<br>


<h2 id="schematic-백라이트-밝기-조절-추가"><a href="#schematic-백라이트-밝기-조절-추가" class="headerlink" title="schematic : 백라이트 밝기 조절 추가"></a>schematic : 백라이트 밝기 조절 추가</h2><p>백라이트를 사용하지 않으면 너무 어두워서 글자가 잘 보이지 않는다. 적당한 밝기의 백라이트 사용을 위해 <strong>LCD 3번핀을 3.3㏀ 거쳐서 GND로 연결</strong>(혹은 1㏀ 3개를 직렬연결) 하거나, 아래 회로와 같이 가변 저항을 사용하면 백라이트의 밝기를 적절히 조절할 수도 있다.</p>
<p><img src="/image/1602-02.jpg"></p>
<br>

<h2 id="sketch-문자-2열-출력하기"><a href="#sketch-문자-2열-출력하기" class="headerlink" title="sketch : 문자 2열 출력하기"></a>sketch : 문자 2열 출력하기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;LiquidCrystal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">LiquidCrystal <span class="title">lcd</span><span class="params">(<span class="number">12</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>)</span></span>;  <span class="comment">// pin 연결에 대한 class 선언 (RS,E,D4,D5,D6,D7)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	lcd.begin(<span class="number">16</span>, <span class="number">2</span>);             <span class="comment">// LCD크기 지정</span></span><br><span class="line">	lcd.print(<span class="string">&quot;SKS Afterschool&quot;</span>);</span><br><span class="line">	lcd.setCursor(<span class="number">0</span>, <span class="number">1</span>);          <span class="comment">// 커서를 (0,1) 즉 두번째 줄(행)의 첫번째 칸(열)으로 이동</span></span><br><span class="line">	lcd.print(<span class="string">&quot;Let&#x27;s Arduino!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>


<h2 id="sketch-문자열-좌우-스크롤하기"><a href="#sketch-문자열-좌우-스크롤하기" class="headerlink" title="sketch : 문자열 좌우 스크롤하기"></a>sketch : 문자열 좌우 스크롤하기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;LiquidCrystal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">LiquidCrystal <span class="title">lcd</span><span class="params">(<span class="number">12</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  lcd.begin(<span class="number">16</span>, <span class="number">2</span>);</span><br><span class="line">  lcd.print(<span class="string">&quot;SKS Afterschool&quot;</span>);</span><br><span class="line">  lcd.setCursor(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">  lcd.print(<span class="string">&quot;Let&#x27;s Arduino!!&quot;</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> left = <span class="number">0</span>; left &lt; <span class="number">15</span>; left++) &#123;</span><br><span class="line">    lcd.scrollDisplayLeft();  <span class="comment">// 15번 왼쪽으로 이동 (15글자)</span></span><br><span class="line">    delay(<span class="number">300</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> right = <span class="number">0</span>; right &lt; <span class="number">31</span>; right++) &#123;</span><br><span class="line">    lcd.scrollDisplayRight();  <span class="comment">// 31번 오른쪽으로 이동 (15글자+16칸)</span></span><br><span class="line">    delay(<span class="number">300</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> left = <span class="number">0</span>; left &lt; <span class="number">16</span>; left++) &#123;</span><br><span class="line">    lcd.scrollDisplayLeft();  <span class="comment">// 16번 왼쪽으로 이동 (16칸)</span></span><br><span class="line">    delay(<span class="number">300</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><br><br></p>
<h1 id="문자열과-조도센서값을-출력하기"><a href="#문자열과-조도센서값을-출력하기" class="headerlink" title="문자열과 조도센서값을 출력하기"></a>문자열과 조도센서값을 출력하기</h1><br>


<h2 id="schematic-1"><a href="#schematic-1" class="headerlink" title="schematic"></a>schematic</h2><p><img src="/image/1602-03.jpg"></p>
<br>

<h2 id="sketch-문자열과-조도센서를-읽은-조도값을-동시에-출력하기"><a href="#sketch-문자열과-조도센서를-읽은-조도값을-동시에-출력하기" class="headerlink" title="sketch : 문자열과 조도센서를 읽은 조도값을 동시에 출력하기"></a>sketch : 문자열과 조도센서를 읽은 조도값을 동시에 출력하기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;LiquidCrystal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">LiquidCrystal <span class="title">lcd</span><span class="params">(<span class="number">12</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>)</span></span>;  <span class="comment">// pin 연결에 대한 class 선언 (RS,E,D4,D5,D6,D7)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	lcd.begin(<span class="number">16</span>, <span class="number">2</span>);             <span class="comment">// LCD크기 지정</span></span><br><span class="line">	lcd.print(<span class="string">&quot;Illumination:&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	lcd.setCursor(<span class="number">0</span>, <span class="number">1</span>);         <span class="comment">// 커서를 (0,1) 즉 첫번째 줄의 두번째 칸으로 이동</span></span><br><span class="line">	lcd.print(analogRead(A0));   <span class="comment">// A0에서 읽은 조도값을 출력</span></span><br><span class="line">	delay(<span class="number">200</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="sketch-조도센서값을-위로-스크롤시키기"><a href="#sketch-조도센서값을-위로-스크롤시키기" class="headerlink" title="sketch : 조도센서값을 위로 스크롤시키기"></a>sketch : 조도센서값을 위로 스크롤시키기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;LiquidCrystal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i, j, k=<span class="number">1</span>;</span><br><span class="line"><span class="function">LiquidCrystal <span class="title">lcd</span><span class="params">(<span class="number">12</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  lcd.begin(<span class="number">16</span>, <span class="number">2</span>);</span><br><span class="line">  lcd.print(<span class="string">&quot;Illumination:&quot;</span>);</span><br><span class="line">  lcd.setCursor(<span class="number">0</span>, <span class="number">1</span>);        <span class="comment">// 두번째 줄에</span></span><br><span class="line">  i = analogRead(A0);</span><br><span class="line">  lcd.print(<span class="string">&quot;Check#&quot;</span>);</span><br><span class="line">  lcd.print(k);               <span class="comment">// 측정 횟수</span></span><br><span class="line">  lcd.print(<span class="string">&quot; : &quot;</span>);</span><br><span class="line">  lcd.print(i);               <span class="comment">// 첫번째 조도값 출력</span></span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  lcd.clear();                <span class="comment">// lcd 화면 지우고 (0,0)으로 커서 이동</span></span><br><span class="line">  j = i;                      <span class="comment">// 이전 조도값을 j에 저장</span></span><br><span class="line">  lcd.print(<span class="string">&quot;Check#&quot;</span>);</span><br><span class="line">  lcd.print(k);               <span class="comment">// 이전 조도값 측정 횟수</span></span><br><span class="line">  lcd.print(<span class="string">&quot; : &quot;</span>);</span><br><span class="line">  lcd.print(j);               <span class="comment">// 이전 조도값 출력</span></span><br><span class="line"></span><br><span class="line">  lcd.setCursor(<span class="number">0</span>, <span class="number">1</span>);        <span class="comment">// 두번째 줄로 이동</span></span><br><span class="line">  i = analogRead(A0);         <span class="comment">// 새로운 조도값 측정</span></span><br><span class="line">  k++;                        <span class="comment">// 측정 횟수 증가</span></span><br><span class="line">  lcd.print(<span class="string">&quot;check#&quot;</span>);</span><br><span class="line">  lcd.print(k);               <span class="comment">// 새로운 측정 횟수</span></span><br><span class="line">  lcd.print(<span class="string">&quot; : &quot;</span>);</span><br><span class="line">  lcd.print(i);               <span class="comment">// 새로운 조도값 출력</span></span><br><span class="line">  </span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h1 id="초음파-센서-거리값-출력하기"><a href="#초음파-센서-거리값-출력하기" class="headerlink" title="초음파 센서 거리값 출력하기"></a>초음파 센서 거리값 출력하기</h1><p>초음파를 이용하여 사물간의 거리를 측정하는 센서입니다. 아두이노에서는 HC-SR04, US-100 제품을 많이 사용하며, 여기서는 HC-SR04를 사용해보겠습니다.</p>
<br>

<h2 id="Pin-Map-HC-SR04"><a href="#Pin-Map-HC-SR04" class="headerlink" title="Pin Map : HC-SR04"></a>Pin Map : HC-SR04</h2><table>
<thead>
<tr>
<th>DHT11</th>
<th>아두이노</th>
</tr>
</thead>
<tbody><tr>
<td>VCC</td>
<td>5V</td>
</tr>
<tr>
<td>Trig (초음파 송신)</td>
<td>8 (pinMode 설정함)</td>
</tr>
<tr>
<td>Echo (초음파 수신)</td>
<td>9 (pinMode 설정함)</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
</tr>
</tbody></table>
<br>


<h2 id="schematic-2"><a href="#schematic-2" class="headerlink" title="schematic"></a>schematic</h2><p><img src="/image/1602-04.jpg"></p>
<br>

<h2 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;LiquidCrystal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TRIG 8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ECHO 9</span></span><br><span class="line"></span><br><span class="line"><span class="function">LiquidCrystal <span class="title">lcd</span><span class="params">(<span class="number">12</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   pinMode(TRIG, OUTPUT);</span><br><span class="line">   pinMode(ECHO, INPUT);</span><br><span class="line">   lcd.begin(<span class="number">16</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  digitalWrite(TRIG, LOW);  <span class="comment">// 초음파발사 정지(초기화)</span></span><br><span class="line">  delayMicroseconds(<span class="number">2</span>);</span><br><span class="line">  digitalWrite(TRIG, HIGH); <span class="comment">// 초음파발사</span></span><br><span class="line">  delayMicroseconds(<span class="number">2</span>);</span><br><span class="line">  digitalWrite(TRIG, LOW);  <span class="comment">// 초음파발사 정지</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">long</span> distance = pulseIn(ECHO, HIGH)/<span class="number">58.2</span>;</span><br><span class="line">  lcd.clear();</span><br><span class="line">  lcd.setCursor(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">  lcd.print(distance);</span><br><span class="line">  lcd.print(<span class="string">&quot; cm&quot;</span>);</span><br><span class="line">  delay(<span class="number">200</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h1 id="DHT11-온·습도센서-값-출력하기"><a href="#DHT11-온·습도센서-값-출력하기" class="headerlink" title="DHT11 온·습도센서 값 출력하기"></a>DHT11 온·습도센서 값 출력하기</h1><p>DHT11 센서를 사용하면 온도와 습도를 동시에 측정할 수 있다. 여기서는 1602 LCD에 온도와 습도를 출력해본다.</p>
<br>

<h2 id="Pin-Map-1"><a href="#Pin-Map-1" class="headerlink" title="Pin Map"></a>Pin Map</h2><table>
<thead>
<tr>
<th>DHT11</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody><tr>
<td>Arduino</td>
<td>5V</td>
<td></td>
<td>2, 10㏀ 저항 거쳐서 5V</td>
<td>GND</td>
</tr>
</tbody></table>
<br>

<h2 id="schematic-3"><a href="#schematic-3" class="headerlink" title="schematic"></a>schematic</h2><p><img src="/image/1602-05.jpg"></p>
<br>

<h2 id="라이브러리-추가하기"><a href="#라이브러리-추가하기" class="headerlink" title="라이브러리 추가하기"></a>라이브러리 추가하기</h2><ul>
<li>  <strong>스케치</strong>&gt; <strong>라이브러리 포함하기</strong>&gt; <strong>라이브러리 관리</strong>&gt; <strong>라이브러리 매니저</strong> 에서 “DHT11” 검색</li>
<li>  DHT sensor library by Adafruit 설치</li>
</ul>
<br>

<h2 id="sketch-1"><a href="#sketch-1" class="headerlink" title="sketch"></a>sketch</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;LiquidCrystal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;DHT.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">LiquidCrystal <span class="title">lcd</span><span class="params">(<span class="number">12</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>)</span></span>;    <span class="comment">// RS, E, D4, D5, D6, D7</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DHTPIN 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DHTTYPE DHT11</span></span><br><span class="line"><span class="function">DHT <span class="title">dht</span><span class="params">(DHTPIN, DHTTYPE)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  dht.begin();</span><br><span class="line">  lcd.begin(<span class="number">16</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">float</span> t = dht.readTemperature();       <span class="comment">// read temperature</span></span><br><span class="line">  <span class="keyword">float</span> h = dht.readHumidity();          <span class="comment">// read humidity</span></span><br><span class="line"></span><br><span class="line">  lcd.clear();</span><br><span class="line">  lcd.setCursor(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  lcd.print(<span class="string">&quot;Temp.: &quot;</span>);                  <span class="comment">// write temperature </span></span><br><span class="line">  lcd.print(t);</span><br><span class="line">  lcd.print(<span class="string">&quot; C&quot;</span>);</span><br><span class="line">  lcd.setCursor(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">  lcd.print(<span class="string">&quot;Humi.: &quot;</span>);                  <span class="comment">// write humidity</span></span><br><span class="line">  lcd.print(h);</span><br><span class="line">  lcd.print(<span class="string">&quot;%&quot;</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h1 id="과제"><a href="#과제" class="headerlink" title="과제"></a>과제</h1><p>입력버튼을 만들과, 각 버튼을 누를때마다 A → B → C → D 등 출력하기</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2018-10-01T02:21:00.000Z" title="2018. 10. 1. 오전 10:21:00">2018-10-01</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-09-20T11:40:18.255Z" title="2021. 9. 20. 오후 7:40:18">2021-09-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/arduino/">arduino</a></span><span class="level-item">18분안에 읽기 (약 2728 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/01/7-Segment-FND-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">7 Segment (FND) 사용하기</a></h1><div class="content"><h2 id="FND의-종류"><a href="#FND의-종류" class="headerlink" title="FND의 종류"></a>FND의 종류</h2><ul>
<li><p>FND는 Anode형과 Cathode형으로 분류되며, 이 중 Anode형이 주로 사용되고 있는데요. Anode형은 중앙핀이 VCC이며, Cathode형은 GND입니다. 우리가 사용하는 것은 5611BH로 Common Anode형입니다.</p>
</li>
<li><p>7 Segment (FND)는 숫자나 문자를 표현하는 7개의 LED와 소수점을 표현하는 1개의 LED가 포함되어 있는 부품을 의미합니다. FND는 16X2 LCD와 비교할 때 표현할 수 있는 문자의 개수가 제한되고, 각 문자의 표현을 위하여 총 8개의 LED를 하나씩 조절해주어야 하는 등 사용이 복잡하다는 단점이 있습니다. 그렇지만, 전력소모가 적고 크기가 큰 Segment를 선택하면 비교적 큰 문자도 표현할 수 있다는 장점이 있어 다양한 용도로 사용되고 있습니다.</p>
</li>
</ul>
<br>

<h2 id="숫자표시-방법"><a href="#숫자표시-방법" class="headerlink" title="숫자표시 방법"></a>숫자표시 방법</h2><p>![](/image/7segment-01.jpg =178x274)<br><img src="/image/7segment-02.jpg"></p>
<br>

<table>
<thead>
<tr>
<th>Num</th>
<th>DP</th>
<th>G</th>
<th>F</th>
<th>E</th>
<th>D</th>
<th>C</th>
<th>B</th>
<th>A</th>
<th>2진수</th>
<th>16진수</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0b11000000</td>
<td>0xC0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0b11111001</td>
<td>0xF9</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0b10100100</td>
<td>0xA4</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0b10110000</td>
<td>0xB0</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0b10011001</td>
<td>0x99</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0b10010010</td>
<td>0x92</td>
</tr>
<tr>
<td>6</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0b10000010</td>
<td>0x82</td>
</tr>
<tr>
<td>7</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0b11111000</td>
<td>0xF8</td>
</tr>
<tr>
<td>8</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0b10000000</td>
<td>0x80</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0b10010000</td>
<td>0x90</td>
</tr>
</tbody></table>
<blockquote>
<p>10진수 숫자와의 구분을 위해 2진수 앞에는 0b, 16진수 앞에는 0x를 표기하고<br>16진수 표현에 있어서, 각 숫자에 소수점을 포함시키는 경우에는 80을 빼주면 됩니다. 예를 들어,</p>
</blockquote>
<ul>
<li>0． → 0xC0 - 0x80 = 0x40</li>
<li>1． → 0xF9 - 0x80 = 0x79</li>
<li>2． → 0xA4 - 0x80 = 0x24</li>
<li>3． → 0xB0 - 0x80 = 0x30</li>
<li>4． → 0x99 - 0x80 = 0x19</li>
<li>5． → 0x92 - 0x80 = 0x12</li>
<li>6． → 0x82 - 0x80 = 0x12</li>
<li>7． → 0xF8 - 0x80 = 0x78</li>
<li>8． → 0x80 - 0x80 = 0x00</li>
<li>9． → 0x90 - 0x80 = 0x10</li>
</ul>
<br>

<h2 id="Pin-Map"><a href="#Pin-Map" class="headerlink" title="Pin Map"></a>Pin Map</h2><table>
<thead>
<tr>
<th>7 Segment</th>
<th>Arduino</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>2</td>
</tr>
<tr>
<td>B</td>
<td>3</td>
</tr>
<tr>
<td>C</td>
<td>4</td>
</tr>
<tr>
<td>D</td>
<td>5</td>
</tr>
<tr>
<td>E</td>
<td>6</td>
</tr>
<tr>
<td>F</td>
<td>7</td>
</tr>
<tr>
<td>G</td>
<td>8</td>
</tr>
<tr>
<td>DP</td>
<td>9</td>
</tr>
</tbody></table>
<br>

<h2 id="schematic"><a href="#schematic" class="headerlink" title="schematic"></a>schematic</h2><p>아래 회로에서는 330Ω 저항 1개를 VCC에 직접 연결하여 사용하였습니다. 상단부와 하단부 중앙핀은 서로 연결이 되어 있으므로, 둘 중 하나만 +5V에 연결하여 사용합니다.<br><img src="/image/7segment-03.jpg"></p>
<br>

<blockquote>
<p><strong>주의</strong> : 위 회로에서는 간단한 회로 구성을 위해 VCC에 저항을 직접 연결하여 사용하였으나, 이것이 좋은 방법은 아닙니다. FND의 각 LED가 직렬이 아닌 병렬로 연결되어 있는데, 이렇게 구성하는 경우 동일한 전류로 “1”를 표시할때는 2개의 Segment만 켜고, “8”을 표시할때는 7개의 Segment를 모두 키므로, 각 숫자마다 밝기의 차이가 생기길 수 있기 때문이죠. 실제 LED의 밝기에 미세한 변화가 생기는 것을 볼 수 있습니다.</p>
</blockquote>
<blockquote>
<p>이러한 문제를 해결하기 위해서는 각 LED마다 저항을 따로 사용하여야 합니다. 아래 그림과 같이 220~330Ω 저항 8개를 사용하는 것이 원칙이며, 이렇게 하면 밝기를 고르게 유지할 수 있습니다.</p>
</blockquote>
<p><img src="/image/7segment-04.jpg"></p>
<br>

<h2 id="sketch-0-9까지-차례대로-표시하기"><a href="#sketch-0-9까지-차례대로-표시하기" class="headerlink" title="sketch : 0~9까지 차례대로 표시하기"></a>sketch : 0~9까지 차례대로 표시하기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> A = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> B = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> C = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> D = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> E = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> F = <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> G = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> DP = <span class="number">9</span>;</span><br><span class="line"><span class="keyword">int</span> dt = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">pinMode(A, OUTPUT);</span><br><span class="line">pinMode(B, OUTPUT);</span><br><span class="line">pinMode(C, OUTPUT);</span><br><span class="line">pinMode(D, OUTPUT);</span><br><span class="line">pinMode(E, OUTPUT);</span><br><span class="line">pinMode(F, OUTPUT);</span><br><span class="line">pinMode(G, OUTPUT);</span><br><span class="line">pinMode(DP, OUTPUT);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7 Segment Ready</span></span><br><span class="line">digitalWrite (A,HIGH);</span><br><span class="line">digitalWrite (B,HIGH);</span><br><span class="line">digitalWrite (C,HIGH);</span><br><span class="line">digitalWrite (D,HIGH);</span><br><span class="line">digitalWrite (E,HIGH);</span><br><span class="line">digitalWrite (F,HIGH);</span><br><span class="line">digitalWrite (G,HIGH);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 0</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,LOW);</span><br><span class="line">digitalWrite (F,LOW);</span><br><span class="line">digitalWrite (G,HIGH);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 1</span></span><br><span class="line">digitalWrite (A,HIGH);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,HIGH);</span><br><span class="line">digitalWrite (E,HIGH);</span><br><span class="line">digitalWrite (F,HIGH);</span><br><span class="line">digitalWrite (G,HIGH);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 2</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,HIGH);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,LOW);</span><br><span class="line">digitalWrite (F,HIGH);</span><br><span class="line">digitalWrite (G,LOW);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 3</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,HIGH);</span><br><span class="line">digitalWrite (F,HIGH);</span><br><span class="line">digitalWrite (G,LOW);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 4</span></span><br><span class="line">digitalWrite (A,HIGH);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,HIGH);</span><br><span class="line">digitalWrite (E,HIGH);</span><br><span class="line">digitalWrite (F,LOW);</span><br><span class="line">digitalWrite (G,LOW);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 5</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,HIGH);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,HIGH);</span><br><span class="line">digitalWrite (F,LOW);</span><br><span class="line">digitalWrite (G,LOW);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 6</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,HIGH);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,LOW);</span><br><span class="line">digitalWrite (F,LOW);</span><br><span class="line">digitalWrite (G,LOW);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 7</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,HIGH);</span><br><span class="line">digitalWrite (E,HIGH);</span><br><span class="line">digitalWrite (F,HIGH);</span><br><span class="line">digitalWrite (G,HIGH);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 8</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,LOW);</span><br><span class="line">digitalWrite (F,LOW);</span><br><span class="line">digitalWrite (G,LOW);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 9</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,HIGH);</span><br><span class="line">digitalWrite (F,LOW);</span><br><span class="line">digitalWrite (G,LOW);</span><br><span class="line">digitalWrite (DP,HIGH);</span><br><span class="line">delay(dt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// digit 0.</span></span><br><span class="line">digitalWrite (A,LOW);</span><br><span class="line">digitalWrite (B,LOW);</span><br><span class="line">digitalWrite (C,LOW);</span><br><span class="line">digitalWrite (D,LOW);</span><br><span class="line">digitalWrite (E,LOW);</span><br><span class="line">digitalWrite (F,LOW);</span><br><span class="line">digitalWrite (G,HIGH);</span><br><span class="line">digitalWrite (DP,LOW);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="sketch-배열을-사용하여-숫자-출력하기"><a href="#sketch-배열을-사용하여-숫자-출력하기" class="headerlink" title="sketch : 배열을 사용하여 숫자 출력하기"></a>sketch : 배열을 사용하여 숫자 출력하기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> numArray[<span class="number">11</span>][<span class="number">8</span>] = &#123;</span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>&#125;, <span class="comment">// 0</span></span><br><span class="line">  &#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>&#125;, <span class="comment">// 1</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, <span class="comment">// 2</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, <span class="comment">// 3</span></span><br><span class="line">  &#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, <span class="comment">// 4</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, <span class="comment">// 5</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, <span class="comment">// 6</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>&#125;, <span class="comment">// 7</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, <span class="comment">// 8</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, <span class="comment">// 9</span></span><br><span class="line">  &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>&#125;  <span class="comment">// 0.</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> pins[] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; <span class="number">8</span>; r++) &#123;</span><br><span class="line">    pinMode(pins[r], OUTPUT);</span><br><span class="line">    digitalWrite(pins[r], <span class="number">1</span>); <span class="comment">// 7 Segment Ready</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 8 출력</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; <span class="number">8</span>; r++) &#123;</span><br><span class="line">    digitalWrite(pins[r], numArray[<span class="number">8</span>][r]); <span class="comment">// numbers[8][r]이면 8을 출력</span></span><br><span class="line">  &#125;</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> num = <span class="number">0</span>; num &lt; <span class="number">11</span>; num++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; <span class="number">8</span>; r++) &#123;</span><br><span class="line">      digitalWrite(pins[r], numbers[num][r]); <span class="comment">// num의 값을 출력</span></span><br><span class="line">    &#125;</span><br><span class="line">    delay(<span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="sketch-2진수나-16진수를-이용하여-표시하기"><a href="#sketch-2진수나-16진수를-이용하여-표시하기" class="headerlink" title="sketch : 2진수나 16진수를 이용하여 표시하기"></a>sketch : 2진수나 16진수를 이용하여 표시하기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> numArray[<span class="number">10</span>] = &#123;</span><br><span class="line">  <span class="number">0b11000000</span>,   <span class="comment">// 0</span></span><br><span class="line">  <span class="number">0b11111001</span>,   <span class="comment">// 1</span></span><br><span class="line">  <span class="number">0b10100100</span>,   <span class="comment">// 2</span></span><br><span class="line">  <span class="number">0b10110000</span>,   <span class="comment">// 3</span></span><br><span class="line">  <span class="number">0b10011001</span>,   <span class="comment">// 4</span></span><br><span class="line">  <span class="number">0b10010010</span>,   <span class="comment">// 5</span></span><br><span class="line">  <span class="number">0b10000010</span>,   <span class="comment">// 6</span></span><br><span class="line">  <span class="number">0b11111000</span>,   <span class="comment">// 7</span></span><br><span class="line">  <span class="number">0b10000000</span>,   <span class="comment">// 8</span></span><br><span class="line">  <span class="number">0b10010000</span>    <span class="comment">// 9</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// int numArray[10] = &#123; 0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90 &#125;;</span></span><br><span class="line"><span class="comment">// 16진수를 사용해도 됨</span></span><br><span class="line"><span class="comment">// 소수점 포함 int numArray[10] = &#123; 0x40, 0x79, 0x24, 0x30, 0x19, 0x12, 0x02, 0x78, 0x00, 0x10 &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> segPins[<span class="number">7</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;                </span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">    pinMode(segPins[i], OUTPUT);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    segLED(i);                         <span class="comment">// i=1이면 1을 출력</span></span><br><span class="line">    delay(<span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">segLED</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;                 <span class="comment">// num값을 넘겨받아</span></span><br><span class="line">  <span class="keyword">int</span> data = numArray[num];            <span class="comment">// num번째 배열값을 data로 지정</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">  &#123;                                    <span class="comment">// 2진수 배열 8비트를 &amp;연산자로 가장 오른쪽11 비트값부터 검사</span></span><br><span class="line">    <span class="keyword">if</span>(data &amp; <span class="number">0x01</span>) &#123;                  <span class="comment">// 1이면</span></span><br><span class="line">      digitalWrite(segPins[j], HIGH);  <span class="comment">// HIGH(끄고)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      digitalWrite(segPins[j], LOW);   <span class="comment">// 1이 아니면(0이면)</span></span><br><span class="line">    &#125;                                  <span class="comment">// LOW(킨다)</span></span><br><span class="line">  data &gt;&gt;= <span class="number">1</span>;                          <span class="comment">// data값을 1비트씩 오른쪽으로 쉬프트한 후</span></span><br><span class="line">  &#125;                                    <span class="comment">// 7번 추가 실행 (총 8번 실행)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="sketch-시리얼모니터에서-값을-입력받아-출력하기"><a href="#sketch-시리얼모니터에서-값을-입력받아-출력하기" class="headerlink" title="sketch : 시리얼모니터에서 값을 입력받아 출력하기"></a>sketch : 시리얼모니터에서 값을 입력받아 출력하기</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> numArray[<span class="number">10</span>] = &#123; <span class="number">0xC0</span>, <span class="number">0xF9</span>, <span class="number">0xA4</span>, <span class="number">0xB0</span>, <span class="number">0x99</span>, <span class="number">0x92</span>, <span class="number">0x82</span>, <span class="number">0xF8</span>, <span class="number">0x80</span>, <span class="number">0x90</span> &#125;;</span><br><span class="line"><span class="comment">// 소수점 포함 int numArray[10] = &#123; 0x40, 0x79, 0x24, 0x30, 0x19, 0x12, 0x02, 0x78, 0x00, 0x10 &#125;;</span></span><br><span class="line"><span class="keyword">int</span> segPins[<span class="number">7</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  Serial.begin(<span class="number">9600</span>); </span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">    pinMode(segPins[i], OUTPUT);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.println(<span class="string">&quot;Press any number!(0~9)&quot;</span>); </span><br><span class="line">  delay(<span class="number">1000</span>); </span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (Serial.available()) &#123;</span><br><span class="line">  <span class="keyword">int</span> number = Serial.read();</span><br><span class="line">    <span class="keyword">if</span>(number &lt; <span class="number">10</span>) &#123;</span><br><span class="line">	  Serial.println(number<span class="string">&quot;);  </span></span><br><span class="line"><span class="string">	  segLED(number);                  // i=1이면 1을 출력</span></span><br><span class="line"><span class="string">	  delay(1000);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    else &#123;</span></span><br><span class="line"><span class="string">      Serial.println(&quot;</span>Please input a lower number than <span class="number">10</span>!<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">void segLED(int num) &#123;                 // num값을 넘겨받아</span></span><br><span class="line"><span class="string">  int data = numArray[num];            // num번째 배열값을 data로 지정</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  for (j = 0; j &lt; 8; j++)</span></span><br><span class="line"><span class="string">  &#123;                                    // 2진수 배열 8비트를 &amp;연산자로 가장 오른쪽11 비트값부터 검사</span></span><br><span class="line"><span class="string">    if(data &amp; 0x01) &#123;                  // 1이면</span></span><br><span class="line"><span class="string">      digitalWrite(segPins[j], HIGH);  // HIGH(끄고)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    else &#123;</span></span><br><span class="line"><span class="string">      digitalWrite(segPins[j], LOW);   // 1이 아니면(0이면)</span></span><br><span class="line"><span class="string">    &#125;                                  // LOW(킨다)</span></span><br><span class="line"><span class="string">  data &gt;&gt;= 1;                          // data값을 1비트씩 오른쪽으로 쉬프트한 후</span></span><br><span class="line"><span class="string">  &#125;                                    // 7번 추가 실행 (총 8번 실행)</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p><br><br></p>
<h1 id="2개의-7-Segment를-사용하여-2자리-숫자-나타내기"><a href="#2개의-7-Segment를-사용하여-2자리-숫자-나타내기" class="headerlink" title="2개의 7 Segment를 사용하여 2자리 숫자 나타내기"></a>2개의 7 Segment를 사용하여 2자리 숫자 나타내기</h1><p>1개의 7 Segment를 사용하는데 8개의 Digital Pin이 필요하므로, 2개 이상의 7 Segment를 사용하려면 16개의 Digital Pin이 필요합니다. 핀의 개수로만 보면 Arduino Uno로는 표현할 수 없겠지요. 그러므로 2개의 7 Segment를 전원부 제어를 통해 빠른 시간동안 on/off를 반복함으로써 우리 눈에 나타나는 잔상효과를 이용하는 방법으로 여러개의 FND를 사용하는 Dynamic 구동 방식을 사용합니다.</p>
<p>아래 회로를 예로들면 아두이노의 Digital 2~9번핀이 각각 두개의 FND로 병렬연결 되어 있고, 10번핀은 10의 자리를 나타내는 FND1에, 11번 핀은 1의 자리를 나타내는 FND2에 연결되어 있는 것을 볼 수 있습니다. 이 회로를 통해 10번핀을 LOW, 11번핀을 HIGH로 두면 FND1이 작동하고, 마찬가지로 10번핀을 HIGH, 11번핀을 LOW로 두면 FND2가 작동하게 되죠. 이러한 방식으로 2개의 FND를 10개의 핀으로 작동할 수 있게 되는 것입니다.</p>
<p><img src="/image/7segment-05.jpg"></p>
<br>

<h2 id="sketch"><a href="#sketch" class="headerlink" title="sketch"></a>sketch</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> numArray[<span class="number">10</span>] = &#123;</span><br><span class="line">  <span class="number">0b01000000</span>,   <span class="comment">// 0</span></span><br><span class="line">  <span class="number">0b01111001</span>,   <span class="comment">// 1</span></span><br><span class="line">  <span class="number">0b00100100</span>,   <span class="comment">// 2</span></span><br><span class="line">  <span class="number">0b00110000</span>,   <span class="comment">// 3</span></span><br><span class="line">  <span class="number">0b00011001</span>,   <span class="comment">// 4</span></span><br><span class="line">  <span class="number">0b00010010</span>,   <span class="comment">// 5</span></span><br><span class="line">  <span class="number">0b00000010</span>,   <span class="comment">// 6</span></span><br><span class="line">  <span class="number">0b01111000</span>,   <span class="comment">// 7</span></span><br><span class="line">  <span class="number">0b00000000</span>,   <span class="comment">// 8</span></span><br><span class="line">  <span class="number">0b00010000</span>    <span class="comment">// 9</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// int numArray[10] = &#123; 0x40, 0x79, 0x24, 0x30, 0x19, 0x12, 0x02, 0x78, 0x00, 0x10 &#125;;</span></span><br><span class="line"><span class="comment">// 16진수를 사용해도 됨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> segPins[] = &#123; <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> &#125;;  <span class="comment">// Segment핀 번호</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> segNum = <span class="number">2</span>;                              <span class="comment">// Segment 개수 (숫자 자리수)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> vccPins[segNum] = &#123; <span class="number">10</span>, <span class="number">11</span> &#125;;            <span class="comment">// 10, 11번 핀을 통해 seg#1, seg#2의 전원 인가</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">    pinMode(segPins[i], OUTPUT);                   <span class="comment">// Segment핀 설정</span></span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; segNum; i++) &#123;</span><br><span class="line">    pinMode(vccPins[i], OUTPUT);                   <span class="comment">// seg#0, seg#1의 전원인가 핀 설정</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;                  <span class="comment">// 0~99까지 숫자를 표시</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; n &lt; <span class="number">10</span>; n++) &#123;                 <span class="comment">// 빠르게 카운트할 경우 모든 LED가 켜져 있는 것처럼 보여 </span></span><br><span class="line">      showNumber(i);                               <span class="comment">// 숫자를 구분할 수 없으므로, 빠르게 10번씩 점멸시키면서 표시</span></span><br><span class="line">    &#125;  </span><br><span class="line">  &#125;                                  </span><br><span class="line">&#125;                                    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showNumber</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (number == <span class="number">0</span>) &#123;</span><br><span class="line">    showDigit(number, <span class="number">0</span>);                         <span class="comment">// 0의 경우 (1의 자리수) Segment에만 0을 출력</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; segNum; j++) &#123;            <span class="comment">// 10의 자리, 1의 자리 출력을 위해 2번 실행</span></span><br><span class="line">      <span class="keyword">if</span> (number &gt; <span class="number">0</span>) &#123;                           <span class="comment">// 출력값이 0보다 큰 경우에만 실행</span></span><br><span class="line">        showDigit(number % <span class="number">10</span>, j);                <span class="comment">// 1의 자리 숫자(%10)를 seg#0(j=0)에 출력 (if 10의 자리 숫자 = (number % 100) / 10))</span></span><br><span class="line">        number = number / <span class="number">10</span>;                     <span class="comment">// ※ 숫자를 10으로 나눠 10의 자리 숫자를 1의 자리 숫자로 만듦</span></span><br><span class="line">      &#125;                                           <span class="comment">// if 처음에 주어진 숫자가 한 자리 수였으면,</span></span><br><span class="line">      delay(<span class="number">5</span>);                                   <span class="comment">//    → 10으로 나눈 후에는 1의 자리값이 0이 되어, 0보다 큰 값이 안되므로 10의 자리 출력하지 않음</span></span><br><span class="line">    &#125;                                             <span class="comment">// if 처음에 주어진 숫자가 두 자리 수였으면</span></span><br><span class="line">  &#125;                                               <span class="comment">//    → 10으로 나눈 후 10의 자리 숫자가 1의 자리 수가 되므로, 10이 자리수를 seg#1(j=1)에 출력 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showDigit</span><span class="params">(<span class="keyword">int</span> num, <span class="keyword">int</span> digit)</span> </span>&#123;              <span class="comment">// num값과 digit(0→1의 자리수에 표시, 1→10의 자리수에 표시)을 넘겨받아</span></span><br><span class="line">  <span class="keyword">int</span> data = numArray[num];                       <span class="comment">// num번째 배열값을 digit자리수에 표시할 data로 지정</span></span><br><span class="line"></span><br><span class="line">  digitalWrite(vccPins[<span class="number">0</span>], HIGH);                 <span class="comment">// vcc핀에 전원 인가</span></span><br><span class="line">  digitalWrite(vccPins[<span class="number">1</span>], HIGH);                 <span class="comment">// [0] = Arduino Pin10, [1] = Arduino Pin11</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> segLED = <span class="number">0</span>; segLED &lt; <span class="number">7</span>; segLED++)      <span class="comment">// 숫자 2진수의 7세그먼트 ON, OFF</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (data &amp; <span class="number">0x01</span>) &#123;                            <span class="comment">// 1이면</span></span><br><span class="line">      digitalWrite(segPins[segLED], HIGH);        <span class="comment">// HIGH(끄고)                  </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;                                        <span class="comment">// 1이 아니면(0이면)</span></span><br><span class="line">      digitalWrite(segPins[segLED], LOW);         <span class="comment">// LOW(끈다)               </span></span><br><span class="line">    &#125;</span><br><span class="line">    data &gt;&gt;= <span class="number">1</span>;                                   <span class="comment">// data값을 1비트씩 오른쪽으로 쉬프트한 후</span></span><br><span class="line">  &#125;</span><br><span class="line">  digitalWrite(vccPins[digit], LOW);              <span class="comment">// 숫자 LED 한 자리 ON</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><br><br></p>
<h1 id="4-FND"><a href="#4-FND" class="headerlink" title="4 FND"></a>4 FND</h1><p>4개의 FND를 Dynamic 방식으로 구동하기 위해서는 8개의 데이터 핀과 4개의 전원부 핀이 필요합니다.<br>![](/image/7segment-06.jpg =438x272)</p>
<br>

<h2 id="schematic-1"><a href="#schematic-1" class="headerlink" title="schematic"></a>schematic</h2><p><img src="/image/7segment-07.jpg"></p>
<br>

<h2 id="Pin-Map-1"><a href="#Pin-Map-1" class="headerlink" title="Pin Map"></a>Pin Map</h2><table>
<thead>
<tr>
<th>FND</th>
<th>Arduino</th>
<th>Segment</th>
<th>자리수</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>6</td>
<td>E</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>5</td>
<td>D</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>13</td>
<td>DP</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>C</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>8</td>
<td>G</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>9</td>
<td>S1</td>
<td>1의 자리 수</td>
</tr>
<tr>
<td>7</td>
<td>3</td>
<td>B</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>10</td>
<td>S2</td>
<td>10의 자리 수</td>
</tr>
<tr>
<td>9</td>
<td>11</td>
<td>S3</td>
<td>100의 자리 수</td>
</tr>
<tr>
<td>10</td>
<td>7</td>
<td>F</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>2</td>
<td>A</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>12</td>
<td>S4</td>
<td>1000의 자리 수</td>
</tr>
</tbody></table>
<br>

<h2 id="sketch-1"><a href="#sketch-1" class="headerlink" title="sketch"></a>sketch</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Segment_X - Arduino Pin // FND Pin</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_A 2 <span class="comment">// 11</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_B 3 <span class="comment">// 7</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_C 4 <span class="comment">// 4</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_D 5 <span class="comment">// 2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_E 6 <span class="comment">// 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_F 7 <span class="comment">// 10</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_G 8 <span class="comment">// 5</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// FND_num - Arduino Pin // FND Pin</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FND1 9  <span class="comment">// 6</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FND2 10 <span class="comment">// 8</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FND3 11 <span class="comment">// 9</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FND4 12 <span class="comment">// 12</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">seglight</span><span class="params">(byte number)</span></span>;</span><br><span class="line">byte numbers[] = &#123;</span><br><span class="line">  B0111111,  <span class="comment">// MSB   --  LSB</span></span><br><span class="line">  B0000110,</span><br><span class="line">  B1011011,</span><br><span class="line">  B1001111,</span><br><span class="line">  B1100110,</span><br><span class="line">  B1101101,</span><br><span class="line">  B1111101,</span><br><span class="line">  B0000111,</span><br><span class="line">  B1111111,</span><br><span class="line">  B1101111</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> FND[] = &#123;SEG_A, SEG_B, SEG_C, SEG_D, SEG_E, SEG_F, SEG_G &#125;;</span><br><span class="line"><span class="keyword">int</span> FND_NO[] = &#123;FND1, FND2, FND3, FND4&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">    pinMode(FND[i], OUTPUT);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">    pinMode(FND_NO[i], OUTPUT);</span><br><span class="line">    digitalWrite(FND_NO[i], HIGH);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ON = OUTPUT;</span><br><span class="line"><span class="keyword">int</span> intCnt = <span class="number">0</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(intCnt &lt; <span class="number">10000</span>) &#123;</span><br><span class="line">    intCnt++;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    intCnt = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">long</span> start = millis();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">long</span> j = <span class="number">0</span> ; j &lt; <span class="number">10</span> ; j = millis() - start) &#123; <span class="comment">// 600 밀리초 마다 실행</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Dynamic 구동</span></span><br><span class="line">    digitalWrite(FND1, LOW);                 <span class="comment">// 1의 자리 켜기</span></span><br><span class="line">    seglight(numbers[intCnt % <span class="number">10</span>]);</span><br><span class="line">    delay(<span class="number">5</span>);                                <span class="comment">// 5ms 유지 후</span></span><br><span class="line">    digitalWrite(FND1, HIGH);                <span class="comment">// 끄기</span></span><br><span class="line">    </span><br><span class="line">    digitalWrite(FND2, LOW);                 <span class="comment">// 10의 자리 켜기</span></span><br><span class="line">    seglight(numbers[(intCnt / <span class="number">10</span>) % <span class="number">10</span>]);</span><br><span class="line">    delay(<span class="number">5</span>);                                <span class="comment">// 5ms 유지 후</span></span><br><span class="line">    digitalWrite(FND2, HIGH);                <span class="comment">// 끄기</span></span><br><span class="line"> </span><br><span class="line">    digitalWrite(FND3, LOW);                 <span class="comment">// 100의 자리 켜기</span></span><br><span class="line">    seglight(numbers[(intCnt / <span class="number">100</span>) % <span class="number">10</span>]);</span><br><span class="line">    delay(<span class="number">5</span>);                                <span class="comment">// 5ms 유지 후 </span></span><br><span class="line">    digitalWrite(FND3, HIGH);                <span class="comment">// 끄기</span></span><br><span class="line"></span><br><span class="line">    digitalWrite(FND4, LOW);                 <span class="comment">// 1000의 자리 켜기</span></span><br><span class="line">    seglight(numbers[(intCnt / <span class="number">1000</span>) % <span class="number">10</span>]);</span><br><span class="line">    delay(<span class="number">5</span>);                                <span class="comment">// 5ms 유지 후</span></span><br><span class="line">    digitalWrite(FND4, HIGH);                <span class="comment">// 끄기</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Bit값으로 FND 각 LED 점등</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">seglight</span><span class="params">(byte number)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">7</span> ; i++) &#123;</span><br><span class="line">    <span class="keyword">int</span> bit = bitRead(number, i) ;</span><br><span class="line">    digitalWrite(FND[i], bit);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/categories/arduino/page/0/">이전</a></div><div class="pagination-next"><a href="/categories/arduino/page/2/">다음</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/categories/arduino/">1</a></li><li><a class="pagination-link" href="/categories/arduino/page/2/">2</a></li><li><a class="pagination-link" href="/categories/arduino/page/3/">3</a></li></ul></nav></div><div class="column column-left is-3-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-72x72 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="stemwith"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">stemwith</p><p class="is-size-6 is-block">de la Cruz a la fecha</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">48</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">2</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">링크</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/esp32/"><span class="level-start"><span class="level-item">ESP32</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/science/"><span class="level-start"><span class="level-item">Science</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/arduino/"><span class="level-start"><span class="level-item">arduino</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/categories/diy/"><span class="level-start"><span class="level-item">diy</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/drone/"><span class="level-start"><span class="level-item">drone</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/esp32/"><span class="level-start"><span class="level-item">esp32</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/esp32/science/"><span class="level-start"><span class="level-item">science</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/office/"><span class="level-start"><span class="level-item">office</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/science/"><span class="level-start"><span class="level-item">science</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-11-06T15:35:51.316Z">2021-11-07</time></p><p class="title"><a href="/2021/11/06/hello-world/">Hello World</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-11-02T08:57:00.000Z">2021-11-02</time></p><p class="title"><a href="/2021/11/02/STEM-%EC%A0%84%EC%9E%90%EA%B8%B0%ED%8C%8C-%EA%B2%80%EC%B6%9C%EA%B8%B0/">전자기파 검출기 만들기</a></p><p class="categories"><a href="/categories/science/">Science</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-11-01T09:27:53.000Z">2021-11-01</time></p><p class="title"><a href="/2021/11/01/ESP32-DC%EB%AA%A8%ED%84%B0/">ESP32, DC모터, TB6612FNG</a></p><p class="categories"><a href="/categories/esp32/">ESP32</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-10-10T09:27:53.000Z">2021-10-10</time></p><p class="title"><a href="/2021/10/10/ESP32-nRF24L01/">ESP32, nRF24L01 무선통신</a></p><p class="categories"><a href="/categories/esp32/">ESP32</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-09-26T09:27:53.000Z">2021-09-26</time></p><p class="title"><a href="/2021/09/26/ESP32-OLED/">ESP32, OLED (한글 출력 하기)</a></p><p class="categories"><a href="/categories/esp32/">ESP32</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">아카이브</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">11월 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">10월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">9월 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">11월 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">10월 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">8월 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">11월 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">10월 2019</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">9월 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">11월 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">10월 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">9월 2018</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/06/"><span class="level-start"><span class="level-item">6월 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/01/"><span class="level-start"><span class="level-item">1월 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/11/"><span class="level-start"><span class="level-item">11월 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/10/"><span class="level-start"><span class="level-item">10월 2012</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">태그</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/iot/"><span class="tag">iot</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rc/"><span class="tag">rc</span><span class="tag">4</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">업데이트 소식 받기</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="구독"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="구독"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="stemwith" height="28"></a><p class="is-size-7"><span>&copy; 2021 chemidot</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>