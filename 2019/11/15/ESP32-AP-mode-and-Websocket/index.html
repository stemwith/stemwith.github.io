<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>esp32 AP mode &amp; Websocket - Welcome to &quot;stemwith&quot;</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Welcome to &quot;stemwith&quot;"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Welcome to &quot;stemwith&quot;"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="ESP32 AP mode &amp;amp; Websocket  Introduction  AP modeESP32를 AP mode로 설정하여 라우터(공유기) 장치 없이 Client가 ESP32에 직접 접속하는 방법으로 데이터를 주고받는 통신을 구현해보도록 하겠습니다.    ESP32는 기본적으로 블루투스와 wifi를 방식의 무선 통신을 지원합니다. 각각의 방식이 갖는"><meta property="og:type" content="blog"><meta property="og:title" content="esp32 AP mode &amp; Websocket"><meta property="og:url" content="http://stemwith.github.io/2019/11/15/ESP32-AP-mode-and-Websocket/"><meta property="og:site_name" content="Welcome to &quot;stemwith&quot;"><meta property="og:description" content="ESP32 AP mode &amp;amp; Websocket  Introduction  AP modeESP32를 AP mode로 설정하여 라우터(공유기) 장치 없이 Client가 ESP32에 직접 접속하는 방법으로 데이터를 주고받는 통신을 구현해보도록 하겠습니다.    ESP32는 기본적으로 블루투스와 wifi를 방식의 무선 통신을 지원합니다. 각각의 방식이 갖는"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="http://stemwith.github.io/image/websocket01.png"><meta property="og:image" content="http://stemwith.github.io/image/websocket02.png"><meta property="og:image" content="http://stemwith.github.io/image/websocket03.png"><meta property="og:image" content="http://stemwith.github.io/image/websocket04.png"><meta property="og:image" content="http://stemwith.github.io/image/websocket05.png"><meta property="og:image" content="http://stemwith.github.io/2019/11/15/image/websocket06.png"><meta property="article:published_time" content="2019-11-15T09:27:53.000Z"><meta property="article:modified_time" content="2021-11-06T23:55:15.527Z"><meta property="article:author" content="chemidot"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/image/websocket01.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://stemwith.github.io/2019/11/15/ESP32-AP-mode-and-Websocket/"},"headline":"esp32 AP mode & Websocket","image":["http://stemwith.github.io/image/websocket01.png","http://stemwith.github.io/image/websocket02.png","http://stemwith.github.io/image/websocket03.png","http://stemwith.github.io/image/websocket04.png","http://stemwith.github.io/image/websocket05.png","http://stemwith.github.io/2019/11/15/image/websocket06.png"],"datePublished":"2019-11-15T09:27:53.000Z","dateModified":"2021-11-06T23:55:15.527Z","author":{"@type":"Person","name":"chemidot"},"publisher":{"@type":"Organization","name":"Welcome to \"stemwith\"","logo":{"@type":"ImageObject","url":"http://stemwith.github.io/img/logo.svg"}},"description":"ESP32 AP mode &amp; Websocket  Introduction  AP modeESP32를 AP mode로 설정하여 라우터(공유기) 장치 없이 Client가 ESP32에 직접 접속하는 방법으로 데이터를 주고받는 통신을 구현해보도록 하겠습니다.    ESP32는 기본적으로 블루투스와 wifi를 방식의 무선 통신을 지원합니다. 각각의 방식이 갖는"}</script><link rel="canonical" href="http://stemwith.github.io/2019/11/15/ESP32-AP-mode-and-Websocket/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/monokai.css"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&amp;family=Roboto" rel="stylesheet"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-151970975-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-151970975-1');</script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/rss2.xml" title="Welcome to "stemwith"" type="application/rss+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Welcome to &quot;stemwith&quot;" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-11-15T09:27:53.000Z" title="2019. 11. 15. 오후 5:27:53">2019-11-15</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-11-06T23:55:15.527Z" title="2021. 11. 7. 오전 7:55:15">2021-11-07</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/esp32/">esp32</a></span><span class="level-item">21분안에 읽기 (약 3157 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile">esp32 AP mode &amp; Websocket</h1><div class="content"><h1 id="ESP32-AP-mode-amp-Websocket"><a href="#ESP32-AP-mode-amp-Websocket" class="headerlink" title="ESP32 AP mode &amp; Websocket"></a>ESP32 AP mode &amp; Websocket</h1><br>

<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><br>

<h3 id="AP-mode"><a href="#AP-mode" class="headerlink" title="AP mode"></a>AP mode</h3><p>ESP32를 AP mode로 설정하여 라우터(공유기) 장치 없이 Client가 ESP32에 직접 접속하는 방법으로 데이터를 주고받는 통신을 구현해보도록 하겠습니다. </p>
<br>

<p>ESP32는 기본적으로 블루투스와 wifi를 방식의 무선 통신을 지원합니다. 각각의 방식이 갖는 장단점이 있으므로 상황에 맞추어 적절한 통신 방식을 선택하면 됩니다.</p>
<table>
<thead>
<tr>
<th>ESP32 통신모드</th>
<th>블루투스</th>
<th>wifi Station Mode</th>
<th>wifi AP Mode</th>
</tr>
</thead>
<tbody><tr>
<td>라우터</td>
<td>불필요</td>
<td>필요</td>
<td>불필요</td>
</tr>
<tr>
<td>통신거리</td>
<td>10m 이내 (장애물에 약함)</td>
<td>일반적인 wifi 도달 거리와 동일</td>
<td>좌동</td>
</tr>
<tr>
<td>전력</td>
<td>저전력</td>
<td>블루투스 통신에 비해 사용량 큼</td>
<td>좌동</td>
</tr>
</tbody></table>
<br>

<p>학교에서 ESP32를 이용하는 경우,</p>
<ul>
<li>다양한 형태의 과학 실험에 대응할 수 있어야 함</li>
<li>과학실 내부 혹은 야외에서도 이용할 수 있도록 이동이 편리해야 함<ul>
<li>기본적으로 라우터에 종속되지 않는 것이 좋음</li>
</ul>
</li>
<li>디스플레이 장치는 학생이 본인의 스마트폰을 이용할 수 있어야 함<ul>
<li>별도의 OLED, LCD와 같은 디스플레이를 이용하는 경우, 실험장치의 배선이 복잡해짐</li>
<li>단, OLED나 LCD를 활용하는 경우 흥미 유발에 도움을 줌</li>
</ul>
</li>
</ul>
<br>

<p>위 사항을 고려할 때 ESP32를 통해 여러 가지 실험을 하고 결과를 도출하는 환경의 다양성을 수용하기 위하여, AP mode가 가장 적합하다고 판단하여 이를 사용해보고자 합니다.</p>
<br>

<br>

<h2 id="AP-mode-설정"><a href="#AP-mode-설정" class="headerlink" title="AP mode 설정"></a>AP mode 설정</h2><p>참고: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://randomnerdtutorials.com/esp32-access-point-ap-web-server/">https://randomnerdtutorials.com/esp32-access-point-ap-web-server/</a></p>
<ul>
<li><p>ssid, password 설정</p>
<ul>
<li>과학실에서 모둠별로 별도의 ESP32를 이용한다면, 각 모둠에서 사용하는 ESP32를 구분할 수 있도록 ssid에 각 모둠의 번호를 적어두는 것이 좋을 것입니다. 동일한 ssid가 설정되면 다른 모둠의 데이터 값을 받을 수 있으므로, 반드시 구분짓도록 안내해야 합니다.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* ssid = <span class="string">&quot;ESP32-AP-x&quot;</span>;      <span class="comment">// max 63 characters, x is team number</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* password = <span class="string">&quot;123456789&quot;</span>;   <span class="comment">// min 8 characters </span></span><br></pre></td></tr></table></figure></li>
<li><p>AP mode 실행: 위의 설정에 의해 다음의 라인을 통해 AP mode를 실행합니다.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WiFi.softAP(ssid, password);</span><br></pre></td></tr></table></figure></li>
<li><p>AP mode 실행 옵션: ssid, password 이외의 다양한 옵션을 추가할 경우에는 아래의 방법으로 설정하고 AP mode를 실행합니다.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WiFi.softAP(<span class="keyword">const</span> <span class="keyword">char</span>* ssid, <span class="keyword">const</span> <span class="keyword">char</span>* password, <span class="keyword">int</span> channel, <span class="keyword">int</span> ssid_hidden, <span class="keyword">int</span> max_connection)</span><br></pre></td></tr></table></figure>

<ul>
<li>channel: Wi-Fi channel number (1-13)</li>
<li>ssid_hidden: (0 = broadcast SSID, 1 = hide SSID)</li>
<li>max_connection: maximum simultaneous connected clients (1-4)</li>
</ul>
</li>
<li><p>AP mode 실행시 ESP32에 부여된 IP는 다음의 방법으로 확인할 수 있습니다.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IPAddress IP = WiFi.softAPIP();</span><br><span class="line">Serial.print(<span class="string">&quot;AP IP address: &quot;</span>);</span><br><span class="line">Serial.println(IP);</span><br></pre></td></tr></table></figure>

<ul>
<li>AP mode를 사용할 경우, ESP32는 기본적으로 <strong>192.168.4.1</strong>의 주소를 부여 받습니다.</li>
</ul>
</li>
</ul>
<br>

<br>

<h2 id="Websocket-설정"><a href="#Websocket-설정" class="headerlink" title="Websocket 설정"></a>Websocket 설정</h2><p>참고: <a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.martyncurrey.com/esp8266-and-the-arduino-ide-part-10a-iot-website-temperature-and-humidity-monitor/">Martyn Currey Blog</a></p>
<br>

<h4 id="왜-웹소켓을-사용하는가"><a href="#왜-웹소켓을-사용하는가" class="headerlink" title="왜 웹소켓을 사용하는가?"></a>왜 웹소켓을 사용하는가?</h4><p>이 문서는 학생들의 스마트폰을 클라이언트로 활용하여 과학실험을 하는 상황을 전제로,  ESP32에 웹브라우저를 통해 접속하여 실험결과 값을 모니터링하려고 합니다. 실험의 성격에 따라 웹페이지를 refresh하면서 모니터링하는 것이 좋을 수도 있고, refresh하지 않아도 결과값이 update되는 것이 더 좋을 수도 있겠지만, 여기서는 후자의 방법을 택하여 결과값을 나타내보도록 하겠습니다. 이때 필요한 기술이 웹소켓입니다.</p>
<br>

<h3 id="웹소켓"><a href="#웹소켓" class="headerlink" title="웹소켓"></a>웹소켓</h3><p>WebSocket은 TCP 연결을 사용하여 서버와 클라이언트 사이의 지속적인 양방향 통신을 허용하는 방법입니다. 이를 통해 클라이언트에서 서버로, 서버에서 클라이언트로 데이터를 언제든지 보낼 수 있습니다.</p>
<p>WebSocket을 활용하기 이전에는, 일반적인 HTML 방식이나 AJAX(Asynchronous Javascript And XML)와 같은 비동기식 방법을 사용하여 센서값을 클라이언트에게 전송하는 방식을 사용했습니다. 단, 이 방법은 새로운 센서값이 발생하더라도 동시에 여러 개의 탭 (동일하거나 다른 장치에 있음)이 열려있다면 상태가 모두 업데이트되지 않는 다는 단점이 있습니다. 그렇기 때문에 웹페이지 전체를 refresh하거나 웹페이지의 일부분만이라도 새롭게 로드해야만 변경사항이 반영시켜야만 했습니다. </p>
<p>이를 보완하기 위해 WebSocket 프로토콜을 사용할 수 있습니다. WebSocket은 변경 사항이 발생하면 모든 클라이언트에 알림을 보내고 그에 따라 웹 페이지를 업데이트 합니다.</p>
<p>클라이언트는 WebSocket 핸드 셰이크라는 프로세스를 통해 서버와 WebSocket 연결을 설정합니다. 핸드 셰이크는 HTTP request와 response로 시작하여 서버가 동일한 포트에서 WebSocket 연결뿐만 아니라 HTTP 연결을 처리 할 수 있도록 합니다. 연결이 설정되면 클라이언트와 서버는 WebSocket 데이터를 full duplex 모드로 보낼 수 있습니다. 즉, WebSockets 프로토콜을 사용하여 서버 (ESP32 보드)는 요청없이 클라이언트 또는 모든 클라이언트에 정보를 보낼 수 있습니다. 이를 통해 변경 사항이 발생할 때 웹 브라우저에 정보를 보낼 수도 있습니다.</p>
<br>

<h3 id="라이브러리"><a href="#라이브러리" class="headerlink" title="라이브러리"></a>라이브러리</h3><p>ESP32에서는 Markus Sattler가 만든 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Links2004/arduinoWebSockets">Websockets</a>라는 라이브러리를 통해 구현합니다.</p>
<p><img src="/image/websocket01.png"></p>
<br>

<br>

<h2 id="sketch-전체"><a href="#sketch-전체" class="headerlink" title="sketch: 전체"></a>sketch: 전체</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HTTP headers always start with a response code (e.g. HTTP/1.1 200 OK)</span></span><br><span class="line"><span class="comment">// and a content-type so the client knows what&#x27;s coming, then a blank line:</span></span><br><span class="line">String html_header = <span class="string">&quot;HTTP/1.1 200 OK\r\nContent-Type: text/html\r\n\r\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HTTP main page</span></span><br><span class="line">String html_main = <span class="string">R&quot;=====(</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">  &lt;meta name=&#x27;viewport&#x27; content=&#x27;width=device-width, initial-scale=1.0&#x27;/&gt;</span></span><br><span class="line"><span class="string">  &lt;meta charset=&#x27;utf-8&#x27;&gt;</span></span><br><span class="line"><span class="string">  &lt;style&gt;</span></span><br><span class="line"><span class="string">    body     &#123; font-size:100%;&#125; </span></span><br><span class="line"><span class="string">    #main    &#123; display: table; width: 300px; margin: auto;  padding: 10px 10px 10px 10px; border: 3px solid blue; border-radius: 10px; text-align:center;&#125; </span></span><br><span class="line"><span class="string">    p        &#123; font-size: 100%; &#125;</span></span><br><span class="line"><span class="string">  &lt;/style&gt;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">  &lt;title&gt;ESP32 Websockets Sensor Monitor&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div id=&#x27;main&#x27;&gt;</span></span><br><span class="line"><span class="string">    &lt;h3&gt;ESP32 Websockets Monitor&lt;/h3&gt;</span></span><br><span class="line"><span class="string">    &lt;div id=&#x27;content&#x27;&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;Potentiometer1 = &lt;span id=&#x27;potentiometer1&#x27;&gt;00&lt;/span&gt; Ohm&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;Potentiometer2 = &lt;span id=&#x27;potentiometer2&#x27;&gt;00&lt;/span&gt; Ohm&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;Touch Sensor   = &lt;span id=&#x27;touch&#x27;&gt;00&lt;/span&gt; Value&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;Brightness     = &lt;span id=&#x27;brightness&#x27;&gt;00&lt;/span&gt; Value&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;Data = &lt;span id=&#x27;recData&#x27;&gt;00&lt;/span&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;br /&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  var Socket;</span></span><br><span class="line"><span class="string">    function init() &#123;</span></span><br><span class="line"><span class="string">      Socket = new WebSocket(&#x27;ws://&#x27; + window.location.hostname + &#x27;:81/&#x27;);</span></span><br><span class="line"><span class="string">      Socket.onmessage = function(event) &#123; processReceivedCommand(event); &#125;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">  function processReceivedCommand(evt) &#123;</span></span><br><span class="line"><span class="string">    var data = evt.data;</span></span><br><span class="line"><span class="string">    document.getElementById(&#x27;recData&#x27;).innerHTML = data;</span></span><br><span class="line"><span class="string">    var tmp = data.split(&#x27;|&#x27;);</span></span><br><span class="line"><span class="string">    document.getElementById(&#x27;potentiometer1&#x27;).innerHTML = tmp[0];  </span></span><br><span class="line"><span class="string">    document.getElementById(&#x27;potentiometer2&#x27;).innerHTML = tmp[1];</span></span><br><span class="line"><span class="string">    document.getElementById(&#x27;touch&#x27;).innerHTML = tmp[2];</span></span><br><span class="line"><span class="string">    document.getElementById(&#x27;brightness&#x27;).innerHTML = tmp[3];</span></span><br><span class="line"><span class="string">    //consol.log(evt.data);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">  function sendText(data) &#123; Socket.send(data); &#125;</span></span><br><span class="line"><span class="string">  window.onload = function(e) &#123; init(); &#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">)=====&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WiFi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WiFiClient.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WiFiAP.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WebSocketsServer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Sensors are connected to GPIO 32~35</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> potPin1 = <span class="number">34</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> potPin2 = <span class="number">33</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> touPin = <span class="number">35</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> briPin = <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// variable for storing the potentiometer value</span></span><br><span class="line"><span class="keyword">int</span> potentiometer1 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> potentiometer2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> touch = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> brightness = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set these to your desired credentials.</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *ssid = <span class="string">&quot;ESP32-AP&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *password = <span class="string">&quot;123456789&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">WiFiServer <span class="title">server</span><span class="params">(<span class="number">80</span>)</span></span>;</span><br><span class="line">WebSocketsServer webSocket = WebSocketsServer(<span class="number">81</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  Serial.begin(<span class="number">115200</span>);</span><br><span class="line">  Serial.println();</span><br><span class="line">  Serial.println(<span class="string">&quot;Configuring access point...&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// You can remove the password parameter if you want the AP to be open.</span></span><br><span class="line">  WiFi.softAP(ssid, password);</span><br><span class="line">  IPAddress myIP = WiFi.softAPIP();</span><br><span class="line">  Serial.print(<span class="string">&quot;AP IP address: &quot;</span>);</span><br><span class="line">  Serial.println(myIP);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// start a server</span></span><br><span class="line">  server.begin();</span><br><span class="line">  Serial.println(<span class="string">&quot;Server started&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// start the websocket</span></span><br><span class="line">  webSocket.begin();</span><br><span class="line">  Serial.println(<span class="string">&quot;websocket started&quot;</span>);</span><br><span class="line">  Serial.println(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  Serial.println(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// webSocketEvent is the function to call when there is a websocket event</span></span><br><span class="line">  webSocket.onEvent(webSocketEvent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// check the websocket status.</span></span><br><span class="line">  webSocket.loop();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// listen for incoming clients</span></span><br><span class="line">  WiFiClient client = server.available();   </span><br><span class="line"></span><br><span class="line">  <span class="comment">// if you get a client,</span></span><br><span class="line">  <span class="keyword">if</span> (client) &#123;</span><br><span class="line">    client.flush();</span><br><span class="line">    client.print( html_header );</span><br><span class="line">    client.print( html_main ); </span><br><span class="line">    Serial.println(<span class="string">&quot;New page served&quot;</span>);</span><br><span class="line">    Serial.println(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  updateSensors();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updateSensors</span><span class="params">()</span></span>&#123;</span><br><span class="line">  potentiometer1 = analogRead(potPin1);</span><br><span class="line">  potentiometer2 = analogRead(potPin2);</span><br><span class="line">  touch = analogRead(touPin);</span><br><span class="line">  brightness = analogRead(briPin);</span><br><span class="line"></span><br><span class="line">  String data = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  data = String(data + potentiometer1); </span><br><span class="line">  data = String(data + <span class="string">&quot;|&quot;</span>); </span><br><span class="line">  data = String(data + potentiometer2); </span><br><span class="line">  data = String(data + <span class="string">&quot;|&quot;</span>); </span><br><span class="line">  data = String(data + touch); </span><br><span class="line">  data = String(data + <span class="string">&quot;|&quot;</span>); </span><br><span class="line">  data = String(data + brightness); </span><br><span class="line"> </span><br><span class="line">  webSocket.broadcastTXT(data); <span class="comment">// send the data</span></span><br><span class="line">  Serial.println(data);         <span class="comment">// display the data in the serial monitor</span></span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">webSocketEvent</span><span class="params">(byte num, WStype_t type, <span class="keyword">uint8_t</span> * payload, <span class="keyword">size_t</span> length)</span></span>&#123;</span><br><span class="line">    Serial.println();</span><br><span class="line">    Serial.print(<span class="string">&quot;WStype = &quot;</span>);   Serial.println(type);  </span><br><span class="line">    Serial.print(<span class="string">&quot;WS payload = &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123; Serial.print((<span class="keyword">char</span>) payload[i]); &#125;</span><br><span class="line">    Serial.println();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h4 id="Part1-웹페이지"><a href="#Part1-웹페이지" class="headerlink" title="Part1: 웹페이지"></a>Part1: 웹페이지</h4><h5 id="header"><a href="#header" class="headerlink" title="header"></a>header</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HTTP headers always start with a response code (e.g. HTTP/1.1 200 OK)</span></span><br><span class="line"><span class="comment">// and a content-type so the client knows what&#x27;s coming, then a blank line:</span></span><br><span class="line">String html_header = <span class="string">&quot;HTTP/1.1 200 OK\r\nContent-Type: text/html\r\n\r\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<br>

<h5 id="main-head"><a href="#main-head" class="headerlink" title="main_head"></a>main_head</h5><ul>
<li>style을 지정합니다.</li>
<li>웹브라우저의 탭에 표기될 title을 지정합니다.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HTTP main page</span></span><br><span class="line">String html_main = <span class="string">R&quot;=====(</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">  &lt;meta name=&#x27;viewport&#x27; content=&#x27;width=device-width, initial-scale=1.0&#x27;/&gt;</span></span><br><span class="line"><span class="string">  &lt;meta charset=&#x27;utf-8&#x27;&gt;</span></span><br><span class="line"><span class="string">  &lt;style&gt;</span></span><br><span class="line"><span class="string">    body     &#123; font-size:100%;&#125; </span></span><br><span class="line"><span class="string">    #main    &#123; display: table; width: 300px; margin: auto;  padding: 10px 10px 10px 10px; border: 3px solid blue; border-radius: 10px; text-align:center;&#125; </span></span><br><span class="line"><span class="string">    p        &#123; font-size: 100%; &#125;</span></span><br><span class="line"><span class="string">  &lt;/style&gt;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">  &lt;title&gt;ESP32 Websockets Sensor Monitor&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>R은 <strong>이러한 구분 기호 사이의 모든 것을 원시 문자열로 처리</strong>하라는 것을 의미합니다. 즉, “===== (     ) =====”사이의 모든 것을 문자열로 처리합니다.<ul>
<li>여기서 사용한 ‘’=====’’는 특정 범위 내에서 다른 형태로 바꿔서 사용하는 것이 가능합니다.<ul>
<li>예를들어, This is “text”를 문자열로 할당하기 위해 R “-= (This is”text “) =-“를 사용할 수 있습니다.</li>
</ul>
</li>
<li>문자열 길고 다양한 형태의 기호나 특수문자를 포함하는 경우,  이러한 방식을 사용하는 것이 좋습니다.<ul>
<li>This is “text”를 문자열로 처리하려면, “ 앞에 각각 \를 덧붙여야 합니다. 즉 This is \“로 작성되어야합니다.</li>
</ul>
</li>
<li>주의할 점은 ===== 가 텍스트 어디에도 표시되지 않아야합니다.</li>
</ul>
</li>
</ul>
<br>

<h5 id="main-body"><a href="#main-body" class="headerlink" title="main_body"></a>main_body</h5><ul>
<li>웹브라우저에 표기될 내용을 만듭니다.</li>
<li>span id는 아두이노코드에서 사용하는 센서값 변수를 사용합니다.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id=<span class="string">&#x27;main&#x27;</span>&gt;</span><br><span class="line">    &lt;h3&gt;ESP32 Websockets Monitor&lt;/h3&gt;</span><br><span class="line">    &lt;div id=<span class="string">&#x27;content&#x27;</span>&gt;</span><br><span class="line">      &lt;p&gt;Potentiometer1 = &lt;span id=<span class="string">&#x27;potentiometer1&#x27;</span>&gt;<span class="number">00</span>&lt;/span&gt; Ohm&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;Potentiometer2 = &lt;span id=<span class="string">&#x27;potentiometer2&#x27;</span>&gt;<span class="number">00</span>&lt;/span&gt; Ohm&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;Touch Sensor   = &lt;span id=<span class="string">&#x27;touch&#x27;</span>&gt;<span class="number">00</span>&lt;/span&gt; Value&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;Brightness     = &lt;span id=<span class="string">&#x27;brightness&#x27;</span>&gt;<span class="number">00</span>&lt;/span&gt; Value&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;Data = &lt;span id=<span class="string">&#x27;recData&#x27;</span>&gt;<span class="number">00</span>&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;br /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<br>

<h5 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h5><ul>
<li>데이터가 수신되어 Websocket 이벤트가 생기면 웹사이트의 자바스크립트를 통해 <strong>processReceivedCommand()</strong> 함수가 호출 됩니다. 이 함수는 수신된 데이터를 <strong>배열</strong> <strong>tmp</strong>로 분해한 다음 개별 배열 요소를 웹사이트의 각 부분에 복사합니다.</li>
<li>데이터가 <strong>potentiometer1|potentiometer2|touch|brightness</strong> 형식으로 수신되면, 막대 문자를 기준으로 데이터를 tmp[] 배열로 분할하여 저장합니다. 분할 기준인 막대문자는 <strong>var tmp = data.split (‘|’)</strong> 문을 통해 지정합니다.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  var Socket;</span><br><span class="line">    <span class="function">function <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      Socket = <span class="keyword">new</span> WebSocket(<span class="string">&#x27;ws://&#x27;</span> + window.location.hostname + <span class="string">&#x27;:81/&#x27;</span>);</span><br><span class="line">      Socket.onmessage = function(event) &#123; processReceivedCommand(event); &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="function">function <span class="title">processReceivedCommand</span><span class="params">(evt)</span> </span>&#123;</span><br><span class="line">    var data = evt.data;</span><br><span class="line">    document.getElementById(<span class="string">&#x27;recData&#x27;</span>).innerHTML = data;</span><br><span class="line">    var tmp = data.split(<span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">    document.getElementById(<span class="string">&#x27;potentiometer1&#x27;</span>).innerHTML = tmp[<span class="number">0</span>];  </span><br><span class="line">    document.getElementById(<span class="string">&#x27;potentiometer2&#x27;</span>).innerHTML = tmp[<span class="number">1</span>];</span><br><span class="line">    document.getElementById(<span class="string">&#x27;touch&#x27;</span>).innerHTML = tmp[<span class="number">2</span>];</span><br><span class="line">    document.getElementById(<span class="string">&#x27;brightness&#x27;</span>).innerHTML = tmp[<span class="number">3</span>];</span><br><span class="line">    <span class="comment">//consol.log(evt.data);</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="function">function <span class="title">sendText</span><span class="params">(data)</span> </span>&#123; Socket.send(data); &#125;</span><br><span class="line">  window.onload = function(e) &#123; init(); &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/html&gt;</span><br><span class="line">)=====<span class="string">&quot;;</span></span><br></pre></td></tr></table></figure>

<br>

<h5 id="html-분리-선택사항"><a href="#html-분리-선택사항" class="headerlink" title="html 분리 (선택사항)"></a>html 분리 (선택사항)</h5><p>String형태로 지정된 자바스크립트를 포함하는 html 페이지를 표현하는 코드의 전체 길이로 인해 스케치가 복잡해보이므로, 전체 스케치의 상단에 있는 html 부분을 분리해도 됩니다. 파일은 분리되지만 컴파일 될때마다 메인 스케치에 포함될 것입니다. (혹은 ESP32의 SPIFFS를 사용하여 별도의 파일 형태로 업로드해도 됩니다.)</p>
<ul>
<li><p>Arduino IDE의 오른쪽 상단에 있는 작은 아래방향 화살표 클릭한 뒤 <strong>New Tab</strong> 선택</p>
<p><img src="/image/websocket02.png"></p>
</li>
<li><p>콘솔의 텍스트 상자에 분리하여 저장할 html 파일이름을 입력한 뒤 확인 클릭</p>
<ul>
<li>확장자는 .h로 사용 (※ 단, <strong>.html</strong> 확장자는 사용할 수 없음)</li>
</ul>
<p><img src="/image/websocket03.png"></p>
</li>
<li><p>Arduino IDE에 새로운 탭이 열리면, html_header와 html_main을 포함한 두개의 String 문을 복사하여 mainpage.h 탭에 붙여넣기 한 뒤 저장 (스케치가 위치한 폴더에 별도로 저장됨)</p>
<p><img src="/image/websocket04.png"></p>
</li>
<li><p>분리된 html 파일을 메인 스케치에 include문을 사용하여 삽입한 뒤 저장</p>
<p><img src="/image/websocket05.png"></p>
</li>
<li><p>Arduino IDE에서 메인 스케치를 열면, 별도의 탭에 분리된 html 파일도 함께 열림</p>
</li>
</ul>
<br>

<br>

<h4 id="Part2-메인-스케치"><a href="#Part2-메인-스케치" class="headerlink" title="Part2: 메인 스케치"></a>Part2: 메인 스케치</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updateSensors</span><span class="params">()</span></span>&#123;</span><br><span class="line">  potentiometer1 = analogRead(potPin1);</span><br><span class="line">  potentiometer2 = analogRead(potPin2);</span><br><span class="line">  touch = analogRead(touPin);</span><br><span class="line">  brightness = analogRead(briPin);</span><br><span class="line"></span><br><span class="line">  String data = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  data = String(data + potentiometer1); </span><br><span class="line">  data = String(data + <span class="string">&quot;|&quot;</span>); </span><br><span class="line">  data = String(data + potentiometer2); </span><br><span class="line">  data = String(data + <span class="string">&quot;|&quot;</span>); </span><br><span class="line">  data = String(data + touch); </span><br><span class="line">  data = String(data + <span class="string">&quot;|&quot;</span>); </span><br><span class="line">  data = String(data + brightness); </span><br><span class="line"> </span><br><span class="line">  webSocket.broadcastTXT(data); <span class="comment">// send the data</span></span><br><span class="line">  Serial.println(data);         <span class="comment">// display the data in the serial monitor</span></span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>센서값은 updateSensor() 함수를 통해 불러옵니다.</li>
<li>4종류의 센서값을 막대 문자(“|”)를 사용하여 연결한 뒤, <strong>String</strong> 형식의 data 변수에 모두 저장한 뒤, **webSocket.broadcastTXT(data)**을 사용하여 html로 보냅니다. String 형식은 메모리를 많이 사용하는 단점이 있지만, chars에 비해 데이터 처리가 간단해지므로 유용하게 사용할 수 있다. 더구나 ESP32의 내장 메모리는 일반적인 경우 충분히 큰 편에 속한다.</li>
</ul>
<br>

<br>

<h2 id="결과"><a href="#결과" class="headerlink" title="결과"></a>결과</h2><ul>
<li><p>ESP32를 AP모드로 동작하도록 하였으므로, 클라이언트에서 ESP32의 SSID를 찾아 접속한다. 예를들면,</p>
<ul>
<li>SSID : ESP32-AP-1</li>
<li>PASS : 123456789</li>
</ul>
</li>
<li><p>클라이언트의 웹브라우저를 통해, ESP32에 접속한다.</p>
<ul>
<li>(주소창에) 192.168.4.1</li>
</ul>
</li>
<li><p>결과 확인</p>
<p><img src="../image/websocket06.png"></p>
<p>실시간으로 센서값이 변경되는 것을 확인할 수 있습니다.</p>
</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>esp32 AP mode &amp; Websocket</p><p><a href="http://stemwith.github.io/2019/11/15/ESP32-AP-mode-and-Websocket/">http://stemwith.github.io/2019/11/15/ESP32-AP-mode-and-Websocket/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>chemidot</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-11-15</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-11-07</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/11/19/ESP32-OpenWeatherMap/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">esp32 OpenWeatherMap에서 실시간 날씨 정보 받기</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/11/01/%EC%97%91%EC%85%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9C%A0%ED%9A%A8%EC%84%B1%EA%B2%80%EC%82%AC-%EB%8F%99%EC%A0%81%EB%B2%94%EC%9C%84%EC%84%A4%EC%A0%95/"><span class="level-item">엑셀, 데이터 유효성 검사의 목록 구성시 동적 범위 설정</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-3-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-60x60 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="stemwith"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">stemwith</p><p class="is-size-6 is-block">de la Cruz a la fecha</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">49</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">3</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/esp32/"><span class="level-start"><span class="level-item">ESP32</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/science/"><span class="level-start"><span class="level-item">Science</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/arduino/"><span class="level-start"><span class="level-item">arduino</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/categories/diy/"><span class="level-start"><span class="level-item">diy</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/drone/"><span class="level-start"><span class="level-item">drone</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/esp32/"><span class="level-start"><span class="level-item">esp32</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/office/"><span class="level-start"><span class="level-item">office</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/science/"><span class="level-start"><span class="level-item">science</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-11-15T08:57:00.000Z">2021-11-15</time></p><p class="title"><a href="/2021/11/15/STEM-%EC%95%8C%EC%BD%94%EC%98%AC-%EB%9E%A8%ED%94%84-%EB%B0%9B%EC%B9%A8%EB%8C%80/">알코올램프 받침대 3D프린팅</a></p><p class="categories"><a href="/categories/science/">Science</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-11-15T08:57:00.000Z">2021-11-15</time></p><p class="title"><a href="/2021/11/15/%EC%95%8C%EC%BD%94%EC%98%AC%EB%9E%A8%ED%94%84-%EB%B0%9B%EC%B9%A8%EB%8C%80/">알코올램프 받침대 3D프린팅</a></p><p class="categories"><a href="/categories/science/">Science</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-11-02T08:57:00.000Z">2021-11-02</time></p><p class="title"><a href="/2021/11/02/STEM-%EC%A0%84%EC%9E%90%EA%B8%B0%ED%8C%8C-%EA%B2%80%EC%B6%9C%EA%B8%B0/">전자기파 검출기 만들기</a></p><p class="categories"><a href="/categories/science/">Science</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-11-01T09:27:53.000Z">2021-11-01</time></p><p class="title"><a href="/2021/11/01/ESP32-DC%EB%AA%A8%ED%84%B0/">ESP32, DC모터, TB6612FNG</a></p><p class="categories"><a href="/categories/esp32/">ESP32</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-10-10T09:27:53.000Z">2021-10-10</time></p><p class="title"><a href="/2021/10/10/ESP32-nRF24L01/">ESP32, nRF24L01 무선통신</a></p><p class="categories"><a href="/categories/esp32/">ESP32</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">아카이브</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">11월 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">10월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">9월 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">11월 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">10월 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">8월 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">11월 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">10월 2019</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">9월 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">11월 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">10월 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">9월 2018</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/06/"><span class="level-start"><span class="level-item">6월 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/01/"><span class="level-start"><span class="level-item">1월 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/11/"><span class="level-start"><span class="level-item">11월 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/10/"><span class="level-start"><span class="level-item">10월 2012</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">태그</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/3d/"><span class="tag">3D</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iot/"><span class="tag">iot</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rc/"><span class="tag">rc</span><span class="tag">4</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Welcome to &quot;stemwith&quot;" height="28"></a><p class="is-size-7"><span>&copy; 2021 chemidot</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>