<!DOCTYPE html>
<html lang="ko-kr" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="서보모터 SG-90#




모터드라이버, 회전센서, 모터, 제어회로가 내장된 기어 박스를 포함하고 있는 형태의 모터로, 스텝모터보다 힘이 강함
보통 선이 3가닥이며, 회전수와 각도 등의 움직임 제어가 가능
아두이노에서 많이 다루는 SG90 제품의 경우 0~180˚ 제어가 가능
아두이노UNO의 USB 전류량이 500mA 정도가 한계이므로 별도의 전원을 사용하지 않으면 1~2개의 서보모터만 사용 가능


라이브러리 추가하기#
서보모터를 사용하기 위한 Servo 라이브러리는 아두이노 IDE에 기본으로 포함되어 있다.

스케치&gt; 라이브러리 포함하기&gt; Servo 를 선택하면,
#include &lt;servo.h&gt; 라이브러리가 스케치에 추가 된다.


schematic#
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/posts/arduino-%EC%84%9C%EB%B3%B4%EB%AA%A8%ED%84%B0/">
  <meta property="og:site_name" content="stemwith">
  <meta property="og:title" content="Arduino, 서보모터">
  <meta property="og:description" content="서보모터 SG-90#모터드라이버, 회전센서, 모터, 제어회로가 내장된 기어 박스를 포함하고 있는 형태의 모터로, 스텝모터보다 힘이 강함 보통 선이 3가닥이며, 회전수와 각도 등의 움직임 제어가 가능 아두이노에서 많이 다루는 SG90 제품의 경우 0~180˚ 제어가 가능 아두이노UNO의 USB 전류량이 500mA 정도가 한계이므로 별도의 전원을 사용하지 않으면 1~2개의 서보모터만 사용 가능 라이브러리 추가하기#서보모터를 사용하기 위한 Servo 라이브러리는 아두이노 IDE에 기본으로 포함되어 있다.
스케치&gt; 라이브러리 포함하기&gt; Servo 를 선택하면, #include &lt;servo.h&gt; 라이브러리가 스케치에 추가 된다. schematic#">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-09-08T17:57:00+09:00">
    <meta property="article:modified_time" content="2018-09-08T17:57:00+09:00">


<title>Arduino, 서보모터 | stemwith</title>
<link rel="icon" href="/favicon.ico" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/posts/arduino-%EC%84%9C%EB%B3%B4%EB%AA%A8%ED%84%B0/">
<link rel="stylesheet" href="/book.min.b1622c146328a2cf2c7a184d8bfba1bc306e71c4e8b8a9a41d56992264175bc9.css" integrity="sha256-sWIsFGMoos8sehhNi/uhvDBuccTouKmkHVaZImQXW8k=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.a51994453e5fa3809f7eaaf6143af9de9b67838bac6ba6a9fe161e0559cc2672.js" integrity="sha256-pRmURT5fo4Cffqr2FDr53ptng4usa6ap/hYeBVnMJnI=" crossorigin="anonymous"></script>

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-128DRYVCRT"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-128DRYVCRT');
        }
      </script>


  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/og_image.png" alt="Logo" /></a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>

























</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Arduino, 서보모터</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#서보모터-sg-90">서보모터 SG-90</a></li>
        <li><a href="#서보모터-sg-90-라이브러리-없이-사용하기">서보모터 SG-90: 라이브러리 없이 사용하기</a></li>
        <li><a href="#서보모터와-인터럽트-동시에-사용하기">서보모터와 인터럽트 동시에 사용하기</a></li>
        <li><a href="#레이저-모듈-추가-서보모터-날개에-부착">레이저 모듈 추가: 서보모터 날개에 부착</a></li>
        <li><a href="#조도센서-추가">조도센서 추가</a></li>
        <li><a href="#keypad에서-값을-입력받아-회전시키기">Keypad에서 값을 입력받아 회전시키기</a></li>
        <li><a href="#비밀번호-확인하여-서보모터-회전시키기">비밀번호 확인하여 서보모터 회전시키기</a></li>
        <li><a href="#joystick을-사용하여-2개의-서보모터-제어하기">Joystick을 사용하여 2개의 서보모터 제어하기</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    Arduino, 서보모터
  </h1>
  
  <div class="flex align-center text-small book-post-date">
    <img src="/icons/calendar.svg" class="book-icon" alt="" />
    <span>September 8, 2018</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/arduino/">Arduino</a>
  </div>
  

  


  <div class="book-post-content markdown-inner"><h3 id="서보모터-sg-90">서보모터 SG-90<a class="anchor" href="#%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0-sg-90">#</a></h3>
<figure class="center"><img src="/image/servo-01.png" width="67%">
</figure>

<ul>
<li>모터드라이버, 회전센서, 모터, 제어회로가 내장된 기어 박스를 포함하고 있는 형태의 모터로, 스텝모터보다 힘이 강함</li>
<li>보통 선이 3가닥이며, 회전수와 각도 등의 움직임 제어가 가능</li>
<li>아두이노에서 많이 다루는 SG90 제품의 경우 0~180˚ 제어가 가능</li>
<li>아두이노UNO의 USB 전류량이 500mA 정도가 한계이므로 별도의 전원을 사용하지 않으면 1~2개의 서보모터만 사용 가능</li>
</ul>
<br>
<h4 id="라이브러리-추가하기">라이브러리 추가하기<a class="anchor" href="#%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac-%ec%b6%94%ea%b0%80%ed%95%98%ea%b8%b0">#</a></h4>
<p>서보모터를 사용하기 위한 Servo 라이브러리는 아두이노 IDE에 기본으로 포함되어 있다.</p>
<ul>
<li>스케치&gt; 라이브러리 포함하기&gt; Servo 를 선택하면,</li>
<li>#include &lt;servo.h&gt; 라이브러리가 스케치에 추가 된다.</li>
</ul>
<br>
<h4 id="schematic">schematic<a class="anchor" href="#schematic">#</a></h4>
<p><img src="/image/servo-02.jpg" alt="" /></p>
<table>
  <thead>
      <tr>
          <th>SG90</th>
          <th>Brown</th>
          <th>Red</th>
          <th>Orange</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Arduino</td>
          <td>GND</td>
          <td>5V</td>
          <td>10</td>
      </tr>
  </tbody>
</table>
<br>
<h4 id="sketch--서보모터-180º-회전-왕복하기">sketch : 서보모터 180º 회전 왕복하기<a class="anchor" href="#sketch--%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0-180%c2%ba-%ed%9a%8c%ec%a0%84-%ec%99%95%eb%b3%b5%ed%95%98%ea%b8%b0">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;Servo.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>Servo servomotor;                                <span style="color:#75715e">// servomotor 선언
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> position <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  servomotor.<span style="color:#a6e22e">attach</span>(<span style="color:#ae81ff">10</span>);                         <span style="color:#75715e">// servomotor 핀 설정
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span>(position <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; position <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">180</span>; position<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    servomotor.<span style="color:#a6e22e">write</span>(position);                  <span style="color:#75715e">// pos값의 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);                       
</span></span><span style="display:flex;"><span>  }                                 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span>(position <span style="color:#f92672">=</span> <span style="color:#ae81ff">180</span>; position <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>; position<span style="color:#f92672">--</span>)  <span style="color:#75715e">// 같은 방법으로 역회전
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  {
</span></span><span style="display:flex;"><span>    servomotor.<span style="color:#a6e22e">write</span>(position);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><ul>
<li>servomotor.write(숫자)를 사용할때, 숫자는 현재 위치에서의 ‘회전각’을 의미하는 것이 아니다!</li>
<li>초기 위치를 0º로 기준삼아, 표시된 숫자의 각도 위치로 이동하라는 의미이다. 예를들어서 servomotor.write(90)와 servomotor.write(30)을 연속으로 실행하면,
<ul>
<li>90도를 회전한 뒤, 추가로 30도를 회전하여 120도 위치에 있다 → ×</li>
<li>90도의 위치로 회전한 뒤, 역회전하여 (처음위치를 기준으로) 30도의 위치로 이동한다. → ○</li>
</ul>
</li>
</ul>
<ul>
<li>단, servo.h 라이브러리를 사용하면, 스케치 내에서 analogWrite를 사용할 수 없다는 단점도 있다.</li>
</ul>
<br>
<h4 id="sketch-시리얼모니터에서-각도값을-입력받아-회전시키기">sketch: 시리얼모니터에서 각도값을 입력받아 회전시키기<a class="anchor" href="#sketch-%ec%8b%9c%eb%a6%ac%ec%96%bc%eb%aa%a8%eb%8b%88%ed%84%b0%ec%97%90%ec%84%9c-%ea%b0%81%eb%8f%84%ea%b0%92%ec%9d%84-%ec%9e%85%eb%a0%a5%eb%b0%9b%ec%95%84-%ed%9a%8c%ec%a0%84%ec%8b%9c%ed%82%a4%ea%b8%b0">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;Servo.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Servo servomotor;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  servomotor.<span style="color:#a6e22e">attach</span>(<span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>  Serial.<span style="color:#a6e22e">begin</span>(<span style="color:#ae81ff">9600</span>);                  <span style="color:#75715e">// Serial 통신을 설정
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">while</span>(<span style="color:#f92672">!</span>Serial);
</span></span><span style="display:flex;"><span>  Serial.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Servor Mortor&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(Serial.<span style="color:#a6e22e">available</span>()){              <span style="color:#75715e">// Serial 모니터창에 어떤 값이 들어오면 실행
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    a <span style="color:#f92672">=</span> Serial.<span style="color:#a6e22e">parseInt</span>();             <span style="color:#75715e">// Serial 모니터창에서 받은 값을 a에 넘겨줌
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span>(a<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> a<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">180</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      Serial.<span style="color:#a6e22e">print</span>(<span style="color:#e6db74">&#34;angle : &#34;</span>);
</span></span><span style="display:flex;"><span>      Serial.<span style="color:#a6e22e">println</span>(a);
</span></span><span style="display:flex;"><span>      servomotor.<span style="color:#a6e22e">write</span>(a);             <span style="color:#75715e">// a값에 해당하는 각도의 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><br>
<br>
<h3 id="서보모터-sg-90-라이브러리-없이-사용하기">서보모터 SG-90: 라이브러리 없이 사용하기<a class="anchor" href="#%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0-sg-90-%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac-%ec%97%86%ec%9d%b4-%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0">#</a></h3>
<h4 id="for-sg90-with-arduino">for SG90 with Arduino<a class="anchor" href="#for-sg90-with-arduino">#</a></h4>
<ul>
<li>Frequency of that signal should be 50hz.</li>
<li>Its range is 544-2450 micro seconds for 0-180 degree angle.</li>
<li>Again its a little complex.</li>
<li>For example 0 degree signal will be something like 5 volts for 544 micro seconds and 0 volt for 19465.</li>
<li>highDelay
<ul>
<li>the time in which we want to keep voltage high on pin 10 and this unit is in micro seconds.</li>
</ul>
</li>
<li>lowDelay
<ul>
<li>the time in which want to keep voltage zero across pin 10 again this unit is going to be in micro seconds</li>
</ul>
</li>
<li>only HIGH part of signal wont operate servo. we have to send complete HIGH and LOW signal to make servo work.</li>
<li>deg_factor
<ul>
<li>signal range (2450 - 544) for SG90 divided by 180 which is equal to 10.6 something that we make 11 as an integer.</li>
</ul>
</li>
<li>Loop = 20000;
<ul>
<li>20000 micro seconds or 20 milli seconds is signal cycle or u can say total signal should be equal to 20 milli seconds including HIGH and LOW input. (50Hz)</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> servoPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;        <span style="color:#75715e">// servo is connected to pin 10.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> initialDelay <span style="color:#f92672">=</span> <span style="color:#ae81ff">544</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> highDelay, lowDelay;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> deg;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> deg_factor <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;      
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> Loop <span style="color:#f92672">=</span> <span style="color:#ae81ff">20000</span>;         
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span> (servoPin, OUTPUT);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (deg <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;deg <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">180</span>; deg<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">servoWrite</span>(servoPin, deg);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (deg <span style="color:#f92672">=</span> <span style="color:#ae81ff">180</span>;deg <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; deg<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">servoWrite</span>(servoPin, deg);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">servoWrite</span>(<span style="color:#66d9ef">int</span> servo, <span style="color:#66d9ef">int</span> duty)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  highDelay <span style="color:#f92672">=</span> initialDelay <span style="color:#f92672">+</span> (duty <span style="color:#f92672">*</span> deg_factor); <span style="color:#75715e">// setting angle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, HIGH);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(highDelay);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  lowDelay <span style="color:#f92672">=</span> Loop <span style="color:#f92672">-</span> highDelay;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, LOW);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(lowDelay);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">500</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><br>
<h4 id="시리얼-모니터에-입력한-문자로-서보모터-회전시키기">시리얼 모니터에 입력한 문자로 서보모터 회전시키기<a class="anchor" href="#%ec%8b%9c%eb%a6%ac%ec%96%bc-%eb%aa%a8%eb%8b%88%ed%84%b0%ec%97%90-%ec%9e%85%eb%a0%a5%ed%95%9c-%eb%ac%b8%ec%9e%90%eb%a1%9c-%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0-%ed%9a%8c%ec%a0%84%ec%8b%9c%ed%82%a4%ea%b8%b0">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> servoPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;        <span style="color:#75715e">// servo is connected to pin 10.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> initialDelay <span style="color:#f92672">=</span> <span style="color:#ae81ff">544</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> highDelay, lowDelay;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> deg <span style="color:#f92672">=</span> <span style="color:#ae81ff">90</span>;             <span style="color:#75715e">// servo initial degree
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> deg_factor <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;      
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> Loop <span style="color:#f92672">=</span> <span style="color:#ae81ff">20000</span>;         
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  Serial.<span style="color:#a6e22e">begin</span>(<span style="color:#ae81ff">9600</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span> (servoPin, OUTPUT);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">servoWrite</span>(servoPin, deg);  
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>(Serial.<span style="color:#a6e22e">available</span>() <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) 
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> flag<span style="color:#f92672">=</span>Serial.<span style="color:#a6e22e">read</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(flag<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;l&#39;</span>) {
</span></span><span style="display:flex;"><span>        deg <span style="color:#f92672">=</span> deg <span style="color:#f92672">-</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(deg <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            deg <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(flag<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;r&#39;</span>) {
</span></span><span style="display:flex;"><span>        deg <span style="color:#f92672">=</span> deg <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(deg <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">180</span>) {
</span></span><span style="display:flex;"><span>            deg <span style="color:#f92672">=</span> <span style="color:#ae81ff">180</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }      
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">servoWrite</span>(<span style="color:#66d9ef">int</span> servo, <span style="color:#66d9ef">int</span> duty)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  highDelay <span style="color:#f92672">=</span> initialDelay <span style="color:#f92672">+</span> (duty <span style="color:#f92672">*</span> deg_factor); <span style="color:#75715e">// setting angle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, HIGH);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(highDelay);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  lowDelay <span style="color:#f92672">=</span> Loop <span style="color:#f92672">-</span> highDelay;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, LOW);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(lowDelay);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">500</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><ul>
<li>l 을 입력하면, 5도 좌회전하며, ll을 입력하면 10도 좌회전한다.</li>
<li>r 을 입력하면, 5도 우회전하며, rr을 입력하면 10도 우회전한다.</li>
</ul>
<br>
<br>
<h3 id="서보모터와-인터럽트-동시에-사용하기">서보모터와 인터럽트 동시에 사용하기<a class="anchor" href="#%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0%ec%99%80-%ec%9d%b8%ed%84%b0%eb%9f%bd%ed%8a%b8-%eb%8f%99%ec%8b%9c%ec%97%90-%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0">#</a></h3>
<p>서보모터가 180도 회전하는 동안, 스위치를 누르면 13번 LED가 토글되도록 만들어보자.</p>
<br>
<h4 id="schematic-1">schematic<a class="anchor" href="#schematic-1">#</a></h4>
<p><img src="/image/SG90_Interrupt01.png" alt="" /></p>
<br>
<h4 id="sketch">sketch<a class="anchor" href="#sketch">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> servoPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;        <span style="color:#75715e">// servo is connected to pin 10.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> initialDelay <span style="color:#f92672">=</span> <span style="color:#ae81ff">544</span>;   
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> highDelay, lowDelay;  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> deg;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> deg_factor <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> Loop <span style="color:#f92672">=</span> <span style="color:#ae81ff">20000</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define swPin 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ledPin 13
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define debounceTime 500 </span><span style="color:#75715e">// Set debounce Time (unit ms) 버튼을 누른 후 0.5sec 이내에는 버튼 체크하지 않음
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>boolean state <span style="color:#f92672">=</span> false;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span>(servoPin, OUTPUT);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span>(swPin, INPUT_PULLUP);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span>(ledPin, OUTPUT);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">attachInterrupt</span>(<span style="color:#a6e22e">digitalPinToInterrupt</span>(swPin), swInterrupt, FALLING);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (deg <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;deg <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">180</span>; deg<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">servoWrite</span>(servoPin, deg);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (deg <span style="color:#f92672">=</span> <span style="color:#ae81ff">180</span>;deg <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; deg<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">servoWrite</span>(servoPin, deg);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">servoWrite</span>(<span style="color:#66d9ef">int</span> servo, <span style="color:#66d9ef">int</span> duty)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  highDelay <span style="color:#f92672">=</span> initialDelay <span style="color:#f92672">+</span> (duty <span style="color:#f92672">*</span> deg_factor); <span style="color:#75715e">// setting angle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, HIGH);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(highDelay);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  lowDelay <span style="color:#f92672">=</span> Loop <span style="color:#f92672">-</span> highDelay;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, LOW);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(lowDelay);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span> (<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">swInterrupt</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> lastTime <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> now <span style="color:#f92672">=</span> <span style="color:#a6e22e">millis</span>();
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>((now<span style="color:#f92672">-</span>lastTime) <span style="color:#f92672">&gt;</span> debounceTime) {
</span></span><span style="display:flex;"><span>    state<span style="color:#f92672">=!</span>state;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  lastTime <span style="color:#f92672">=</span> now;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(ledPin, state);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><ul>
<li>스위치를 눌렀다 뗄 때, 물리적 요인에 의해 다시 스위치가 눌리는 효과가 나타나기도 함 (chattering)</li>
<li>Chattering 효과를 방지하기 위해, 하드웨어적으로 콘덴서를 붙이거나, 소프트웨어적으로 debounce 시간을 만들어 해결해야 한다.</li>
</ul>
<br>
<br>
<h3 id="레이저-모듈-추가-서보모터-날개에-부착">레이저 모듈 추가: 서보모터 날개에 부착<a class="anchor" href="#%eb%a0%88%ec%9d%b4%ec%a0%80-%eb%aa%a8%eb%93%88-%ec%b6%94%ea%b0%80-%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0-%eb%82%a0%ea%b0%9c%ec%97%90-%eb%b6%80%ec%b0%a9">#</a></h3>
<h4 id="schematic-2">schematic<a class="anchor" href="#schematic-2">#</a></h4>
<p><img src="/image/SG90_Interrupt02.png" alt="" /></p>
<br>
<h4 id="sketch-1">sketch<a class="anchor" href="#sketch-1">#</a></h4>
<p>13번 핀에 레이저모듈을 연결하므로 위 스케치를 그대로 이용</p>
<br>
<br>
<h3 id="조도센서-추가">조도센서 추가<a class="anchor" href="#%ec%a1%b0%eb%8f%84%ec%84%bc%ec%84%9c-%ec%b6%94%ea%b0%80">#</a></h3>
<p>반대편에 조도센서를 놓고, 레이저 모듈이 움직이는 동안 버튼을 눌러 조도센서를 정확하게 맞추면 점수가 올라가는 게임을 만들어보자.</p>
<br>
<br>
<h3 id="keypad에서-값을-입력받아-회전시키기">Keypad에서 값을 입력받아 회전시키기<a class="anchor" href="#keypad%ec%97%90%ec%84%9c-%ea%b0%92%ec%9d%84-%ec%9e%85%eb%a0%a5%eb%b0%9b%ec%95%84-%ed%9a%8c%ec%a0%84%ec%8b%9c%ed%82%a4%ea%b8%b0">#</a></h3>
<h4 id="schematic-3">schematic<a class="anchor" href="#schematic-3">#</a></h4>
<p><img src="/image/servo-03.jpg" alt="" /></p>
<br>
<h4 id="sketch-2">sketch<a class="anchor" href="#sketch-2">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;Servo.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;Keypad.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>Servo servomotor;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> pos <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> byte ROWS <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;                          <span style="color:#75715e">// 키패드 배열 선언
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> byte COLS <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> keys[ROWS][COLS] <span style="color:#f92672">=</span> {                     <span style="color:#75715e">// 키패드 정의
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  {<span style="color:#e6db74">&#39;1&#39;</span>,<span style="color:#e6db74">&#39;2&#39;</span>,<span style="color:#e6db74">&#39;3&#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>},
</span></span><span style="display:flex;"><span>  {<span style="color:#e6db74">&#39;4&#39;</span>,<span style="color:#e6db74">&#39;5&#39;</span>,<span style="color:#e6db74">&#39;6&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>},
</span></span><span style="display:flex;"><span>  {<span style="color:#e6db74">&#39;7&#39;</span>,<span style="color:#e6db74">&#39;8&#39;</span>,<span style="color:#e6db74">&#39;9&#39;</span>,<span style="color:#e6db74">&#39;C&#39;</span>},
</span></span><span style="display:flex;"><span>  {<span style="color:#e6db74">&#39;*&#39;</span>,<span style="color:#e6db74">&#39;0&#39;</span>,<span style="color:#e6db74">&#39;#&#39;</span>,<span style="color:#e6db74">&#39;D&#39;</span>},
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>byte rowPins[ROWS] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>};            <span style="color:#75715e">// 키패드 연결 핀 설정
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>byte colPins[COLS] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Keypad keypad <span style="color:#f92672">=</span> <span style="color:#a6e22e">Keypad</span>( <span style="color:#a6e22e">makeKeymap</span>(keys), rowPins, colPins, ROWS, COLS );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  servomotor.<span style="color:#a6e22e">attach</span>(<span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> keyValue <span style="color:#f92672">=</span> keypad.<span style="color:#a6e22e">getKey</span>();
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(keyValue) {
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">switch</span>(keyValue) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;0&#39;</span> <span style="color:#f92672">:</span>                    <span style="color:#75715e">// 시리얼 모니터에 0을 입력하면
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">0</span>);       <span style="color:#75715e">// 0도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;1&#39;</span> <span style="color:#f92672">:</span>                    <span style="color:#75715e">// 시리얼 모니터에 1을 입력하면
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">15</span>);       <span style="color:#75715e">// 15도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;2&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">30</span>);       <span style="color:#75715e">// 30도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;3&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">45</span>);       <span style="color:#75715e">// 45도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;4&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">60</span>);       <span style="color:#75715e">// 60도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;5&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">75</span>);       <span style="color:#75715e">// 75도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;6&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">90</span>);       <span style="color:#75715e">// 90도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;7&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">120</span>);       <span style="color:#75715e">// 120도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;8&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">150</span>);       <span style="color:#75715e">// 150도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;9&#39;</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">180</span>);       <span style="color:#75715e">// 180도 위치로 이동
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">default</span> <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>     }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><br>
<br>
<h3 id="비밀번호-확인하여-서보모터-회전시키기">비밀번호 확인하여 서보모터 회전시키기<a class="anchor" href="#%eb%b9%84%eb%b0%80%eb%b2%88%ed%98%b8-%ed%99%95%ec%9d%b8%ed%95%98%ec%97%ac-%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0-%ed%9a%8c%ec%a0%84%ec%8b%9c%ed%82%a4%ea%b8%b0">#</a></h3>
<p>서보모터의 날개를 금고의 개폐장치로 사용하여, 비밀번호 금고를 만들어 보자.</p>
<br>
<h4 id="sketch-3">sketch<a class="anchor" href="#sketch-3">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;Keypad.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;Servo.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> tru<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;                        <span style="color:#75715e">// 비밀번호가 맞는지 확인
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;                      <span style="color:#75715e">// 4자리수 카운트
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> PW[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;1&#39;</span>,<span style="color:#e6db74">&#39;2&#39;</span>,<span style="color:#e6db74">&#39;3&#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>};     <span style="color:#75715e">//비밀번호
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>Servo servomotor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 키패드 설정 시작
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> byte ROWS <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> byte COLS <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>byte rowPins[ROWS] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>};
</span></span><span style="display:flex;"><span>byte colPins[COLS] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> keys[ROWS][COLS] <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  {<span style="color:#e6db74">&#39;1&#39;</span>,<span style="color:#e6db74">&#39;2&#39;</span>,<span style="color:#e6db74">&#39;3&#39;</span>, <span style="color:#e6db74">&#39;A&#39;</span>},
</span></span><span style="display:flex;"><span>  {<span style="color:#e6db74">&#39;4&#39;</span>,<span style="color:#e6db74">&#39;5&#39;</span>,<span style="color:#e6db74">&#39;6&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>},
</span></span><span style="display:flex;"><span>  {<span style="color:#e6db74">&#39;7&#39;</span>,<span style="color:#e6db74">&#39;8&#39;</span>,<span style="color:#e6db74">&#39;9&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>},
</span></span><span style="display:flex;"><span>  {<span style="color:#e6db74">&#39;*&#39;</span>,<span style="color:#e6db74">&#39;0&#39;</span>,<span style="color:#e6db74">&#39;#&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Keypad keypad <span style="color:#f92672">=</span> <span style="color:#a6e22e">Keypad</span>( <span style="color:#a6e22e">makeKeymap</span>(keys), rowPins, colPins, ROWS, COLS );
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 키패드 설정 끝
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  Serial.<span style="color:#a6e22e">begin</span>(<span style="color:#ae81ff">9600</span>);
</span></span><span style="display:flex;"><span>  servomotor.<span style="color:#a6e22e">attach</span>(<span style="color:#ae81ff">10</span>);          <span style="color:#75715e">// 서보모터 핀 설정
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> key <span style="color:#f92672">=</span> keypad.<span style="color:#a6e22e">getKey</span>();     <span style="color:#75715e">// 키패드 입력 변수
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (key) {
</span></span><span style="display:flex;"><span>    Serial.<span style="color:#a6e22e">println</span>(key);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(key<span style="color:#f92672">==</span>PW[count]) {          <span style="color:#75715e">// 입력번호와 비밀번호가 맞으면
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        count<span style="color:#f92672">++</span>;                  <span style="color:#75715e">// 자리수 카운트 1증가
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        tru<span style="color:#f92672">++</span>;                    <span style="color:#75715e">// 맞은수 값 1증가
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>     }
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(key<span style="color:#f92672">!=</span>PW[count]) {    <span style="color:#75715e">// 입력번호와 비밀번호가 틀리면
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        count<span style="color:#f92672">++</span>;                  <span style="color:#75715e">// 자리수 카운트 값만 1증가
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>     }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span>(key<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;#&#39;</span>)                 <span style="color:#75715e">// #을 누르면
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">re</span>();                     <span style="color:#75715e">// 초기화
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>     <span style="color:#66d9ef">if</span>(count<span style="color:#f92672">==</span><span style="color:#ae81ff">4</span>) {               <span style="color:#75715e">// 4자리 입력받은 값이
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(tru<span style="color:#f92672">==</span><span style="color:#ae81ff">4</span>)                <span style="color:#75715e">// 모두 맞으면
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#a6e22e">Su</span>();                   <span style="color:#75715e">// 성공
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">else</span>                      <span style="color:#75715e">// 그렇지 않으면(4자리는 입력했는데, 모두 맞지는 않았으면)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#a6e22e">Fa</span>();                   <span style="color:#75715e">// 실패
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        tru<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;                    <span style="color:#75715e">// tru, count값 초기화
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Su</span>() {                          <span style="color:#75715e">// 성공했을 때 실행
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">90</span>);              <span style="color:#75715e">// 90도 돌려서 도어락 열림
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Serial.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;open the door&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Fa</span>() {                        <span style="color:#75715e">// 실패한 경우는 도어락 잠금 유지
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  Serial.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;close the door&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">re</span>() {                        <span style="color:#75715e">// 비밀번호 입력중 #을 입력하면 초기화하고 도어락 잠금 유지
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  tru<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  servomotor.<span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  Serial.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;password reset&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><br>
<br>
<h3 id="joystick을-사용하여-2개의-서보모터-제어하기">Joystick을 사용하여 2개의 서보모터 제어하기<a class="anchor" href="#joystick%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%ec%97%ac-2%ea%b0%9c%ec%9d%98-%ec%84%9c%eb%b3%b4%eb%aa%a8%ed%84%b0-%ec%a0%9c%ec%96%b4%ed%95%98%ea%b8%b0">#</a></h3>
<h4 id="schematic-4">schematic<a class="anchor" href="#schematic-4">#</a></h4>
<p><img src="/image/SG90_Joystick01.png" alt="" /></p>
<br>
<h4 id="sketch-4">sketch<a class="anchor" href="#sketch-4">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#define JSTICKPIN A0      </span><span style="color:#75715e">// joystick is connected to pin 11
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> servoPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;        <span style="color:#75715e">// servo is connected to pin 10
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> initialDelay <span style="color:#f92672">=</span> <span style="color:#ae81ff">544</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> highDelay, lowDelay;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> deg, Jstick, duty;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> deg_factor <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;      
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> Loop <span style="color:#f92672">=</span> <span style="color:#ae81ff">20000</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span> (servoPin, OUTPUT);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">PrintValue</span>();
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>  Jstick <span style="color:#f92672">=</span> <span style="color:#a6e22e">analogRead</span>(JSTICKPIN);          
</span></span><span style="display:flex;"><span>  deg <span style="color:#f92672">=</span> <span style="color:#a6e22e">map</span>(Jstick, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1023</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">180</span>);     
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">servoWrite</span>(servoPin, deg);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">servoWrite</span>(<span style="color:#66d9ef">int</span> servo, <span style="color:#66d9ef">int</span> duty)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  highDelay <span style="color:#f92672">=</span> initialDelay <span style="color:#f92672">+</span> (duty <span style="color:#f92672">*</span> deg_factor); <span style="color:#75715e">// setting angle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, HIGH);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(highDelay);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  lowDelay <span style="color:#f92672">=</span> Loop <span style="color:#f92672">-</span> highDelay;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(servo, LOW);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delayMicroseconds</span>(lowDelay);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span> (<span style="color:#ae81ff">15</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">PrintValue</span>() {
</span></span><span style="display:flex;"><span>    Serial.<span style="color:#a6e22e">print</span>(<span style="color:#a6e22e">analogRead</span>(JSTICKPIN));
</span></span><span style="display:flex;"><span>    Serial.<span style="color:#a6e22e">println</span> (<span style="color:#e6db74">&#34; Joystick Value&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
    <a href="/posts/arduino-%EC%8A%A4%ED%85%9D%EB%AA%A8%ED%84%B0/" class="flex align-center">
      <img src="/icons/backward.svg" class="book-icon" alt="Previous" title="Arduino, 스텝모터" />
      <span>Arduino, 스텝모터</span>
    </a>
  
  </div>
  <div>
  
    <a href="/posts/arduino-piezo-buzzer/" class="flex align-center">
      <span>Arduino, 피에조 부저</span>
      <img src="/icons/forward.svg" class="book-icon" alt="Next" title="Arduino, 피에조 부저" />
    </a>
  
  </div>
</div>
 
        
  
  <div class="book-comments">

</div>
  
 
        
        

 
      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    

<aside class="book-toc">
  <div class="book-toc-content">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#서보모터-sg-90">서보모터 SG-90</a></li>
        <li><a href="#서보모터-sg-90-라이브러리-없이-사용하기">서보모터 SG-90: 라이브러리 없이 사용하기</a></li>
        <li><a href="#서보모터와-인터럽트-동시에-사용하기">서보모터와 인터럽트 동시에 사용하기</a></li>
        <li><a href="#레이저-모듈-추가-서보모터-날개에-부착">레이저 모듈 추가: 서보모터 날개에 부착</a></li>
        <li><a href="#조도센서-추가">조도센서 추가</a></li>
        <li><a href="#keypad에서-값을-입력받아-회전시키기">Keypad에서 값을 입력받아 회전시키기</a></li>
        <li><a href="#비밀번호-확인하여-서보모터-회전시키기">비밀번호 확인하여 서보모터 회전시키기</a></li>
        <li><a href="#joystick을-사용하여-2개의-서보모터-제어하기">Joystick을 사용하여 2개의 서보모터 제어하기</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </div>
</aside>

 
  </main>

  
</body>
</html>


















