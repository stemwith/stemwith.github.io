<!DOCTYPE html>
<html lang="ko-kr" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="DC모터 사용하기#
아두이노의 5V, 3.3V핀으로는 모터에 필요한 충분한 전압과 전류를 공급하기 어렵다. 그러므로 사용하려는 모터에 맞는 전압과 전류의 공급을 위한 모터드라이버를 사용해야 한다. 아두이노에서 주로 사용하는 모듈은 L293D, L298N와 TB6612FNG 등이 있으며, 여기서는 TB6612FNG 모터드라이버와 함께, 모터 및 아두이노 단독사용을 위하여 별도의 외부전원을 사용한다. 외부 전원으로는 모터를 위한 1.5V AA*4개와 함께 아두이노 단독사용을 위한 9V 사각전지(6F22)를 추가로 연결하였다.

1.5V AA 6개 혹은 3.7V 18650 2개를 직렬로 연결하여 사용하면, 9V 사각전지(6F22)가 필요하지 않으므로 이 방법을 추천한다. 또한 AA 건전지를 사용하는 경우 4WD기준 연속사용시간은 10분 정도뿐일 정도로 전지 소모가 매우 빠르므로, 충전이 가능한 18650 사용을 추천한다.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/posts/dc%EB%AA%A8%ED%84%B0-4wd-%EC%9E%90%EB%8F%99%EC%B0%A8-%EB%A7%8C%EB%93%A4%EA%B8%B0/">
  <meta property="og:site_name" content="STEM with">
  <meta property="og:title" content="DC모터 &#43; 4WD 자동차 만들기 (TB6612FNG)">
  <meta property="og:description" content="DC모터 사용하기#아두이노의 5V, 3.3V핀으로는 모터에 필요한 충분한 전압과 전류를 공급하기 어렵다. 그러므로 사용하려는 모터에 맞는 전압과 전류의 공급을 위한 모터드라이버를 사용해야 한다. 아두이노에서 주로 사용하는 모듈은 L293D, L298N와 TB6612FNG 등이 있으며, 여기서는 TB6612FNG 모터드라이버와 함께, 모터 및 아두이노 단독사용을 위하여 별도의 외부전원을 사용한다. 외부 전원으로는 모터를 위한 1.5V AA*4개와 함께 아두이노 단독사용을 위한 9V 사각전지(6F22)를 추가로 연결하였다.
1.5V AA 6개 혹은 3.7V 18650 2개를 직렬로 연결하여 사용하면, 9V 사각전지(6F22)가 필요하지 않으므로 이 방법을 추천한다. 또한 AA 건전지를 사용하는 경우 4WD기준 연속사용시간은 10분 정도뿐일 정도로 전지 소모가 매우 빠르므로, 충전이 가능한 18650 사용을 추천한다.">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-10-29T18:27:53+09:00">
    <meta property="article:modified_time" content="2019-10-29T18:27:53+09:00">
    <meta property="article:tag" content="Rc">


<title>DC모터 &#43; 4WD 자동차 만들기 (TB6612FNG) | STEM with</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/posts/dc%EB%AA%A8%ED%84%B0-4wd-%EC%9E%90%EB%8F%99%EC%B0%A8-%EB%A7%8C%EB%93%A4%EA%B8%B0/">
<link rel="stylesheet" href="/book.min.aeea42fb216bc5e1dbc1c7adf74b0ac79e17602b386834ac6f1c28574b966754.css" integrity="sha256-rupC&#43;yFrxeHbwcet90sKx54XYCs4aDSsbxwoV0uWZ1Q=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.a51994453e5fa3809f7eaaf6143af9de9b67838bac6ba6a9fe161e0559cc2672.js" integrity="sha256-pRmURT5fo4Cffqr2FDr53ptng4usa6ap/hYeBVnMJnI=" crossorigin="anonymous"></script>

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-128DRYVCRT"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-128DRYVCRT');
        }
      </script>


  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>STEM with</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>

























</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>DC모터 &#43; 4WD 자동차 만들기 (TB6612FNG)</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#dc모터-사용하기">DC모터 사용하기</a></li>
        <li><a href="#모터-1개-컨트롤하기">모터 1개 컨트롤하기</a></li>
        <li><a href="#4wd-자동차-만들기">4WD 자동차 만들기</a></li>
        <li><a href="#ir-리모컨으로-4wd-컨트롤하기">IR 리모컨으로 4WD 컨트롤하기</a></li>
        <li><a href="#초음파-센서-장착">초음파 센서 장착</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    DC모터 &#43; 4WD 자동차 만들기 (TB6612FNG)
  </h1>
  
  <div class="flex align-center text-small book-post-date">
    <img src="/icons/calendar.svg" class="book-icon" alt="" />
    <span>October 29, 2019</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/arduino/">Arduino</a>
  </div>
  

  
  <div class="text-small">
    
      <a href="/tags/rc/">Rc</a>
  </div>
  


  <div class="book-post-content markdown-inner"><h3 id="dc모터-사용하기">DC모터 사용하기<a class="anchor" href="#dc%eb%aa%a8%ed%84%b0-%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0">#</a></h3>
<p>아두이노의 5V, 3.3V핀으로는 모터에 필요한 충분한 전압과 전류를 공급하기 어렵다. 그러므로 사용하려는 모터에 맞는 전압과 전류의 공급을 위한 모터드라이버를 사용해야 한다. 아두이노에서 주로 사용하는 모듈은 L293D, L298N와 TB6612FNG 등이 있으며, 여기서는 TB6612FNG 모터드라이버와 함께, 모터 및 아두이노 단독사용을 위하여 별도의 외부전원을 사용한다. <del>외부 전원으로는 모터를 위한 1.5V AA*4개와 함께 아두이노 단독사용을 위한 9V 사각전지(6F22)를 추가로 연결하였다.</del></p>
<blockquote class='book-hint '>
<p>1.5V AA 6개 혹은 3.7V 18650 2개를 직렬로 연결하여 사용하면, 9V 사각전지(6F22)가 필요하지 않으므로 이 방법을 추천한다. 또한 AA 건전지를 사용하는 경우 4WD기준 연속사용시간은 10분 정도뿐일 정도로 전지 소모가 매우 빠르므로, 충전이 가능한 18650 사용을 추천한다.</p></blockquote><br>
<h4 id="tb6612fng">TB6612FNG<a class="anchor" href="#tb6612fng">#</a></h4>
<table>
  <thead>
      <tr>
          <th style="text-align: center">VM<br/>VCC<br/>GND(*)<br/>AOUT1<br/>AOUT2<br/>BOUT2<br/>BOUT1<br/>GND</th>
          <th style="text-align: center"><img src="/image/t/tb6612fng-01.png" alt="" /></th>
          <th style="text-align: center">PWMA<br/>AIN2<br/>AIN1<br/>STBY<br/>BIN1<br/>BIN2<br/>PWMB<br/>GND</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"></td>
          <td style="text-align: center"><figure class="center"><img src="/image/t/tb6612fng-02.png" width="80%">
</figure>
</td>
          <td style="text-align: center"></td>
      </tr>
  </tbody>
</table>
<ul>
<li>VM (모터 전압) = 15V max</li>
<li>VCC (로직 전압) = 2.7 ~ 5.5V</li>
<li><strong>GND</strong>
<ul>
<li>TB6612fng 모듈을 여러개 테스트한 결과, <strong>3번핀 GND</strong>에 연결할 경우 <strong>작동이 안되는</strong> 몇몇 제품이 있었음</li>
<li>그러므로 <strong>8번핀, 9번핀의 GND 사용을 권장</strong>함</li>
</ul>
</li>
<li>출력전류: 정전류 1.2A (3.2A peak)까지 (모터 2개 사용시 합산 전류임)</li>
<li>모터 제어모드: CW, CCW, short-brake, STOP, stand-by</li>
<li>두개의 모터 출력을 개별 제어하며, <strong>100kHz</strong>의 PWM으로 속도 제어</li>
<li>써멀 셧다운 및 저전압 감지회로 내장</li>
</ul>
<br>
<h5 id="pin의-사용">Pin의 사용<a class="anchor" href="#pin%ec%9d%98-%ec%82%ac%ec%9a%a9">#</a></h5>
<table>
  <thead>
      <tr>
          <th>핀번호</th>
          <th>모터드라이브1</th>
          <th>아두이노</th>
          <th>외부전원</th>
          <th>모터 / 역할</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>VM</td>
          <td></td>
          <td>(+) (DC모터에 사용하는 전압 사용)</td>
          <td></td>
      </tr>
      <tr>
          <td>2</td>
          <td>VCC</td>
          <td>+5V</td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>3</td>
          <td>GND (사용 비추천)</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>4</td>
          <td>A_OUT1</td>
          <td></td>
          <td></td>
          <td>모터A</td>
      </tr>
      <tr>
          <td>5</td>
          <td>A_OUT2</td>
          <td></td>
          <td></td>
          <td>모터A</td>
      </tr>
      <tr>
          <td>6</td>
          <td>B_OUT2</td>
          <td></td>
          <td></td>
          <td>모터B</td>
      </tr>
      <tr>
          <td>7</td>
          <td>B_OUT1</td>
          <td></td>
          <td></td>
          <td>모터B</td>
      </tr>
      <tr>
          <td>8</td>
          <td>GND</td>
          <td></td>
          <td>(-)</td>
          <td></td>
      </tr>
      <tr>
          <td>9</td>
          <td>GND</td>
          <td>GND</td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>10</td>
          <td>B_PWM</td>
          <td>6</td>
          <td></td>
          <td>모터B 속도제어</td>
      </tr>
      <tr>
          <td>11</td>
          <td>B_IN2</td>
          <td>12</td>
          <td></td>
          <td>모터B 방향제어</td>
      </tr>
      <tr>
          <td>12</td>
          <td>B_IN1</td>
          <td>11</td>
          <td></td>
          <td>모터B 방향제어</td>
      </tr>
      <tr>
          <td>13</td>
          <td>STBY</td>
          <td>10</td>
          <td></td>
          <td>모터 상태신호</td>
      </tr>
      <tr>
          <td>14</td>
          <td>A_IN1</td>
          <td>9</td>
          <td></td>
          <td>모터A 방향제어</td>
      </tr>
      <tr>
          <td>15</td>
          <td>A_IN2</td>
          <td>8</td>
          <td></td>
          <td>모터A 방향제어</td>
      </tr>
      <tr>
          <td>16</td>
          <td>A_PWM</td>
          <td>5</td>
          <td></td>
          <td>모터A 속도제어</td>
      </tr>
  </tbody>
</table>
<ul>
<li>속도제어에 사용하는 A_PWM, B_PWM은 아두이노의 PWM이 가능한 핀에 연결하여야 합니다. 여기서는 ~5, ~6번 핀 사용.</li>
</ul>
<br>
<h5 id="주의-pin-map이-다른-모듈의-경우">주의: Pin Map이 다른 모듈의 경우<a class="anchor" href="#%ec%a3%bc%ec%9d%98-pin-map%ec%9d%b4-%eb%8b%a4%eb%a5%b8-%eb%aa%a8%eb%93%88%ec%9d%98-%ea%b2%bd%ec%9a%b0">#</a></h5>
<p>TB6612FNG를 여러 개 구입하여 사용해본 결과, 위의 핀맵과 조금 다른 모듈도 있었다.</p>
<table>
  <thead>
      <tr>
          <th>핀번호</th>
          <th>모터드라이브1</th>
          <th>아두이노</th>
          <th>외부전원</th>
          <th>모터 / 역할</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>GND</td>
          <td>GND</td>
          <td>(-)</td>
          <td></td>
      </tr>
      <tr>
          <td>2</td>
          <td>VCC (2.7~5.5V)</td>
          <td>+5V</td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>3</td>
          <td>A_OUT1</td>
          <td></td>
          <td></td>
          <td>모터A</td>
      </tr>
      <tr>
          <td>4</td>
          <td>A_OUT2</td>
          <td></td>
          <td></td>
          <td>모터A</td>
      </tr>
      <tr>
          <td>5</td>
          <td>B_OUT2</td>
          <td></td>
          <td></td>
          <td>모터B</td>
      </tr>
      <tr>
          <td>6</td>
          <td>B_OUT1</td>
          <td></td>
          <td></td>
          <td>모터B</td>
      </tr>
      <tr>
          <td>7</td>
          <td>VM (15V max)</td>
          <td></td>
          <td>(+) (DC모터 요구 전압 사용)</td>
          <td></td>
      </tr>
      <tr>
          <td>8</td>
          <td>GND</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>9</td>
          <td>GND</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>10</td>
          <td>B_PWM</td>
          <td>6</td>
          <td></td>
          <td>모터B 속도제어</td>
      </tr>
      <tr>
          <td>11</td>
          <td>B_IN2</td>
          <td>12</td>
          <td></td>
          <td>모터B 방향제어</td>
      </tr>
      <tr>
          <td>12</td>
          <td>B_IN1</td>
          <td>11</td>
          <td></td>
          <td>모터B 방향제어</td>
      </tr>
      <tr>
          <td>13</td>
          <td>NC(STBY)</td>
          <td>10</td>
          <td></td>
          <td>모터 상태신호</td>
      </tr>
      <tr>
          <td>14</td>
          <td>A_IN1</td>
          <td>9</td>
          <td></td>
          <td>모터A 방향제어</td>
      </tr>
      <tr>
          <td>15</td>
          <td>A_IN2</td>
          <td>8</td>
          <td></td>
          <td>모터A 방향제어</td>
      </tr>
      <tr>
          <td>16</td>
          <td>A_PWM</td>
          <td>5</td>
          <td></td>
          <td>모터A 속도제어</td>
      </tr>
  </tbody>
</table>
<br>
<h4 id="tb6612fng와-dc모터의-연결">TB6612FNG와 DC모터의 연결<a class="anchor" href="#tb6612fng%ec%99%80-dc%eb%aa%a8%ed%84%b0%ec%9d%98-%ec%97%b0%ea%b2%b0">#</a></h4>
<h5 id="pin-map">Pin Map<a class="anchor" href="#pin-map">#</a></h5>
<p>TB6612FNG 모터드라이브는 2채널 형태이며, 만일 2WD 자동차를 만든다면 디지털핀 7개가 필요하다. 4개의 DC모터를 사용하여 4WD 자동차를 만드는 방법은 3가지로 나눠 생각해볼 수 있는데, 모든 바퀴를 각각 컨트롤 하는 방법, 왼쪽 바퀴와 오른쪽 바퀴로 나누어 컨트롤 하는 방법, 앞 바퀴와 뒷 바퀴로 나누어 컨트롤 하는 방법 등이 있다.</p>
<ul>
<li>모든 바퀴를 각각 컨트롤 하는 경우 : 모터드라이브 2개와 디지털핀 14개 사용
<ul>
<li>그런데, 아두이노에서 실제 사용할 수 있는 디지털핀의 개수가 12개(2~13번)이므로, 2개의 디지털핀이 부족하다.
<ul>
<li>아날로그핀을 디지털핀과 동일하게 사용할 수 있으므로, 2개의 아날로그핀을 추가로 사용한다.</li>
<li>또는 스케치 업로드시에만 0,1번 핀을 빼두었다가, 스케치 업로드가 끝나면 0,1번 핀을 사용한다. 이렇게 사용하면 0~13번까지 총 14개의 디지털핀을 확보할 수 있다.</li>
</ul>
</li>
</ul>
</li>
<li><strong>왼쪽과 오른쪽 바퀴로 나누어 컨트롤</strong> 하는 방법 : 디지털핀 7개 사용 (아래 본문에서 사용한 방법)</li>
<li>앞과 뒷 바퀴로 나누어 컨트롤 하는 방법 : 디지털핀 7개 사용. (단, 조향을 위한 추가적인 방법을 고려해야 함.)</li>
</ul>
<br>
<h4 id="h-sw-control-function">H-SW Control Function<a class="anchor" href="#h-sw-control-function">#</a></h4>
<table>
  <thead>
      <tr>
          <th>Input</th>
          <th></th>
          <th></th>
          <th></th>
          <th>Output</th>
          <th></th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>IN1</td>
          <td>IN2</td>
          <td>PWM</td>
          <td>STBY</td>
          <td>OUT1</td>
          <td>OUT2</td>
          <td>Mode</td>
      </tr>
      <tr>
          <td>H</td>
          <td>H</td>
          <td>H/L</td>
          <td>H</td>
          <td>L</td>
          <td>L</td>
          <td>Short Brake</td>
      </tr>
      <tr>
          <td>L</td>
          <td>H</td>
          <td>H</td>
          <td>H</td>
          <td>L</td>
          <td>H</td>
          <td>Count-Clockwise</td>
      </tr>
      <tr>
          <td>L</td>
          <td>H</td>
          <td>L</td>
          <td>H</td>
          <td>L</td>
          <td>L</td>
          <td>Short Brake</td>
      </tr>
      <tr>
          <td>H</td>
          <td>L</td>
          <td>H</td>
          <td>H</td>
          <td>H</td>
          <td>L</td>
          <td>Clockwise</td>
      </tr>
      <tr>
          <td>H</td>
          <td>L</td>
          <td>L</td>
          <td>H</td>
          <td>L</td>
          <td>L</td>
          <td>Short Brake</td>
      </tr>
      <tr>
          <td>L</td>
          <td>L</td>
          <td>H</td>
          <td>H</td>
          <td>OFF(High impedance)</td>
          <td>OFF(High impedance)</td>
          <td>Stop</td>
      </tr>
      <tr>
          <td>H/L</td>
          <td>H/L</td>
          <td>H/L</td>
          <td>L</td>
          <td>OFF(High impedance)</td>
          <td>OFF(High impedance)</td>
          <td>Standby</td>
      </tr>
  </tbody>
</table>
<br>
<p>출력 결과는 아래와 같으며,</p>
<ul>
<li>IN1이 LOW, IN2가 HIGH, PWM으로 신호를 출력할 경우 시계 반대 방향(CCW)으로 회전</li>
<li>IN1이 HIGH, IN2가 LOW, PWM으로 신호를 출력할 경우 시계 방향(CW)으로 회전</li>
<li>그 밖의 경우는 모두 stop 상태로 해석하면 된다.</li>
</ul>
<br>
<h3 id="모터-1개-컨트롤하기">모터 1개 컨트롤하기<a class="anchor" href="#%eb%aa%a8%ed%84%b0-1%ea%b0%9c-%ec%bb%a8%ed%8a%b8%eb%a1%a4%ed%95%98%ea%b8%b0">#</a></h3>
<p>여기서 사용하는 DC모터는 아래의 형태를 가진 기어드모터이며, 아두이노를 사용하여 자동차를 만드는데 많이 사용되는 저렴이 모터이다.</p>
<p><img src="/image/4wd-01.jpg" alt="" /></p>
<br>
<h4 id="schematic">schematic<a class="anchor" href="#schematic">#</a></h4>
<h5 id="uno보드와-컴퓨터를-usb선으로-연결하여-사용할-경우">UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%eb%a5%bc-usb%ec%84%a0%ec%9c%bc%eb%a1%9c-%ec%97%b0%ea%b2%b0%ed%95%98%ec%97%ac-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0">#</a></h5>
<p><img src="/image/4wd-02.png" alt="" /></p>
<br>
<h5 id="uno보드와-컴퓨터의-연결없이-vin핀을-사용하여-단독으로-사용할-경우">UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%ec%9d%98-%ec%97%b0%ea%b2%b0%ec%97%86%ec%9d%b4-vin%ed%95%80%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%ec%97%ac-%eb%8b%a8%eb%8f%85%ec%9c%bc%eb%a1%9c-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0">#</a></h5>
<ul>
<li>UNO 보드의 Vin에 외부전원(7.4V) (+)에 연결: 6.6V~12V 범위의 전원 연결 가능 (7.2V 이상 추천)</li>
<li>UNO 보드의 GND를 TB6612fng 모듈의 GND에 연결</li>
</ul>
<p><img src="/image/4wd-03.png" alt="" /></p>
<br>
<h4 id="sketch">sketch<a class="anchor" href="#sketch">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> STBY <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;            <span style="color:#75715e">// Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Motor A
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_PWM <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;            <span style="color:#75715e">// Speed Control
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> A_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span>(STBY, OUTPUT);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span>(A_PWM, OUTPUT);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span>(A_IN1, OUTPUT);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pinMode</span>(A_IN2, OUTPUT);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">move</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">0</span>);          <span style="color:#75715e">// motor A(right wheels), half speed, moving forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">1000</span>);              <span style="color:#75715e">// go for 1 second
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">stop</span>();                   <span style="color:#75715e">// stop
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">250</span>);               <span style="color:#75715e">// hold for 250ms until move again
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">move</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">1</span>);          <span style="color:#75715e">// motor A(right wheels), half speed, moving backward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">stop</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">delay</span>(<span style="color:#ae81ff">250</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">move</span>(<span style="color:#66d9ef">int</span> motor, <span style="color:#66d9ef">int</span> speed, <span style="color:#66d9ef">int</span> direction) {
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">- Move specific motor at speed and direction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">- motor: A -&gt; 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">- speed: 0 is off, and 255 is full speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">= direction: 0 clockwise, 1 counter-clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(STBY, HIGH);        <span style="color:#75715e">// Disable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  boolean inPin1 <span style="color:#f92672">=</span> LOW;            <span style="color:#75715e">// Defalut(direction=0) - Clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  boolean inPin2 <span style="color:#f92672">=</span> HIGH;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(direction <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {             <span style="color:#75715e">// Count-clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    inPin1 <span style="color:#f92672">=</span> HIGH;
</span></span><span style="display:flex;"><span>    inPin2 <span style="color:#f92672">=</span> LOW;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(motor <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){                  <span style="color:#75715e">// if motor == 1, right wheel
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">digitalWrite</span>(A_IN1, inPin1);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">digitalWrite</span>(A_IN2, inPin2);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">analogWrite</span>(A_PWM, speed);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> {                           <span style="color:#75715e">// if motor is not 1, left wheel
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">stop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">digitalWrite</span>(STBY, LOW);         <span style="color:#75715e">// Enable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}</span></span></code></pre></div><br>
<h5 id="회전-방향이-생각했던-방향과-반대로-회전하는-경우">회전 방향이 (생각했던 방향과) 반대로 회전하는 경우<a class="anchor" href="#%ed%9a%8c%ec%a0%84-%eb%b0%a9%ed%96%a5%ec%9d%b4-%ec%83%9d%ea%b0%81%ed%96%88%eb%8d%98-%eb%b0%a9%ed%96%a5%ea%b3%bc-%eb%b0%98%eb%8c%80%eb%a1%9c-%ed%9a%8c%ec%a0%84%ed%95%98%eb%8a%94-%ea%b2%bd%ec%9a%b0">#</a></h5>
<p>A_IN1핀과 A_IN2 핀의 번호를 바꿔준다. 즉, 위 스케치에서</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> A_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> A_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;</span></span></code></pre></div><p>부분을</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> A_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> A_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;</span></span></code></pre></div><p>로 바꿔준다.</p>
<br>
<h3 id="4wd-자동차-만들기">4WD 자동차 만들기<a class="anchor" href="#4wd-%ec%9e%90%eb%8f%99%ec%b0%a8-%eb%a7%8c%eb%93%a4%ea%b8%b0">#</a></h3>
<h4 id="schematic-1">schematic<a class="anchor" href="#schematic-1">#</a></h4>
<h5 id="uno보드와-컴퓨터를-usb선으로-연결하여-사용할-경우-1">UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%eb%a5%bc-usb%ec%84%a0%ec%9c%bc%eb%a1%9c-%ec%97%b0%ea%b2%b0%ed%95%98%ec%97%ac-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0-1">#</a></h5>
<p><img src="/image/4wd-04.png" alt="" /></p>
<br>
<h5 id="uno보드와-컴퓨터의-연결없이-vin핀을-사용하여-단독으로-사용할-경우-1">UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%ec%9d%98-%ec%97%b0%ea%b2%b0%ec%97%86%ec%9d%b4-vin%ed%95%80%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%ec%97%ac-%eb%8b%a8%eb%8f%85%ec%9c%bc%eb%a1%9c-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0-1">#</a></h5>
<ul>
<li>UNO 보드의 Vin에 외부전원(7.4V) (+)에 연결: 6.6V~12V 범위의 전원 연결 가능 (7.2V 이상 추천)</li>
<li>UNO 보드의 GND를 TB6612fng 모듈의 GND에 연결</li>
</ul>
<p><img src="/image/4wd-05.png" alt="" /></p>
<br>
<h4 id="sketch-1">sketch<a class="anchor" href="#sketch-1">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#75715e">// front wheel : B1 - A1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// rear  wheel : B2 - A2 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> STBY <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;            <span style="color:#75715e">// Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Motor A 1 &amp; 2(Right)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_PWM <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;             <span style="color:#75715e">// Speed Control
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> A_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Motor B 1 &amp; 2(Left)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_PWM <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>;             <span style="color:#75715e">// Speed Control
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> B_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  pinMode(STBY, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(A_PWM, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(A_IN1, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(A_IN2, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_PWM, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_IN1, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_IN2, OUTPUT);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">0</span>);                  <span style="color:#75715e">// motor A(right wheels), half speed, moving forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">0</span>);                  <span style="color:#75715e">// motor B(left wheels), half speed, moving forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  delay(<span style="color:#ae81ff">1000</span>);                      <span style="color:#75715e">// go for 1 second
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  stop();                           <span style="color:#75715e">// stop
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">250</span>);                       <span style="color:#75715e">// hold for 250ms until move again
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">1</span>);                  <span style="color:#75715e">// motor A(right wheels), half speed, moving backward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">1</span>);                  <span style="color:#75715e">// motor B(left wheels), half speed, moving backward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  delay(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>  stop();
</span></span><span style="display:flex;"><span>  delay(<span style="color:#ae81ff">250</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">move</span>(<span style="color:#66d9ef">int</span> motor, <span style="color:#66d9ef">int</span> speed, <span style="color:#66d9ef">int</span> direction) {   <span style="color:#75715e">//Move specific motor at speed and direction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//motor: A(Right) -&gt; 1, B(Left) -&gt; 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//speed: 0 is off, and 255 is full speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//direction: 0 clockwise, 1 counter-clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  digitalWrite(STBY, HIGH);        <span style="color:#75715e">// Disable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  boolean inPin1 <span style="color:#f92672">=</span> LOW;            <span style="color:#75715e">// Defalut(direction=0) - Clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  boolean inPin2 <span style="color:#f92672">=</span> HIGH;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(direction <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {             <span style="color:#75715e">// Count-clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    inPin1 <span style="color:#f92672">=</span> HIGH;
</span></span><span style="display:flex;"><span>    inPin2 <span style="color:#f92672">=</span> LOW;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(motor <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){                  <span style="color:#75715e">// if motor == 1, right wheel
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    digitalWrite(A_IN1, inPin1);
</span></span><span style="display:flex;"><span>    digitalWrite(A_IN2, inPin2);
</span></span><span style="display:flex;"><span>    analogWrite(A_PWM, speed);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {                         <span style="color:#75715e">// if motor is not 1, left wheel
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    digitalWrite(B_IN1, inPin1);
</span></span><span style="display:flex;"><span>    digitalWrite(B_IN2, inPin2);
</span></span><span style="display:flex;"><span>    analogWrite(B_PWM, speed);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">stop</span>() {
</span></span><span style="display:flex;"><span>  digitalWrite(STBY, LOW);        <span style="color:#75715e">// Enable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}</span></span></code></pre></div><br>
<br>
<h3 id="ir-리모컨으로-4wd-컨트롤하기">IR 리모컨으로 4WD 컨트롤하기<a class="anchor" href="#ir-%eb%a6%ac%eb%aa%a8%ec%bb%a8%ec%9c%bc%eb%a1%9c-4wd-%ec%bb%a8%ed%8a%b8%eb%a1%a4%ed%95%98%ea%b8%b0">#</a></h3>
<p>IR리모컨을 사용하여 RC카를 컨트롤 하기 위해서는 모터와 회로에서 발생하는 노이즈를 제거하기 위한 104 케패시터(0.1uF)를 사용하는 것이 원칙입니다. 반드시 사용해야 하는 것은 아니지만, 회로보호를 위해 캐패시터가 있는 경우에는 IR 수신부의 (+)와 (-)에 병렬연결하세요. 이에 더하여 후진시 방향전환도 가능하도록 수정해 봅니다.</p>
<br>
<h4 id="schematic-2">schematic<a class="anchor" href="#schematic-2">#</a></h4>
<h5 id="uno보드와-컴퓨터를-usb선으로-연결하여-사용할-경우-2">UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%eb%a5%bc-usb%ec%84%a0%ec%9c%bc%eb%a1%9c-%ec%97%b0%ea%b2%b0%ed%95%98%ec%97%ac-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0-2">#</a></h5>
<p><img src="/image/4wd-06.png" alt="" /></p>
<br>
<h5 id="uno보드와-컴퓨터의-연결없이-vin핀을-사용하여-단독으로-사용할-경우-2">UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%ec%9d%98-%ec%97%b0%ea%b2%b0%ec%97%86%ec%9d%b4-vin%ed%95%80%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%ec%97%ac-%eb%8b%a8%eb%8f%85%ec%9c%bc%eb%a1%9c-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0-2">#</a></h5>
<p><img src="/image/4wd-07.png" alt="" /></p>
<br>
<br>
<h4 id="irremote-라이브러리-추가하기">IRremote 라이브러리 추가하기<a class="anchor" href="#irremote-%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac-%ec%b6%94%ea%b0%80%ed%95%98%ea%b8%b0">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boarddefs.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;IRremote.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;IRremoteInt.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;ir_Lego_PF_BitStreamEncoder.h&gt;</span></span></span></code></pre></div><br>
<h4 id="사용할-리모컨-버튼-hex값">사용할 리모컨 버튼 HEX값<a class="anchor" href="#%ec%82%ac%ec%9a%a9%ed%95%a0-%eb%a6%ac%eb%aa%a8%ec%bb%a8-%eb%b2%84%ed%8a%bc-hex%ea%b0%92">#</a></h4>
<table>
  <thead>
      <tr>
          <th>Remote Button</th>
          <th>unsigned int data</th>
          <th>define</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>▲ (전진 / 속도 증가)</td>
          <td>0XFF18E7</td>
          <td>BTN_U</td>
      </tr>
      <tr>
          <td>▼ (후진 / 속도 감소)</td>
          <td>0XFFA4B5</td>
          <td>BTN_D</td>
      </tr>
      <tr>
          <td>◀ (좌회전 / 좌회전각 증가)</td>
          <td>0XFF10EF</td>
          <td>BTN_L</td>
      </tr>
      <tr>
          <td>▶ (우회전 / 우회전각 증가)</td>
          <td>0XFF5AA5</td>
          <td>BTN_R</td>
      </tr>
      <tr>
          <td>OK (정지)</td>
          <td>0XFF38C7</td>
          <td>BTN_O</td>
      </tr>
  </tbody>
</table>
<p>보유하고 있는 리모컨의 종류마다 HEX값이 다르므로, HEX값은 다를 수 있습니다. HEX값을 알아내는 방법은 IR Remote를 다루는 페이지를 참고하세요.</p>
<br>
<h4 id="sketch-2">sketch<a class="anchor" href="#sketch-2">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#75715e">//Initialize IR remote
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boarddefs.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;IRremote.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;IRremoteInt.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;ir_Lego_PF_BitStreamEncoder.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> RECV_PIN <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>;              <span style="color:#75715e">// IR Signal pin
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>IRrecv <span style="color:#a6e22e">irrecv</span>(RECV_PIN);
</span></span><span style="display:flex;"><span>decode_results results;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_F 0xFF18E7  </span><span style="color:#75715e">// Forward Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_B 0xFF4AB5  </span><span style="color:#75715e">// Backward Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_L 0xFF10EF  </span><span style="color:#75715e">// Left Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_R 0xFF5AA5  </span><span style="color:#75715e">// Right Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_O 0xFF38C7  </span><span style="color:#75715e">// OK Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Initialize TB6612FNG Motor drive
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> STBY <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;  <span style="color:#75715e">// STBY pin on TB6612FNG. Must be HIGH to enable motor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_PWM <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;  <span style="color:#75715e">// Right motor speed control using analogWrite() function. Value between 0 - 255
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;  <span style="color:#75715e">// Right motor - LOW should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;  <span style="color:#75715e">// Right motor - HIGH should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_PWM <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>;  <span style="color:#75715e">// Left motor speed control using analogWrite() function. Value between 0 - 255
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>; <span style="color:#75715e">// Left motor - LOW should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>; <span style="color:#75715e">// Left motor - HIGH should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> R_MaxSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">255</span>;   <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> L_MaxSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">255</span>;   <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> R_TurnSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">128</span>;  <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> L_TurnSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">128</span>;  <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> LR_Direct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;      <span style="color:#75715e">//for Direction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  pinMode(A_PWM, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(A_IN1, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(A_IN2, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_PWM, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_IN1, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_IN2, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(STBY, OUTPUT);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  Serial.begin(<span style="color:#ae81ff">9600</span>);
</span></span><span style="display:flex;"><span>  irrecv.enableIRIn();                           <span style="color:#75715e">// Start the receiver
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (irrecv.decode(<span style="color:#f92672">&amp;</span>results)) {                 <span style="color:#75715e">// Read IR remote control
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//Serial.println(results.value, HEX);        // for debug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    irrecv.resume();                             <span style="color:#75715e">// Receive the next value
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">switch</span>(results.value) {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_F:
</span></span><span style="display:flex;"><span>      go_forward();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_B:  
</span></span><span style="display:flex;"><span>      go_backward();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_L:  
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        go_f_left();
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        go_b_left();
</span></span><span style="display:flex;"><span>      }     
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_R:
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        go_f_right();
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        go_b_right();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_O:
</span></span><span style="display:flex;"><span>      stop();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>  }  
</span></span><span style="display:flex;"><span>  delay(<span style="color:#ae81ff">50</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Move specific motor at speed and direction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// motor: A(Right) -&gt; 0, B(Left) -&gt; 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// speed: 0 is off, and 255 is full speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// direction: 0 clockwise, 1 counter-clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">move</span>(<span style="color:#66d9ef">int</span> motorLR, <span style="color:#66d9ef">int</span> speed, boolean inPin1, boolean inPin2) {
</span></span><span style="display:flex;"><span>  digitalWrite(STBY, HIGH);        <span style="color:#75715e">// Disable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (motorLR <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    analogWrite(A_PWM, speed);
</span></span><span style="display:flex;"><span>    digitalWrite(A_IN1, inPin1);
</span></span><span style="display:flex;"><span>    digitalWrite(A_IN2, inPin2);   
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (motorLR <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    analogWrite(B_PWM, speed);
</span></span><span style="display:flex;"><span>    digitalWrite(B_IN1, inPin1);
</span></span><span style="display:flex;"><span>    digitalWrite(B_IN2, inPin2);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">go_forward</span>() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Right motor, Right Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Left motor, Left Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  LR_Direct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;              <span style="color:#75715e">// Forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">go_backward</span>() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;B&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Right motor, Right Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Left motor, Left Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  LR_Direct <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;              <span style="color:#75715e">// Backward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">go_f_left</span>() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F_L&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Right motor, Right Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_TurnSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>); <span style="color:#75715e">// Left motor, Left Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">go_b_left</span>() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F_R&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Right motor, Right Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_TurnSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>); <span style="color:#75715e">// Left motor, Left Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">go_f_right</span>() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F_R&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_TurnSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>); <span style="color:#75715e">// Right motor, Right Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Left motor, Left Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">go_b_right</span>() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;B_R&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_TurnSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>); <span style="color:#75715e">// Right motor, Right Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Left motor, Left Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">stop</span>() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;STOP&#34;</span>);
</span></span><span style="display:flex;"><span>  digitalWrite(STBY, LOW);    <span style="color:#75715e">// Enable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}</span></span></code></pre></div><br>
<br>
<h3 id="초음파-센서-장착">초음파 센서 장착<a class="anchor" href="#%ec%b4%88%ec%9d%8c%ed%8c%8c-%ec%84%bc%ec%84%9c-%ec%9e%a5%ec%b0%a9">#</a></h3>
<p>초음파 센서를 장착하여 전진시 일정한 거리 내에  장애물이 있으면 자동차를 멈춰보도록 하겠습니다. Trig는 아두이노 2번핀, Echo는 4번핀에 연결하였습니다.</p>
<br>
<h4 id="schematic-3">schematic<a class="anchor" href="#schematic-3">#</a></h4>
<h5 id="uno보드와-컴퓨터를-usb선으로-연결하여-사용할-경우-3">UNO보드와 컴퓨터를 USB선으로 연결하여 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%eb%a5%bc-usb%ec%84%a0%ec%9c%bc%eb%a1%9c-%ec%97%b0%ea%b2%b0%ed%95%98%ec%97%ac-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0-3">#</a></h5>
<p><img src="/image/4wd-08.png" alt="" /></p>
<br>
<h5 id="uno보드와-컴퓨터의-연결없이-vin핀을-사용하여-단독으로-사용할-경우-3">UNO보드와 컴퓨터의 연결없이 Vin핀을 사용하여 단독으로 사용할 경우<a class="anchor" href="#uno%eb%b3%b4%eb%93%9c%ec%99%80-%ec%bb%b4%ed%93%a8%ed%84%b0%ec%9d%98-%ec%97%b0%ea%b2%b0%ec%97%86%ec%9d%b4-vin%ed%95%80%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%ec%97%ac-%eb%8b%a8%eb%8f%85%ec%9c%bc%eb%a1%9c-%ec%82%ac%ec%9a%a9%ed%95%a0-%ea%b2%bd%ec%9a%b0-3">#</a></h5>
<p><img src="/image/4wd-09.png" alt="" /></p>
<br>
<h4 id="sketch-3">sketch<a class="anchor" href="#sketch-3">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#75715e">//Initialize IR remote
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boarddefs.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;IRremote.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;IRremoteInt.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;ir_Lego_PF_BitStreamEncoder.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> RECV_PIN <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>;       <span style="color:#75715e">// IR Signal pin
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>IRrecv <span style="color:#a6e22e">irrecv</span>(RECV_PIN);
</span></span><span style="display:flex;"><span>decode_results results;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_F 0xFF18E7  </span><span style="color:#75715e">// Forward Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_B 0xFF4AB5  </span><span style="color:#75715e">// Backward Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_L 0xFF10EF  </span><span style="color:#75715e">// Left Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_R 0xFF5AA5  </span><span style="color:#75715e">// Right Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define BTN_O 0xFF38C7  </span><span style="color:#75715e">// OK Button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Initialize TB6612FNG Motor drive
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> STBY <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;  <span style="color:#75715e">// STBY pin on TB6612FNG. Must be HIGH to enable motor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_PWM <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;  <span style="color:#75715e">// Right motor speed control using analogWrite() function. Value between 0 - 255
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;  <span style="color:#75715e">// Right motor - LOW should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> A_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;  <span style="color:#75715e">// Right motor - HIGH should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_PWM <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>;  <span style="color:#75715e">// Left motor speed control using analogWrite() function. Value between 0 - 255
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_IN1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>; <span style="color:#75715e">// Left motor - LOW should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> B_IN2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>; <span style="color:#75715e">// Left motor - HIGH should go forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> R_MaxSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">255</span>;   <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> L_MaxSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">255</span>;   <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> R_TurnSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">128</span>;  <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> L_TurnSpeed <span style="color:#f92672">=</span> <span style="color:#ae81ff">128</span>;  <span style="color:#75715e">//set motor speed to max speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> LR_Direct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;      <span style="color:#75715e">//for Direction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Initialize Ultrasonic Sensor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#define TRIG 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ECHO 4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
</span></span><span style="display:flex;"><span>  pinMode(A_PWM, OUTPUT);                        <span style="color:#75715e">// Motor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  pinMode(A_IN1, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(A_IN2, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_PWM, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_IN1, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(B_IN2, OUTPUT);
</span></span><span style="display:flex;"><span>  pinMode(STBY, OUTPUT);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  pinMode(TRIG, OUTPUT);                         <span style="color:#75715e">// Ultrasonic Sensor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  pinMode(ECHO, INPUT);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Serial.begin(<span style="color:#ae81ff">9600</span>);
</span></span><span style="display:flex;"><span>  irrecv.enableIRIn();                           <span style="color:#75715e">// Start the receiver
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
</span></span><span style="display:flex;"><span>  digitalWrite(TRIG, LOW);                       <span style="color:#75715e">// Start Ultrasonic sensor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delayMicroseconds(<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>  digitalWrite(TRIG, HIGH);
</span></span><span style="display:flex;"><span>  delayMicroseconds(<span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>  digitalWrite(TRIG, LOW);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> distance <span style="color:#f92672">=</span> pulseIn(ECHO, HIGH) <span style="color:#f92672">/</span> <span style="color:#ae81ff">58.2</span>;    <span style="color:#75715e">// 거리 측정
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (irrecv.decode(<span style="color:#f92672">&amp;</span>results)) {                 <span style="color:#75715e">// Read IR remote control
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//Serial.println(results.value, HEX);        // for debug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    irrecv.resume(); <span style="color:#75715e">// Receive the next value
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (distance <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span>) {                            <span style="color:#75715e">// 거리가 10cm 이내이면 정지
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    stop();
</span></span><span style="display:flex;"><span>    delay(<span style="color:#ae81ff">500</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> {                                          <span style="color:#75715e">// 거리가 10cm 이상이면,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	<span style="color:#66d9ef">switch</span>(results.value) {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_F:
</span></span><span style="display:flex;"><span>      go_forward();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_B:  
</span></span><span style="display:flex;"><span>      go_backward();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_L:  
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        go_f_left();
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        go_b_left();
</span></span><span style="display:flex;"><span>      }     
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_R:
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        go_f_right();
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(LR_Direct<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        go_b_right();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> BTN_O:
</span></span><span style="display:flex;"><span>      stop();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>  }  
</span></span><span style="display:flex;"><span>  delay(<span style="color:#ae81ff">50</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Move specific motor at speed and direction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// motor: A(Right) -&gt; 0, B(Left) -&gt; 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// speed: 0 is off, and 255 is full speed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// direction: 0 clockwise, 1 counter-clockwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> move(<span style="color:#66d9ef">int</span> motorLR, <span style="color:#66d9ef">int</span> speed, boolean inPin1, boolean inPin2) {
</span></span><span style="display:flex;"><span>  digitalWrite(STBY, HIGH);        <span style="color:#75715e">// Disable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (motorLR <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    analogWrite(A_PWM, speed);
</span></span><span style="display:flex;"><span>    digitalWrite(A_IN1, inPin1);
</span></span><span style="display:flex;"><span>    digitalWrite(A_IN2, inPin2);   
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (motorLR <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    analogWrite(B_PWM, speed);
</span></span><span style="display:flex;"><span>    digitalWrite(B_IN1, inPin1);
</span></span><span style="display:flex;"><span>    digitalWrite(B_IN2, inPin2);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> go_forward() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Right motor, Right Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Left motor, Left Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  LR_Direct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;              <span style="color:#75715e">// Forward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> go_backward() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;B&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Right motor, Right Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Left motor, Left Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  LR_Direct <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;              <span style="color:#75715e">// Backward
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> go_f_left() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F_L&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Right motor, Right Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_TurnSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>); <span style="color:#75715e">// Left motor, Left Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> go_b_left() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F_R&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Right motor, Right Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_TurnSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>); <span style="color:#75715e">// Left motor, Left Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> go_f_right() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;F_R&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_TurnSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>); <span style="color:#75715e">// Right motor, Right Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);  <span style="color:#75715e">// Left motor, Left Speed, forward(0,1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> go_b_right() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;B_R&#34;</span>);
</span></span><span style="display:flex;"><span>  move(<span style="color:#ae81ff">0</span>, R_TurnSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>); <span style="color:#75715e">// Right motor, Right Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  move(<span style="color:#ae81ff">1</span>, L_MaxSpeed, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Left motor, Left Speed, backward(1,0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  delay(<span style="color:#ae81ff">100</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> stop() {
</span></span><span style="display:flex;"><span>  Serial.println(<span style="color:#e6db74">&#34;STOP&#34;</span>);
</span></span><span style="display:flex;"><span>  digitalWrite(STBY, LOW);    <span style="color:#75715e">// Enable Standby
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}</span></span></code></pre></div></div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
    <a href="/posts/4wd-bluetooth/" class="flex align-center">
      <img src="/icons/backward.svg" class="book-icon" alt="Previous" title="4WD Bluetooth" />
      <span>4WD Bluetooth</span>
    </a>
  
  </div>
  <div>
  
    <a href="/posts/arduino-%EB%9D%BC%EC%9D%B8%ED%8A%B8%EB%A0%88%EC%9D%B4%EC%84%9C-l298n/" class="flex align-center">
      <span>Arduino, 라인트레이서, L298N</span>
      <img src="/icons/forward.svg" class="book-icon" alt="Next" title="Arduino, 라인트레이서, L298N" />
    </a>
  
  </div>
</div>
 
        
  
  <div class="book-comments">

</div>
  
 
        
        

 
      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    

<aside class="book-toc">
  <div class="book-toc-content">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#dc모터-사용하기">DC모터 사용하기</a></li>
        <li><a href="#모터-1개-컨트롤하기">모터 1개 컨트롤하기</a></li>
        <li><a href="#4wd-자동차-만들기">4WD 자동차 만들기</a></li>
        <li><a href="#ir-리모컨으로-4wd-컨트롤하기">IR 리모컨으로 4WD 컨트롤하기</a></li>
        <li><a href="#초음파-센서-장착">초음파 센서 장착</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </div>
</aside>

 
  </main>

  
</body>
</html>


















