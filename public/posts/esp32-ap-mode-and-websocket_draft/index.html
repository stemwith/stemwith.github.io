<!DOCTYPE html>
<html lang="ko-kr" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="AP mode#
ESP32ë¥¼ AP modeë¡œ ì„¤ì •í•˜ì—¬ ë¼ìš°í„°(ê³µìœ ê¸°) ì¥ì¹˜ ì—†ì´ Clientê°€ ESP32ì— ì§ì ‘ ì ‘ì†í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í†µì‹ ì„ êµ¬í˜„í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ESP32ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¸”ë£¨íˆ¬ìŠ¤ì™€ wifië¥¼ ë°©ì‹ì˜ ë¬´ì„  í†µì‹ ì„ ì§€ì›í•©ë‹ˆë‹¤. ê°ê°ì˜ ë°©ì‹ì´ ê°–ëŠ” ì¥ë‹¨ì ì´ ìˆìœ¼ë¯€ë¡œ ìƒí™©ì— ë§ì¶”ì–´ ì ì ˆí•œ í†µì‹  ë°©ì‹ì„ ì„ íƒí•˜ë©´ ë©ë‹ˆë‹¤.

  
      
          ESP32 í†µì‹ ëª¨ë“œ
          ë¸”ë£¨íˆ¬ìŠ¤
          wifi Station Mode
          wifi AP Mode
      
  
  
      
          ë¼ìš°í„°
          ë¶ˆí•„ìš”
          í•„ìš”
          ë¶ˆí•„ìš”
      
      
          í†µì‹ ê±°ë¦¬
          10m ì´ë‚´ (ì¥ì• ë¬¼ì— ì•½í•¨)
          ì¼ë°˜ì ì¸ wifi ë„ë‹¬ ê±°ë¦¬ì™€ ë™ì¼
          ì¢Œë™
      
      
          ì „ë ¥
          ì €ì „ë ¥
          ë¸”ë£¨íˆ¬ìŠ¤ í†µì‹ ì— ë¹„í•´ ì‚¬ìš©ëŸ‰ í¼
          ì¢Œë™
      
  


í•™êµì—ì„œ ESP32ë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°,">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/posts/esp32-ap-mode-and-websocket_draft/">
  <meta property="og:site_name" content="stemwith">
  <meta property="og:title" content="esp32 AP mode & Websocket">
  <meta property="og:description" content="AP mode#ESP32ë¥¼ AP modeë¡œ ì„¤ì •í•˜ì—¬ ë¼ìš°í„°(ê³µìœ ê¸°) ì¥ì¹˜ ì—†ì´ Clientê°€ ESP32ì— ì§ì ‘ ì ‘ì†í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í†µì‹ ì„ êµ¬í˜„í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
ESP32ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¸”ë£¨íˆ¬ìŠ¤ì™€ wifië¥¼ ë°©ì‹ì˜ ë¬´ì„  í†µì‹ ì„ ì§€ì›í•©ë‹ˆë‹¤. ê°ê°ì˜ ë°©ì‹ì´ ê°–ëŠ” ì¥ë‹¨ì ì´ ìˆìœ¼ë¯€ë¡œ ìƒí™©ì— ë§ì¶”ì–´ ì ì ˆí•œ í†µì‹  ë°©ì‹ì„ ì„ íƒí•˜ë©´ ë©ë‹ˆë‹¤.
ESP32 í†µì‹ ëª¨ë“œ ë¸”ë£¨íˆ¬ìŠ¤ wifi Station Mode wifi AP Mode ë¼ìš°í„° ë¶ˆí•„ìš” í•„ìš” ë¶ˆí•„ìš” í†µì‹ ê±°ë¦¬ 10m ì´ë‚´ (ì¥ì• ë¬¼ì— ì•½í•¨) ì¼ë°˜ì ì¸ wifi ë„ë‹¬ ê±°ë¦¬ì™€ ë™ì¼ ì¢Œë™ ì „ë ¥ ì €ì „ë ¥ ë¸”ë£¨íˆ¬ìŠ¤ í†µì‹ ì— ë¹„í•´ ì‚¬ìš©ëŸ‰ í¼ ì¢Œë™ í•™êµì—ì„œ ESP32ë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°,">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-11-15T18:27:53+09:00">
    <meta property="article:modified_time" content="2019-11-15T18:27:53+09:00">


<title>esp32 AP mode &amp; Websocket | stemwith</title>
<link rel="icon" href="/favicon.ico" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/posts/esp32-ap-mode-and-websocket_draft/">
<link rel="stylesheet" href="/book.min.edacc84919565354dfc39b7e3684e11739048c7cd9356a3036fc1c663b63611d.css" integrity="sha256-7azISRlWU1Tfw5t&#43;NoThFzkEjHzZNWowNvwcZjtjYR0=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.13f8d617d1f4332e03fb0c5acd958971192578f8def3bc8a7898cea329430c3b.js" integrity="sha256-E/jWF9H0My4D&#43;wxazZWJcRklePje87yKeJjOoylDDDs=" crossorigin="anonymous"></script>

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-128DRYVCRT"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-128DRYVCRT');
        }
      </script>


  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav class="book-menu">
  
  <h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/og_image.png" alt="Logo" /></a>
</h2>


  
  
<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>




  
  

  
  

  
  



  
  










  
  



  
  

  
  <div class="analytics-container">
  <h4>ì ‘ì† í†µê³„</h4>
  <div class="stat-group">
    <span class="stat-label">ì˜¤ëŠ˜</span>
    <p class="stat-value" id="ga-today-visitors">ğŸ‘¤ ...</p>
  </div>
  <div class="stat-group">
    <span class="stat-label">ì¼ì¼ ë°©ë¬¸ì (2ì£¼)</span>
    <div id="ga-daily-chart"></div>
  </div>
  <div class="stat-group">
    <span class="stat-label">ê³„</span>
    <ul class="stat-list">
      <li id="ga-total-visitors">- ë°©ë¬¸ì: ...</li>
      <li id="ga-total-pageviews">- í˜ì´ì§€ë·°: ...</li>
    </ul>
  </div>
</div>
</nav>




  <script type="text/javascript">
    (function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()
  </script>


  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>esp32 AP mode &amp; Websocket</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#ap-mode">AP mode</a></li>
        <li><a href="#ap-mode-ì„¤ì •">AP mode ì„¤ì •</a></li>
        <li><a href="#websocket">Websocket</a></li>
        <li><a href="#ê²°ê³¼">ê²°ê³¼</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    esp32 AP mode &amp; Websocket
  </h1>
  
  <div class="flex align-center text-small book-post-date">
    <img src="/icons/calendar.svg" class="book-icon" alt="" />
    <span>November 15, 2019</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/esp32/">Esp32</a>
  </div>
  

  


  <div class="book-post-content markdown-inner"><h3 id="ap-mode">AP mode<a class="anchor" href="#ap-mode">#</a></h3>
<p>ESP32ë¥¼ AP modeë¡œ ì„¤ì •í•˜ì—¬ ë¼ìš°í„°(ê³µìœ ê¸°) ì¥ì¹˜ ì—†ì´ Clientê°€ ESP32ì— ì§ì ‘ ì ‘ì†í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í†µì‹ ì„ êµ¬í˜„í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<br>
<p>ESP32ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¸”ë£¨íˆ¬ìŠ¤ì™€ wifië¥¼ ë°©ì‹ì˜ ë¬´ì„  í†µì‹ ì„ ì§€ì›í•©ë‹ˆë‹¤. ê°ê°ì˜ ë°©ì‹ì´ ê°–ëŠ” ì¥ë‹¨ì ì´ ìˆìœ¼ë¯€ë¡œ ìƒí™©ì— ë§ì¶”ì–´ ì ì ˆí•œ í†µì‹  ë°©ì‹ì„ ì„ íƒí•˜ë©´ ë©ë‹ˆë‹¤.</p>
<table>
  <thead>
      <tr>
          <th>ESP32 í†µì‹ ëª¨ë“œ</th>
          <th>ë¸”ë£¨íˆ¬ìŠ¤</th>
          <th>wifi Station Mode</th>
          <th>wifi AP Mode</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ë¼ìš°í„°</td>
          <td>ë¶ˆí•„ìš”</td>
          <td>í•„ìš”</td>
          <td>ë¶ˆí•„ìš”</td>
      </tr>
      <tr>
          <td>í†µì‹ ê±°ë¦¬</td>
          <td>10m ì´ë‚´ (ì¥ì• ë¬¼ì— ì•½í•¨)</td>
          <td>ì¼ë°˜ì ì¸ wifi ë„ë‹¬ ê±°ë¦¬ì™€ ë™ì¼</td>
          <td>ì¢Œë™</td>
      </tr>
      <tr>
          <td>ì „ë ¥</td>
          <td>ì €ì „ë ¥</td>
          <td>ë¸”ë£¨íˆ¬ìŠ¤ í†µì‹ ì— ë¹„í•´ ì‚¬ìš©ëŸ‰ í¼</td>
          <td>ì¢Œë™</td>
      </tr>
  </tbody>
</table>
<br>
<p>í•™êµì—ì„œ ESP32ë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°,</p>
<ul>
<li>ë‹¤ì–‘í•œ í˜•íƒœì˜ ê³¼í•™ ì‹¤í—˜ì— ëŒ€ì‘í•  ìˆ˜ ìˆì–´ì•¼ í•¨</li>
<li>ê³¼í•™ì‹¤ ë‚´ë¶€ í˜¹ì€ ì•¼ì™¸ì—ì„œë„ ì´ìš©í•  ìˆ˜ ìˆë„ë¡ ì´ë™ì´ í¸ë¦¬í•´ì•¼ í•¨
<ul>
<li>ê¸°ë³¸ì ìœ¼ë¡œ ë¼ìš°í„°ì— ì¢…ì†ë˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ìŒ</li>
</ul>
</li>
<li>ë””ìŠ¤í”Œë ˆì´ ì¥ì¹˜ëŠ” í•™ìƒì´ ë³¸ì¸ì˜ ìŠ¤ë§ˆíŠ¸í°ì„ ì´ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•¨
<ul>
<li>ë³„ë„ì˜ OLED, LCDì™€ ê°™ì€ ë””ìŠ¤í”Œë ˆì´ë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°, ì‹¤í—˜ì¥ì¹˜ì˜ ë°°ì„ ì´ ë³µì¡í•´ì§</li>
<li>ë‹¨, OLEDë‚˜ LCDë¥¼ í™œìš©í•˜ëŠ” ê²½ìš° í¥ë¯¸ ìœ ë°œì— ë„ì›€ì„ ì¤Œ</li>
</ul>
</li>
</ul>
<br>
<p>ìœ„ ì‚¬í•­ì„ ê³ ë ¤í•  ë•Œ ESP32ë¥¼ í†µí•´ ì—¬ëŸ¬ ê°€ì§€ ì‹¤í—˜ì„ í•˜ê³  ê²°ê³¼ë¥¼ ë„ì¶œí•˜ëŠ” í™˜ê²½ì˜ ë‹¤ì–‘ì„±ì„ ìˆ˜ìš©í•˜ê¸° ìœ„í•˜ì—¬, AP modeê°€ ê°€ì¥ ì í•©í•˜ë‹¤ê³  íŒë‹¨í•˜ì—¬ ì´ë¥¼ ì‚¬ìš©í•´ë³´ê³ ì í•©ë‹ˆë‹¤.</p>
<br>
<br>
<h3 id="ap-mode-ì„¤ì •">AP mode ì„¤ì •<a class="anchor" href="#ap-mode-%ec%84%a4%ec%a0%95">#</a></h3>
<p>ì°¸ê³ : <a href="https://randomnerdtutorials.com/esp32-access-point-ap-web-server/">https://randomnerdtutorials.com/esp32-access-point-ap-web-server/</a></p>
<ul>
<li>
<p>ssid, password ì„¤ì •</p>
<ul>
<li>ê³¼í•™ì‹¤ì—ì„œ ëª¨ë‘ ë³„ë¡œ ë³„ë„ì˜ ESP32ë¥¼ ì´ìš©í•œë‹¤ë©´, ê° ëª¨ë‘ ì—ì„œ ì‚¬ìš©í•˜ëŠ” ESP32ë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆë„ë¡ ssidì— ê° ëª¨ë‘ ì˜ ë²ˆí˜¸ë¥¼ ì ì–´ë‘ëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒì…ë‹ˆë‹¤. ë™ì¼í•œ ssidê°€ ì„¤ì •ë˜ë©´ ë‹¤ë¥¸ ëª¨ë‘ ì˜ ë°ì´í„° ê°’ì„ ë°›ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ë°˜ë“œì‹œ êµ¬ë¶„ì§“ë„ë¡ ì•ˆë‚´í•´ì•¼ í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ssid</span> <span class="o">=</span> <span class="s">&#34;ESP32-AP-x&#34;</span><span class="p">;</span>      <span class="c1">// max 63 characters, x is team number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&#34;123456789&#34;</span><span class="p">;</span>   <span class="c1">// min 8 characters 
</span></span></span></code></pre></div></li>
<li>
<p>AP mode ì‹¤í–‰: ìœ„ì˜ ì„¤ì •ì— ì˜í•´ ë‹¤ìŒì˜ ë¼ì¸ì„ í†µí•´ AP modeë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="n">WiFi</span><span class="p">.</span><span class="nf">softAP</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span></span></span></code></pre></div></li>
<li>
<p>AP mode ì‹¤í–‰ ì˜µì…˜: ssid, password ì´ì™¸ì˜ ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì¶”ê°€í•  ê²½ìš°ì—ëŠ” ì•„ë˜ì˜ ë°©ë²•ìœ¼ë¡œ ì„¤ì •í•˜ê³  AP modeë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="n">WiFi</span><span class="p">.</span><span class="nf">softAP</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ssid</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">,</span> <span class="kt">int</span> <span class="n">channel</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ssid_hidden</span><span class="p">,</span> <span class="kt">int</span> <span class="n">max_connection</span><span class="p">)</span></span></span></code></pre></div><ul>
<li>channel: Wi-Fi channel number (1-13)</li>
<li>ssid_hidden: (0 = broadcast SSID, 1 = hide SSID)</li>
<li>max_connection: maximum simultaneous connected clients (1-4)</li>
</ul>
</li>
<li>
<p>AP mode ì‹¤í–‰ì‹œ ESP32ì— ë¶€ì—¬ëœ IPëŠ” ë‹¤ìŒì˜ ë°©ë²•ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="n">IPAddress</span> <span class="n">IP</span> <span class="o">=</span> <span class="n">WiFi</span><span class="p">.</span><span class="nf">softAPIP</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&#34;AP IP address: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">IP</span><span class="p">);</span></span></span></code></pre></div><ul>
<li>AP modeë¥¼ ì‚¬ìš©í•  ê²½ìš°, ESP32ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ <strong>192.168.4.1</strong>ì˜ ì£¼ì†Œë¥¼ ë¶€ì—¬ ë°›ìŠµë‹ˆë‹¤.</li>
</ul>
</li>
</ul>
<br>
<br>
<h3 id="websocket">Websocket<a class="anchor" href="#websocket">#</a></h3>
<p>ì°¸ê³ : <a href="http://www.martyncurrey.com/esp8266-and-the-arduino-ide-part-10a-iot-website-temperature-and-humidity-monitor/">Martyn Currey Blog</a></p>
<br>
<h4 id="ì™œ-ì›¹ì†Œì¼“ì„-ì‚¬ìš©í•˜ëŠ”ê°€">ì™œ ì›¹ì†Œì¼“ì„ ì‚¬ìš©í•˜ëŠ”ê°€?<a class="anchor" href="#%ec%99%9c-%ec%9b%b9%ec%86%8c%ec%bc%93%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94%ea%b0%80">#</a></h4>
<p>ì´ ë¬¸ì„œëŠ” í•™ìƒë“¤ì˜ ìŠ¤ë§ˆíŠ¸í°ì„ í´ë¼ì´ì–¸íŠ¸ë¡œ í™œìš©í•˜ì—¬ ê³¼í•™ì‹¤í—˜ì„ í•˜ëŠ” ìƒí™©ì„ ì „ì œë¡œ,  ESP32ì— ì›¹ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ ì ‘ì†í•˜ì—¬ ì‹¤í—˜ê²°ê³¼ ê°’ì„ ëª¨ë‹ˆí„°ë§í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ì‹¤í—˜ì˜ ì„±ê²©ì— ë”°ë¼ ì›¹í˜ì´ì§€ë¥¼ refreshí•˜ë©´ì„œ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê²ƒì´ ì¢‹ì„ ìˆ˜ë„ ìˆê³ , refreshí•˜ì§€ ì•Šì•„ë„ ê²°ê³¼ê°’ì´ updateë˜ëŠ” ê²ƒì´ ë” ì¢‹ì„ ìˆ˜ë„ ìˆê² ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” í›„ìì˜ ë°©ë²•ì„ íƒí•˜ì—¬ ê²°ê³¼ê°’ì„ ë‚˜íƒ€ë‚´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì´ë•Œ í•„ìš”í•œ ê¸°ìˆ ì´ ì›¹ì†Œì¼“ì…ë‹ˆë‹¤.</p>
<br>
<h4 id="ì›¹ì†Œì¼“">ì›¹ì†Œì¼“<a class="anchor" href="#%ec%9b%b9%ec%86%8c%ec%bc%93">#</a></h4>
<p>WebSocketì€ TCP ì—°ê²°ì„ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ì˜ ì§€ì†ì ì¸ ì–‘ë°©í–¥ í†µì‹ ì„ í—ˆìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ, ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ë°ì´í„°ë¥¼ ì–¸ì œë“ ì§€ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>WebSocketì„ í™œìš©í•˜ê¸° ì´ì „ì—ëŠ”, ì¼ë°˜ì ì¸ HTML ë°©ì‹ì´ë‚˜ AJAX(Asynchronous Javascript And XML)ì™€ ê°™ì€ ë¹„ë™ê¸°ì‹ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ ì„¼ì„œê°’ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ë‹¨, ì´ ë°©ë²•ì€ ìƒˆë¡œìš´ ì„¼ì„œê°’ì´ ë°œìƒí•˜ë”ë¼ë„ ë™ì‹œì— ì—¬ëŸ¬ ê°œì˜ íƒ­ (ë™ì¼í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì¥ì¹˜ì— ìˆìŒ)ì´ ì—´ë ¤ìˆë‹¤ë©´ ìƒíƒœê°€ ëª¨ë‘ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ” ë‹¤ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì›¹í˜ì´ì§€ ì „ì²´ë¥¼ refreshí•˜ê±°ë‚˜ ì›¹í˜ì´ì§€ì˜ ì¼ë¶€ë¶„ë§Œì´ë¼ë„ ìƒˆë¡­ê²Œ ë¡œë“œí•´ì•¼ë§Œ ë³€ê²½ì‚¬í•­ì´ ë°˜ì˜ì‹œì¼œì•¼ë§Œ í–ˆìŠµë‹ˆë‹¤.</p>
<p>ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ WebSocket í”„ë¡œí† ì½œì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. WebSocketì€ ë³€ê²½ ì‚¬í•­ì´ ë°œìƒí•˜ë©´ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì— ì•Œë¦¼ì„ ë³´ë‚´ê³  ê·¸ì— ë”°ë¼ ì›¹ í˜ì´ì§€ë¥¼ ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.</p>
<p>í´ë¼ì´ì–¸íŠ¸ëŠ” WebSocket í•¸ë“œ ì…°ì´í¬ë¼ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ ì„œë²„ì™€ WebSocket ì—°ê²°ì„ ì„¤ì •í•©ë‹ˆë‹¤. í•¸ë“œ ì…°ì´í¬ëŠ” HTTP requestì™€ responseë¡œ ì‹œì‘í•˜ì—¬ ì„œë²„ê°€ ë™ì¼í•œ í¬íŠ¸ì—ì„œ WebSocket ì—°ê²°ë¿ë§Œ ì•„ë‹ˆë¼ HTTP ì—°ê²°ì„ ì²˜ë¦¬ í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ì—°ê²°ì´ ì„¤ì •ë˜ë©´ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” WebSocket ë°ì´í„°ë¥¼ full duplex ëª¨ë“œë¡œ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, WebSockets í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ì„œë²„ (ESP32 ë³´ë“œ)ëŠ” ìš”ì²­ì—†ì´ í´ë¼ì´ì–¸íŠ¸ ë˜ëŠ” ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì— ì •ë³´ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë³€ê²½ ì‚¬í•­ì´ ë°œìƒí•  ë•Œ ì›¹ ë¸Œë¼ìš°ì €ì— ì •ë³´ë¥¼ ë³´ë‚¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>
<br>
<h4 id="ë¼ì´ë¸ŒëŸ¬ë¦¬">ë¼ì´ë¸ŒëŸ¬ë¦¬<a class="anchor" href="#%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac">#</a></h4>
<p>ESP32ì—ì„œëŠ” Markus Sattlerê°€ ë§Œë“  <a href="https://github.com/Links2004/arduinoWebSockets">Websockets</a>ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ êµ¬í˜„í•©ë‹ˆë‹¤.</p>







<figure
  
  class="center"

  
  style="width: 75%;">

  <img src="/image/websocket01.png" alt="/image/websocket01.png">

  
  
</figure>
<br>
<br>
<h4 id="sketch-ì „ì²´">sketch: ì „ì²´<a class="anchor" href="#sketch-%ec%a0%84%ec%b2%b4">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="c1">// HTTP headers always start with a response code (e.g. HTTP/1.1 200 OK)
</span></span></span><span class="line"><span class="cl"><span class="c1">// and a content-type so the client knows what&#39;s coming, then a blank line:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">String</span> <span class="n">html_header</span> <span class="o">=</span> <span class="s">&#34;HTTP/1.1 200 OK</span><span class="se">\r\n</span><span class="s">Content-Type: text/html</span><span class="se">\r\n\r\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// HTTP main page
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">String</span> <span class="n">html_main</span> <span class="o">=</span> <span class="n">R</span><span class="s">&#34;=====(</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">meta</span> <span class="n">name</span><span class="o">=</span><span class="err">&#39;</span><span class="n">viewport</span><span class="err">&#39;</span> <span class="n">content</span><span class="o">=</span><span class="err">&#39;</span><span class="n">width</span><span class="o">=</span><span class="n">device</span><span class="o">-</span><span class="n">width</span><span class="p">,</span> <span class="n">initial</span><span class="o">-</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="err">&#39;</span><span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span><span class="err">&#39;</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">body</span>     <span class="p">{</span> <span class="n">font</span><span class="o">-</span><span class="nl">size</span><span class="p">:</span><span class="mi">100</span><span class="o">%</span><span class="p">;}</span> 
</span></span><span class="line"><span class="cl">    <span class="err">#</span><span class="n">main</span>    <span class="p">{</span> <span class="nl">display</span><span class="p">:</span> <span class="n">table</span><span class="p">;</span> <span class="nl">width</span><span class="p">:</span> <span class="mi">300</span><span class="n">px</span><span class="p">;</span> <span class="nl">margin</span><span class="p">:</span> <span class="k">auto</span><span class="p">;</span>  <span class="nl">padding</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span> <span class="nl">border</span><span class="p">:</span> <span class="mi">3</span><span class="n">px</span> <span class="n">solid</span> <span class="n">blue</span><span class="p">;</span> <span class="n">border</span><span class="o">-</span><span class="nl">radius</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span> <span class="n">text</span><span class="o">-</span><span class="nl">align</span><span class="p">:</span><span class="n">center</span><span class="p">;}</span> 
</span></span><span class="line"><span class="cl">    <span class="n">p</span>        <span class="p">{</span> <span class="n">font</span><span class="o">-</span><span class="nl">size</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">ESP32</span> <span class="n">Websockets</span> <span class="n">Sensor</span> <span class="n">Monitor</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">main</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="n">ESP32</span> <span class="n">Websockets</span> <span class="n">Monitor</span><span class="o">&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">content</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Potentiometer1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">potentiometer1</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Ohm</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Potentiometer2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">potentiometer2</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Ohm</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Touch</span> <span class="n">Sensor</span>   <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">touch</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Value</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Brightness</span>     <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">brightness</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Value</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Data</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">recData</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">var</span> <span class="n">Socket</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">function</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">Socket</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">WebSocket</span><span class="p">(</span><span class="err">&#39;</span><span class="nl">ws</span><span class="p">:</span><span class="c1">//&#39; + window.location.hostname + &#39;:81/&#39;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">Socket</span><span class="p">.</span><span class="n">onmessage</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span> <span class="nf">processReceivedCommand</span><span class="p">(</span><span class="n">event</span><span class="p">);</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="nf">processReceivedCommand</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">var</span> <span class="n">data</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">recData</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sc">&#39;|&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">potentiometer1</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>  
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">potentiometer2</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">touch</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">brightness</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//consol.log(evt.data);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="nf">sendText</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">Socket</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">window</span><span class="p">.</span><span class="n">onload</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span> <span class="nf">init</span><span class="p">();</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">=====</span><span class="s">&#34;;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;WiFi.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;WiFiClient.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;WiFiAP.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;WebSocketsServer.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Sensors are connected to GPIO 32~35
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">int</span> <span class="n">potPin1</span> <span class="o">=</span> <span class="mi">34</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">potPin2</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">touPin</span> <span class="o">=</span> <span class="mi">35</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">briPin</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// variable for storing the potentiometer value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">potentiometer1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">potentiometer2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">touch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">brightness</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Set these to your desired credentials.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ssid</span> <span class="o">=</span> <span class="s">&#34;ESP32-AP&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">password</span> <span class="o">=</span> <span class="s">&#34;123456789&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">WiFiServer</span> <span class="nf">server</span><span class="p">(</span><span class="mi">80</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">WebSocketsServer</span> <span class="n">webSocket</span> <span class="o">=</span> <span class="nf">WebSocketsServer</span><span class="p">(</span><span class="mi">81</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;Configuring access point...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// You can remove the password parameter if you want the AP to be open.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">WiFi</span><span class="p">.</span><span class="nf">softAP</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">IPAddress</span> <span class="n">myIP</span> <span class="o">=</span> <span class="n">WiFi</span><span class="p">.</span><span class="nf">softAPIP</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&#34;AP IP address: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">myIP</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// start a server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">server</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;Server started&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// start the websocket
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">webSocket</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;websocket started&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// webSocketEvent is the function to call when there is a websocket event
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">webSocket</span><span class="p">.</span><span class="nf">onEvent</span><span class="p">(</span><span class="n">webSocketEvent</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// check the websocket status.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">webSocket</span><span class="p">.</span><span class="nf">loop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// listen for incoming clients
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">WiFiClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">server</span><span class="p">.</span><span class="nf">available</span><span class="p">();</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// if you get a client,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="nf">flush</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span> <span class="n">html_header</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">client</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span> <span class="n">html_main</span> <span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;New page served&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">updateSensors</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">updateSensors</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">potentiometer1</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">potPin1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">potentiometer2</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">potPin2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">touch</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">touPin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">brightness</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">briPin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">potentiometer1</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">&#34;|&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">potentiometer2</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">&#34;|&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">touch</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">&#34;|&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">brightness</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="n">webSocket</span><span class="p">.</span><span class="nf">broadcastTXT</span><span class="p">(</span><span class="n">data</span><span class="p">);</span> <span class="c1">// send the data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>         <span class="c1">// display the data in the serial monitor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">webSocketEvent</span><span class="p">(</span><span class="n">byte</span> <span class="n">num</span><span class="p">,</span> <span class="n">WStype_t</span> <span class="n">type</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">payload</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">length</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&#34;WStype = &#34;</span><span class="p">);</span>   <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="n">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&#34;WS payload = &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="n">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">((</span><span class="kt">char</span><span class="p">)</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><br>
<br>
<h4 id="part1-ì›¹í˜ì´ì§€">Part1: ì›¹í˜ì´ì§€<a class="anchor" href="#part1-%ec%9b%b9%ed%8e%98%ec%9d%b4%ec%a7%80">#</a></h4>
<h5 id="header">header<a class="anchor" href="#header">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="c1">// HTTP headers always start with a response code (e.g. HTTP/1.1 200 OK)
</span></span></span><span class="line"><span class="cl"><span class="c1">// and a content-type so the client knows what&#39;s coming, then a blank line:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">String</span> <span class="n">html_header</span> <span class="o">=</span> <span class="s">&#34;HTTP/1.1 200 OK</span><span class="se">\r\n</span><span class="s">Content-Type: text/html</span><span class="se">\r\n\r\n</span><span class="s">&#34;</span><span class="p">;</span></span></span></code></pre></div><br>
<h5 id="main_head">main_head<a class="anchor" href="#main_head">#</a></h5>
<ul>
<li>styleì„ ì§€ì •í•©ë‹ˆë‹¤.</li>
<li>ì›¹ë¸Œë¼ìš°ì €ì˜ íƒ­ì— í‘œê¸°ë  titleì„ ì§€ì •í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="c1">// HTTP main page
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">String</span> <span class="n">html_main</span> <span class="o">=</span> <span class="n">R</span><span class="s">&#34;=====(</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">meta</span> <span class="n">name</span><span class="o">=</span><span class="err">&#39;</span><span class="n">viewport</span><span class="err">&#39;</span> <span class="n">content</span><span class="o">=</span><span class="err">&#39;</span><span class="n">width</span><span class="o">=</span><span class="n">device</span><span class="o">-</span><span class="n">width</span><span class="p">,</span> <span class="n">initial</span><span class="o">-</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="err">&#39;</span><span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span><span class="err">&#39;</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">body</span>     <span class="p">{</span> <span class="n">font</span><span class="o">-</span><span class="nl">size</span><span class="p">:</span><span class="mi">100</span><span class="o">%</span><span class="p">;}</span> 
</span></span><span class="line"><span class="cl">    <span class="err">#</span><span class="n">main</span>    <span class="p">{</span> <span class="nl">display</span><span class="p">:</span> <span class="n">table</span><span class="p">;</span> <span class="nl">width</span><span class="p">:</span> <span class="mi">300</span><span class="n">px</span><span class="p">;</span> <span class="nl">margin</span><span class="p">:</span> <span class="k">auto</span><span class="p">;</span>  <span class="nl">padding</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span> <span class="nl">border</span><span class="p">:</span> <span class="mi">3</span><span class="n">px</span> <span class="n">solid</span> <span class="n">blue</span><span class="p">;</span> <span class="n">border</span><span class="o">-</span><span class="nl">radius</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span> <span class="n">text</span><span class="o">-</span><span class="nl">align</span><span class="p">:</span><span class="n">center</span><span class="p">;}</span> 
</span></span><span class="line"><span class="cl">    <span class="n">p</span>        <span class="p">{</span> <span class="n">font</span><span class="o">-</span><span class="nl">size</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">ESP32</span> <span class="n">Websockets</span> <span class="n">Sensor</span> <span class="n">Monitor</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span></span></span></code></pre></div><ul>
<li>Rì€ <strong>ì´ëŸ¬í•œ êµ¬ë¶„ ê¸°í˜¸ ì‚¬ì´ì˜ ëª¨ë“  ê²ƒì„ ì›ì‹œ ë¬¸ìì—´ë¡œ ì²˜ë¦¬</strong>í•˜ë¼ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì¦‰, &ldquo;===== (     ) =====&ldquo;ì‚¬ì´ì˜ ëª¨ë“  ê²ƒì„ ë¬¸ìì—´ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
<ul>
<li>ì—¬ê¸°ì„œ ì‚¬ìš©í•œ &lsquo;&rsquo;=====&lsquo;&lsquo;ëŠ” íŠ¹ì • ë²”ìœ„ ë‚´ì—ì„œ ë‹¤ë¥¸ í˜•íƒœë¡œ ë°”ê¿”ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
<ul>
<li>ì˜ˆë¥¼ë“¤ì–´, This is &ldquo;text&quot;ë¥¼ ë¬¸ìì—´ë¡œ í• ë‹¹í•˜ê¸° ìœ„í•´ R &ldquo;-= (This is&quot;text &ldquo;) =-&ldquo;ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
</li>
<li>ë¬¸ìì—´ ê¸¸ê³  ë‹¤ì–‘í•œ í˜•íƒœì˜ ê¸°í˜¸ë‚˜ íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•˜ëŠ” ê²½ìš°,  ì´ëŸ¬í•œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
<ul>
<li>This is &ldquo;text&quot;ë¥¼ ë¬¸ìì—´ë¡œ ì²˜ë¦¬í•˜ë ¤ë©´, &quot; ì•ì— ê°ê° \ë¥¼ ë§ë¶™ì—¬ì•¼ í•©ë‹ˆë‹¤. ì¦‰ This is \&ldquo;ë¡œ ì‘ì„±ë˜ì–´ì•¼í•©ë‹ˆë‹¤.</li>
</ul>
</li>
<li>ì£¼ì˜í•  ì ì€ ===== ê°€ í…ìŠ¤íŠ¸ ì–´ë””ì—ë„ í‘œì‹œë˜ì§€ ì•Šì•„ì•¼í•©ë‹ˆë‹¤.</li>
</ul>
</li>
</ul>
<br>
<h5 id="main_body">main_body<a class="anchor" href="#main_body">#</a></h5>
<ul>
<li>ì›¹ë¸Œë¼ìš°ì €ì— í‘œê¸°ë  ë‚´ìš©ì„ ë§Œë“­ë‹ˆë‹¤.</li>
<li>span idëŠ” ì•„ë‘ì´ë…¸ì½”ë“œì—ì„œ ì‚¬ìš©í•˜ëŠ” ì„¼ì„œê°’ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">main</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="n">ESP32</span> <span class="n">Websockets</span> <span class="n">Monitor</span><span class="o">&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">content</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Potentiometer1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">potentiometer1</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Ohm</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Potentiometer2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">potentiometer2</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Ohm</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Touch</span> <span class="n">Sensor</span>   <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">touch</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Value</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Brightness</span>     <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">brightness</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="n">Value</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Data</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="n">recData</span><span class="err">&#39;</span><span class="o">&gt;</span><span class="mo">00</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span></span></span></code></pre></div><br>
<h5 id="javascript">JavaScript<a class="anchor" href="#javascript">#</a></h5>
<ul>
<li>ë°ì´í„°ê°€ ìˆ˜ì‹ ë˜ì–´ Websocket ì´ë²¤íŠ¸ê°€ ìƒê¸°ë©´ ì›¹ì‚¬ì´íŠ¸ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ <strong>processReceivedCommand()</strong> í•¨ìˆ˜ê°€ í˜¸ì¶œ ë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ìˆ˜ì‹ ëœ ë°ì´í„°ë¥¼ <strong>ë°°ì—´</strong> <strong>tmp</strong>ë¡œ ë¶„í•´í•œ ë‹¤ìŒ ê°œë³„ ë°°ì—´ ìš”ì†Œë¥¼ ì›¹ì‚¬ì´íŠ¸ì˜ ê° ë¶€ë¶„ì— ë³µì‚¬í•©ë‹ˆë‹¤.</li>
<li>ë°ì´í„°ê°€ <strong>potentiometer1|potentiometer2|touch|brightness</strong> í˜•ì‹ìœ¼ë¡œ ìˆ˜ì‹ ë˜ë©´, ë§‰ëŒ€ ë¬¸ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ tmp[] ë°°ì—´ë¡œ ë¶„í• í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤. ë¶„í•  ê¸°ì¤€ì¸ ë§‰ëŒ€ë¬¸ìëŠ” <strong>var tmp = data.split (â€˜|â€™)</strong> ë¬¸ì„ í†µí•´ ì§€ì •í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">var</span> <span class="n">Socket</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">function</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">Socket</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">WebSocket</span><span class="p">(</span><span class="err">&#39;</span><span class="nl">ws</span><span class="p">:</span><span class="c1">//&#39; + window.location.hostname + &#39;:81/&#39;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">Socket</span><span class="p">.</span><span class="n">onmessage</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span> <span class="nf">processReceivedCommand</span><span class="p">(</span><span class="n">event</span><span class="p">);</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="nf">processReceivedCommand</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">var</span> <span class="n">data</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">recData</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sc">&#39;|&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">potentiometer1</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>  
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">potentiometer2</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">touch</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">&#39;</span><span class="n">brightness</span><span class="err">&#39;</span><span class="p">).</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//consol.log(evt.data);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="nf">sendText</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">Socket</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">window</span><span class="p">.</span><span class="n">onload</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span> <span class="nf">init</span><span class="p">();</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">=====</span><span class="s">&#34;;</span></span></span></code></pre></div><br>
<h5 id="html-ë¶„ë¦¬-ì„ íƒì‚¬í•­">html ë¶„ë¦¬ (ì„ íƒì‚¬í•­)<a class="anchor" href="#html-%eb%b6%84%eb%a6%ac-%ec%84%a0%ed%83%9d%ec%82%ac%ed%95%ad">#</a></h5>
<p>Stringí˜•íƒœë¡œ ì§€ì •ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨í•˜ëŠ” html í˜ì´ì§€ë¥¼ í‘œí˜„í•˜ëŠ” ì½”ë“œì˜ ì „ì²´ ê¸¸ì´ë¡œ ì¸í•´ ìŠ¤ì¼€ì¹˜ê°€ ë³µì¡í•´ë³´ì´ë¯€ë¡œ, ì „ì²´ ìŠ¤ì¼€ì¹˜ì˜ ìƒë‹¨ì— ìˆëŠ” html ë¶€ë¶„ì„ ë¶„ë¦¬í•´ë„ ë©ë‹ˆë‹¤. íŒŒì¼ì€ ë¶„ë¦¬ë˜ì§€ë§Œ ì»´íŒŒì¼ ë ë•Œë§ˆë‹¤ ë©”ì¸ ìŠ¤ì¼€ì¹˜ì— í¬í•¨ë  ê²ƒì…ë‹ˆë‹¤. (í˜¹ì€ ESP32ì˜ SPIFFSë¥¼ ì‚¬ìš©í•˜ì—¬ ë³„ë„ì˜ íŒŒì¼ í˜•íƒœë¡œ ì—…ë¡œë“œí•´ë„ ë©ë‹ˆë‹¤.)</p>
<ul>
<li>
<p>Arduino IDEì˜ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ìˆëŠ” ì‘ì€ ì•„ë˜ë°©í–¥ í™”ì‚´í‘œ í´ë¦­í•œ ë’¤ <strong>New Tab</strong> ì„ íƒ</p>

  
  
  
  
  
  
  <figure
    
    class="center"
  
    
    style="width: 75%;">
  
    <img src="/image/websocket02.png" alt="/image/websocket02.png">
  
    
    
  </figure>
</li>
<li>
<p>ì½˜ì†”ì˜ í…ìŠ¤íŠ¸ ìƒìì— ë¶„ë¦¬í•˜ì—¬ ì €ì¥í•  html íŒŒì¼ì´ë¦„ì„ ì…ë ¥í•œ ë’¤ í™•ì¸ í´ë¦­</p>
<ul>
<li>í™•ì¥ìëŠ” .hë¡œ ì‚¬ìš© (â€» ë‹¨, <strong>.html</strong> í™•ì¥ìëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ)</li>
</ul>

  
  
  
  
  
  
  <figure
    
    class="center"
  
    
    style="width: 75%;">
  
    <img src="/image/websocket03.png" alt="/image/websocket03.png">
  
    
    
  </figure>
</li>
<li>
<p>Arduino IDEì— ìƒˆë¡œìš´ íƒ­ì´ ì—´ë¦¬ë©´, html_headerì™€ html_mainì„ í¬í•¨í•œ ë‘ê°œì˜ String ë¬¸ì„ ë³µì‚¬í•˜ì—¬ mainpage.h íƒ­ì— ë¶™ì—¬ë„£ê¸° í•œ ë’¤ ì €ì¥ (ìŠ¤ì¼€ì¹˜ê°€ ìœ„ì¹˜í•œ í´ë”ì— ë³„ë„ë¡œ ì €ì¥ë¨)</p>

  
  
  
  
  
  
  <figure
    
    class="center"
  
    
    style="width: 75%;">
  
    <img src="/image/websocket04.png" alt="/image/websocket04.png">
  
    
    
  </figure>
</li>
<li>
<p>ë¶„ë¦¬ëœ html íŒŒì¼ì„ ë©”ì¸ ìŠ¤ì¼€ì¹˜ì— includeë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì‚½ì…í•œ ë’¤ ì €ì¥</p>

  
  
  
  
  
  
  <figure
    
    class="center"
  
    
    style="width: 75%;">
  
    <img src="/image/websocket05.png" alt="/image/websocket05.png">
  
    
    
  </figure>
</li>
<li>
<p>Arduino IDEì—ì„œ ë©”ì¸ ìŠ¤ì¼€ì¹˜ë¥¼ ì—´ë©´, ë³„ë„ì˜ íƒ­ì— ë¶„ë¦¬ëœ html íŒŒì¼ë„ í•¨ê»˜ ì—´ë¦¼</p>
</li>
</ul>
<br>
<br>
<h4 id="part2-ë©”ì¸-ìŠ¤ì¼€ì¹˜">Part2: ë©”ì¸ ìŠ¤ì¼€ì¹˜<a class="anchor" href="#part2-%eb%a9%94%ec%9d%b8-%ec%8a%a4%ec%bc%80%ec%b9%98">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">updateSensors</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">potentiometer1</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">potPin1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">potentiometer2</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">potPin2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">touch</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">touPin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">brightness</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">briPin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">potentiometer1</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">&#34;|&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">potentiometer2</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">&#34;|&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">touch</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">&#34;|&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="nf">String</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">brightness</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="n">webSocket</span><span class="p">.</span><span class="nf">broadcastTXT</span><span class="p">(</span><span class="n">data</span><span class="p">);</span> <span class="c1">// send the data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>         <span class="c1">// display the data in the serial monitor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><ul>
<li>ì„¼ì„œê°’ì€ updateSensor() í•¨ìˆ˜ë¥¼ í†µí•´ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</li>
<li>4ì¢…ë¥˜ì˜ ì„¼ì„œê°’ì„ ë§‰ëŒ€ ë¬¸ì(&quot;|&quot;)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ê²°í•œ ë’¤, <strong>String</strong> í˜•ì‹ì˜ data ë³€ìˆ˜ì— ëª¨ë‘ ì €ì¥í•œ ë’¤, **webSocket.broadcastTXT(data)**ì„ ì‚¬ìš©í•˜ì—¬ htmlë¡œ ë³´ëƒ…ë‹ˆë‹¤. String í˜•ì‹ì€ ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë‹¨ì ì´ ìˆì§€ë§Œ, charsì— ë¹„í•´ ë°ì´í„° ì²˜ë¦¬ê°€ ê°„ë‹¨í•´ì§€ë¯€ë¡œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë”êµ¬ë‚˜ ESP32ì˜ ë‚´ì¥ ë©”ëª¨ë¦¬ëŠ” ì¼ë°˜ì ì¸ ê²½ìš° ì¶©ë¶„íˆ í° í¸ì— ì†í•œë‹¤.</li>
</ul>
<br>
<br>
<h3 id="ê²°ê³¼">ê²°ê³¼<a class="anchor" href="#%ea%b2%b0%ea%b3%bc">#</a></h3>
<ul>
<li>
<p>ESP32ë¥¼ APëª¨ë“œë¡œ ë™ì‘í•˜ë„ë¡ í•˜ì˜€ìœ¼ë¯€ë¡œ, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ESP32ì˜ SSIDë¥¼ ì°¾ì•„ ì ‘ì†í•œë‹¤. ì˜ˆë¥¼ë“¤ë©´,</p>
<ul>
<li>SSID : ESP32-AP-1</li>
<li>PASS : 123456789</li>
</ul>
</li>
<li>
<p>í´ë¼ì´ì–¸íŠ¸ì˜ ì›¹ë¸Œë¼ìš°ì €ë¥¼ í†µí•´, ESP32ì— ì ‘ì†í•œë‹¤.</p>
<ul>
<li>(ì£¼ì†Œì°½ì—) 192.168.4.1</li>
</ul>
</li>
<li>
<p>ê²°ê³¼ í™•ì¸</p>

  
  
  
  
  
  
  <figure
    
    class="center"
  
    
    style="width: 50%;">
  
    <img src="/image/websocket06.png" alt="/image/websocket06.png">
  
    
    
  </figure>
<p>ì‹¤ì‹œê°„ìœ¼ë¡œ ì„¼ì„œê°’ì´ ë³€ê²½ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</li>
</ul>
</div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
    <a href="/posts/esp32-openweathermap/" class="flex align-center">
      <img src="/icons/backward.svg" class="book-icon" alt="Previous" title="esp32 OpenWeatherMapì—ì„œ ì‹¤ì‹œê°„ ë‚ ì”¨ ì •ë³´ ë°›ê¸°" />
      <span>esp32 OpenWeatherMapì—ì„œ ì‹¤ì‹œê°„ ë‚ ì”¨ ì •ë³´ ë°›ê¸°</span>
    </a>
  
  </div>
  <div>
  
    <a href="/posts/%EC%97%91%EC%85%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9C%A0%ED%9A%A8%EC%84%B1%EA%B2%80%EC%82%AC-%EB%8F%99%EC%A0%81%EB%B2%94%EC%9C%84%EC%84%A4%EC%A0%95/" class="flex align-center">
      <span>ì—‘ì…€, ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ì˜ ëª©ë¡ êµ¬ì„±ì‹œ ë™ì  ë²”ìœ„ ì„¤ì •</span>
      <img src="/icons/forward.svg" class="book-icon" alt="Next" title="ì—‘ì…€, ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ì˜ ëª©ë¡ êµ¬ì„±ì‹œ ë™ì  ë²”ìœ„ ì„¤ì •" />
    </a>
  
  </div>
</div>
 
        
  
  <div class="book-comments">

</div>
  
 
        
        

 
      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    

<aside class="book-toc">
  <div class="book-toc-content">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#ap-mode">AP mode</a></li>
        <li><a href="#ap-mode-ì„¤ì •">AP mode ì„¤ì •</a></li>
        <li><a href="#websocket">Websocket</a></li>
        <li><a href="#ê²°ê³¼">ê²°ê³¼</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </div>
</aside>

 
  </main>

  
</body>
</html>


















