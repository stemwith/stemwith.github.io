---
title: "엑셀, 다중조건을 사용하여 랭킹 구하기"
categories: ["office"]
date: 2018-06-01T18:27:53+09:00
toc: true
tags:
---

1가지 조건으로 랭킹을 구하는 경우, rank.eq() 함수를 사용하면 되지만, 2가지 이상의 조건이 부합하는 경우에는 rank.eq() 함수로는 구할 수 없습니다. 이처럼 다중 조건이 주어졌을 때 랭킹을 구하는 방법입니다.

<br>

### 예시

![](/image/rank.png)

<br>

위 예시에서 '자격'과 '계열' 조건에 따라 각각의 랭킹을 구하는 함수는

3년인문 랭킹의 경우

```C
=IF(AND($E3=L$1,$F3=L$2),SUMPRODUCT(($E$3:$E$27=$E3)*($F$3:$F$27=$F3)*($J$3:$J$27>$J3))+1,"")
```

입니다.

<br>

- L1, L2에 '3', '인문'이라는 조건을 넣고
- AND($E3=L$1,$F3=L$2) 부분을 통해 E, F열의 값이 각각 '3'과 '인문'인 경우에만
- J3:J27 까지의 국어영어 합계점수에 따라 랭킹을 부여합니다. 
- 동석차인경우 높은 순위의 값을 부여합니다.