<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="OpenWeatherMap.org#
OpenWeatherMap은 세계 각 지역의 현재 날씨, 예보, 과거 날씨 데이터를 제공하는 사이트입니다. (몇가지 제약이 있긴 하지만) 회원가입을 통해서 API Key를 생성하고 이를 통해 무료로 실시간 날씨 정보를 얻을 수 있습니다.

Free Current weather and forecasts collection#

60 Calls per minute (no more than)
Current weather API
5 days/3 hour forecast API
Weather maps 1.0
UV index
Weather alerts
Availability 95%
Weather API data update  < 2 hours
Weather maps data update  < 3 hours
API lifetime support :  Current version
Historical weather collection은 모두 Starter 이상(유료)


Current weather collections API Key 생성#


Sign Up을 클릭하여 회원가입을 하고,"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://stemwith.github.io/posts/esp32-openweathermap/"><meta property="og:site_name" content="stemwith"><meta property="og:title" content="esp32 OpenWeatherMap에서 실시간 날씨 정보 받기"><meta property="og:description" content="OpenWeatherMap.org# OpenWeatherMap은 세계 각 지역의 현재 날씨, 예보, 과거 날씨 데이터를 제공하는 사이트입니다. (몇가지 제약이 있긴 하지만) 회원가입을 통해서 API Key를 생성하고 이를 통해 무료로 실시간 날씨 정보를 얻을 수 있습니다.
Free Current weather and forecasts collection# 60 Calls per minute (no more than) Current weather API 5 days/3 hour forecast API Weather maps 1.0 UV index Weather alerts Availability 95% Weather API data update < 2 hours Weather maps data update < 3 hours API lifetime support : Current version Historical weather collection은 모두 Starter 이상(유료) Current weather collections API Key 생성# Sign Up을 클릭하여 회원가입을 하고,"><meta property="og:locale" content="ko_kr"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-19T18:27:53+09:00"><meta property="article:modified_time" content="2019-11-19T18:27:53+09:00"><meta property="article:tag" content="Iot"><title>esp32 OpenWeatherMap에서 실시간 날씨 정보 받기 | stemwith</title><link rel=icon href=/favicon.ico><link rel=manifest href=/manifest.json><link rel=canonical href=https://stemwith.github.io/posts/esp32-openweathermap/><link rel=stylesheet href=/book.min.4a9d0c155a0e6c344df12063be3cf2ab65cdfeee91d3cab693d1e82931923740.css integrity="sha256-Sp0MFVoObDRN8SBjvjzyq2XN/u6R08q2k9HoKTGSN0A=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.48a89e4be341d639de74b0f5b5a0b5ad125313b71f6faa18dd992cd4721b044e.js integrity="sha256-SKieS+NB1jnedLD1taC1rRJTE7cfb6oY3Zks1HIbBE4=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-128DRYVCRT"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-128DRYVCRT")}</script></head><body dir=ltr class="book-kind-page book-type-posts"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/og_image.png alt=Logo></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/icons/menu.svg class=book-icon alt=Menu></label><h3>esp32 OpenWeatherMap에서 실시간 날씨 정보 받기</h3><label for=toc-control><img src=/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><ul><li><a href=#openweathermaporg>OpenWeatherMap.org</a></li><li><a href=#esp32에서-사용하는-경우>ESP32에서 사용하는 경우</a></li><li><a href=#json-parsing>JSON Parsing</a></li><li><a href=#weather-condition-code>Weather Condition Code</a></li><li><a href=#1602-lcd에-날씨-정보-출력하기>1602 LCD에 날씨 정보 출력하기</a></li><li><a href=#공공데이터-활용하기>공공데이터 활용하기</a></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h1>esp32 OpenWeatherMap에서 실시간 날씨 정보 받기</h1><div class="flex align-center text-small book-post-date"><img src=/icons/calendar.svg class=book-icon alt>
<span>November 19, 2019</span></div><div class=text-small><a href=/categories/esp32/>Esp32</a></div><div class=text-small><a href=/tags/iot/>Iot</a></div><div class="book-post-content markdown-inner"><h3 id=openweathermaporg>OpenWeatherMap.org<a class=anchor href=#openweathermaporg>#</a></h3><p><a href=https://openweathermap.org/>OpenWeatherMap</a>은 세계 각 지역의 현재 날씨, 예보, 과거 날씨 데이터를 제공하는 사이트입니다. (몇가지 제약이 있긴 하지만) 회원가입을 통해서 API Key를 생성하고 이를 통해 무료로 실시간 날씨 정보를 얻을 수 있습니다.</p><br><h4 id=free-current-weather-and-forecasts-collection>Free Current weather and forecasts collection<a class=anchor href=#free-current-weather-and-forecasts-collection>#</a></h4><ul><li>60 Calls per minute (no more than)</li><li><a href=https://openweathermap.org/current>Current weather API</a></li><li><a href=https://openweathermap.org/forecast5>5 days/3 hour forecast API</a></li><li><a href=https://openweathermap.org/api/weathermaps>Weather maps 1.0</a></li><li><a href=https://openweathermap.org/api/uvi>UV index</a></li><li><a href=https://openweathermap.org/triggers>Weather alerts</a></li><li>Availability 95%</li><li>Weather API data update &lt; 2 hours</li><li>Weather maps data update &lt; 3 hours</li><li>API lifetime support : Current version</li><li>Historical weather collection은 모두 Starter 이상(유료)</li></ul><br><h4 id=current-weather-collections-api-key-생성>Current weather collections API Key 생성<a class=anchor href=#current-weather-collections-api-key-%ec%83%9d%ec%84%b1>#</a></h4><ol><li><p>Sign Up을 클릭하여 회원가입을 하고,</p><figure class=center style=width:75%><img src=/image/owm-api-01.png alt=/image/owm-api-01.png></figure><br><figure class=center style=width:75%><img src=/image/owm-api-02.png alt=/image/owm-api-02.png></figure><br></li><li><p>Sign In을 클릭하여 로그인한 뒤, API Keys를 누릅니다.</p><figure class=center style=width:75%><img src=/image/owm-api-03.png alt=/image/owm-api-03.png></figure><br><figure class=center style=width:75%><img src=/image/owm-api-04.png alt=/image/owm-api-04.png></figure><br></li><li><p>Default로 지정되어 있는 Key를 복사하거나, 새로운 Key를 생성합니다.</p></li></ol><figure class=center style=width:75%><img src=/image/owm-api-05.png alt=/image/owm-api-05.png></figure><br><ol start=4><li><p>API Key를 이용하는 방법은 메인홈페이지 메뉴의 API 탭을 누른뒤, 얻고자 하는 날씨정보(예를 들어 Current weather data)의 <a href=https://openweathermap.org/api><strong>API doc</strong></a>을 참고하세요.</p><figure class=center style=width:75%><img src=/image/owm-api-06.png alt=/image/owm-api-06.png></figure></li><li><p>먼저 인터넷 브라우저를 통해 날씨정보가 어떻게 출력되는지 알아보기위하여 아래 홈페이지 주소에 접속해봅니다. 이때 주소의 끝부분에 있는 YOUR_API_KEY 대신 본인의 API Key를 입력합니다.</p></li></ol><br><ul><li>서울: <a href="https://api.openweathermap.org/data/2.5/weather?q=Seoul,KR&amp;units=metric&amp;APPID=YOUR_API_KEY">https://api.openweathermap.org/data/2.5/weather?q=Seoul,KR&units=metric&APPID=YOUR_API_KEY</a></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>https://api.openweathermap.org/data/2.5/weather?q=Seoul,KR&amp;units=metric&amp;APPID=1bf3d5e1bd2e5934aadd86..........</span></span></span></code></pre></div><br><ul><li>런던: <a href="https://api.openweathermap.org/data/2.5/weather?q=London,GB&amp;units=metric&amp;appid=YOUR_API_KEY">https://api.openweathermap.org/data/2.5/weather?q=London,GB&units=metric&appid=YOUR_API_KEY</a></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>https://api.openweathermap.org/data/2.5/weather?q=London,GB&amp;units=metric&amp;APPID=1bf3d5e1bd2e5934aadd86..........</span></span></span></code></pre></div><br><ul><li>상하이: <a href="https://api.openweathermap.org/data/2.5/weather?q=Shanghai,CN&amp;units=metric&amp;APPID=YOUR_API_KEY">https://api.openweathermap.org/data/2.5/weather?q=Shanghai,CN&units=metric&APPID=YOUR_API_KEY</a></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>https://api.openweathermap.org/data/2.5/weather?q=Shanghai,CN&amp;units=metric&amp;APPID=1bf3d5e1bd2e5934aadd86..........</span></span></span></code></pre></div><br><h4 id=브라우저에-출력되는-내용>브라우저에 출력되는 내용<a class=anchor href=#%eb%b8%8c%eb%9d%bc%ec%9a%b0%ec%a0%80%ec%97%90-%ec%b6%9c%eb%a0%a5%eb%90%98%eb%8a%94-%eb%82%b4%ec%9a%a9>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;coord&#34;</span><span class=p>:{</span><span class=nt>&#34;lon&#34;</span><span class=p>:</span><span class=mf>-0.13</span><span class=p>,</span><span class=nt>&#34;lat&#34;</span><span class=p>:</span><span class=mf>51.51</span><span class=p>},</span><span class=nt>&#34;weather&#34;</span><span class=p>:[{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=mi>804</span><span class=p>,</span><span class=nt>&#34;main&#34;</span><span class=p>:</span><span class=s2>&#34;Clouds&#34;</span><span class=p>,</span><span class=nt>&#34;description&#34;</span><span class=p>:</span><span class=s2>&#34;overcast clouds&#34;</span><span class=p>,</span><span class=nt>&#34;icon&#34;</span><span class=p>:</span><span class=s2>&#34;04n&#34;</span><span class=p>}],</span><span class=nt>&#34;base&#34;</span><span class=p>:</span><span class=s2>&#34;stations&#34;</span><span class=p>,</span><span class=nt>&#34;main&#34;</span><span class=p>:{</span><span class=nt>&#34;temp&#34;</span><span class=p>:</span><span class=mf>277.16</span><span class=p>,</span><span class=nt>&#34;pressure&#34;</span><span class=p>:</span><span class=mi>1007</span><span class=p>,</span><span class=nt>&#34;humidity&#34;</span><span class=p>:</span><span class=mi>86</span><span class=p>,</span><span class=nt>&#34;temp_min&#34;</span><span class=p>:</span><span class=mf>274.82</span><span class=p>,</span><span class=nt>&#34;temp_max&#34;</span><span class=p>:</span><span class=mf>279.26</span><span class=p>},</span><span class=nt>&#34;visibility&#34;</span><span class=p>:</span><span class=mi>8000</span><span class=p>,</span><span class=nt>&#34;wind&#34;</span><span class=p>:{</span><span class=nt>&#34;speed&#34;</span><span class=p>:</span><span class=mf>5.1</span><span class=p>,</span><span class=nt>&#34;deg&#34;</span><span class=p>:</span><span class=mi>90</span><span class=p>},</span><span class=nt>&#34;clouds&#34;</span><span class=p>:{</span><span class=nt>&#34;all&#34;</span><span class=p>:</span><span class=mi>90</span><span class=p>},</span><span class=nt>&#34;dt&#34;</span><span class=p>:</span><span class=mi>1574300635</span><span class=p>,</span><span class=nt>&#34;sys&#34;</span><span class=p>:{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=mi>1414</span><span class=p>,</span><span class=nt>&#34;country&#34;</span><span class=p>:</span><span class=s2>&#34;GB&#34;</span><span class=p>,</span><span class=nt>&#34;sunrise&#34;</span><span class=p>:</span><span class=mi>1574321288</span><span class=p>,</span><span class=nt>&#34;sunset&#34;</span><span class=p>:</span><span class=mi>1574352288</span><span class=p>},</span><span class=nt>&#34;timezone&#34;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=mi>2643743</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;London&#34;</span><span class=p>,</span><span class=nt>&#34;cod&#34;</span><span class=p>:</span><span class=mi>200</span><span class=p>}</span></span></span></code></pre></div><br><p>그밖의 도시 및 국가명은 Maps> Weather maps를 클릭하여 표시되는 지도를 통해 확인할 수 있습니다.</p><br><br><h3 id=esp32에서-사용하는-경우>ESP32에서 사용하는 경우<a class=anchor href=#esp32%ec%97%90%ec%84%9c-%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94-%ea%b2%bd%ec%9a%b0>#</a></h3><h4 id=wifi-접속-설정>wifi 접속 설정<a class=anchor href=#wifi-%ec%a0%91%ec%86%8d-%ec%84%a4%ec%a0%95>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>ssid</span>     <span class=o>=</span> <span class=s>&#34;your ssid&#34;</span><span class=p>;</span>                  <span class=c1>// 연결할 SSID
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>password</span> <span class=o>=</span> <span class=s>&#34;your password&#34;</span><span class=p>;</span>              <span class=c1>// 연결할 SSID의 비밀번호
</span></span></span></code></pre></div><ul><li>wifi에 접속하기 위한 ssid와 password를 설정</li></ul><br><h4 id=openweathermaporg-접속-설정>OpenWeatherMap.org 접속 설정<a class=anchor href=#openweathermaporg-%ec%a0%91%ec%86%8d-%ec%84%a4%ec%a0%95>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>endpoint</span> <span class=o>=</span> <span class=s>&#34;https://api.openweathermap.org&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>ver</span> <span class=o>=</span> <span class=s>&#34;/data/2.5/weather?q=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>city</span> <span class=o>=</span> <span class=s>&#34;Shanghai,CN&#34;</span><span class=p>;</span>                 <span class=c1>// City,Country (띄어쓰기 금지)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>appid</span> <span class=o>=</span> <span class=s>&#34;&amp;units=metric&amp;APPID=&#34;</span><span class=p>;</span>       <span class=c1>// Units: metric
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>key</span> <span class=o>=</span> <span class=s>&#34;1bf3d5e1bd2e5934aadd86..........&#34;</span><span class=p>;</span>    <span class=c1>// API Key
</span></span></span></code></pre></div><ul><li>날씨 데이터를 받아올 도시, 국가를 지정 (Shanghai,CN) (※주의: <strong>Shanghai,CN</strong> 사이에 <strong>띄어쓰기를 하면 안됨</strong>)</li><li>key 변수에 본의 API Key를 입력</li></ul><br><h4 id=sketch>sketch<a class=anchor href=#sketch>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;WiFi.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;HTTPClient.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>ssid</span>     <span class=o>=</span> <span class=s>&#34;your ssid&#34;</span><span class=p>;</span>                  <span class=c1>// 연결할 SSID
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>password</span> <span class=o>=</span> <span class=s>&#34;your password&#34;</span><span class=p>;</span>              <span class=c1>// 연결할 SSID의 비밀번호
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// OpenWeatherMap.org: Shanghai,CN
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>endpoint</span> <span class=o>=</span> <span class=s>&#34;https://api.openweathermap.org&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>ver</span> <span class=o>=</span> <span class=s>&#34;/data/2.5/weather?q=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>city</span> <span class=o>=</span> <span class=s>&#34;Shanghai,CN&#34;</span><span class=p>;</span>                 <span class=c1>// City,Country (띄어쓰기 금지)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>appid</span> <span class=o>=</span> <span class=s>&#34;&amp;units=metric&amp;APPID=&#34;</span><span class=p>;</span>       <span class=c1>// Units: metric
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>key</span> <span class=o>=</span> <span class=s>&#34;1bf3d5e1bd2e5934aadd86..........&#34;</span><span class=p>;</span>    <span class=c1>// API Key
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=mi>115200</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>delay</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>WiFi</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=n>ssid</span><span class=p>,</span> <span class=n>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 와이파이 연결
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=p>(</span><span class=n>WiFi</span><span class=p>.</span><span class=n>status</span><span class=p>()</span> <span class=o>!=</span> <span class=n>WL_CONNECTED</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>delay</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Connecting to WiFi..&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Connected to the WiFi network&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 연결 여부 로그 출력
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>((</span><span class=n>WiFi</span><span class=p>.</span><span class=n>status</span><span class=p>()</span> <span class=o>==</span> <span class=n>WL_CONNECTED</span><span class=p>))</span> <span class=p>{</span>    <span class=c1>// Check the current connection status
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    <span class=n>HTTPClient</span> <span class=n>http</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>http</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=n>endpoint</span> <span class=o>+</span> <span class=n>ver</span> <span class=o>+</span> <span class=n>city</span> <span class=o>+</span> <span class=n>appid</span> <span class=o>+</span> <span class=n>key</span><span class=p>);</span> <span class=c1>// Specify the URL
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>httpCode</span> <span class=o>=</span> <span class=n>http</span><span class=p>.</span><span class=n>GET</span><span class=p>();</span>                       <span class=c1>// Make the request
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>httpCode</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>                              <span class=c1>// Check for the returning code
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=n>http</span><span class=p>.</span><span class=n>getString</span><span class=p>();</span>         <span class=c1>// get JSON format data
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>httpCode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>json</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Error on HTTP request&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>http</span><span class=p>.</span><span class=n>end</span><span class=p>();</span>                                     <span class=c1>// Free the resources
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>30000</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><br><h4 id=출력-data>출력 DATA<a class=anchor href=#%ec%b6%9c%eb%a0%a5-data>#</a></h4><p>출력 데이터는 <strong>JSON</strong>(JavaScript Object Notation)을 기반으로 합니다. JSON은 프로그래밍 언어에 관계없이 데이터를 생성하고 읽을 수 있도록 만들어졌으며, 이를 통해 상호간에 보다 쉽게 데이터를 교환이 가능한 텍스트 기반의 데이터 교환 방식입니다. OpenWeatherMap에서도 이 방식을 사용하여 날씨 데이터를 생성하여 출력하고 있으며, 출력 데이터의 형태는 아래와 같습니다.</p><blockquote class=book-hint><p>스케치 맨 아래라인의 delay 명령으로 인해 10초마다 1번씩 data를 출력합니다. 단, OpenWeatherMap free service의 update time이 2시간 이하로 되어 있으므로, 자료 갱신이 매 출력시마다 진행되지는 않습니다.</p></blockquote><figure class=center style=width:75%><img src=/image/owm-01.png alt=/image/owm-01.png></figure><br><p>Firefox 등의 몇몇 인터넷 브라우저에서는 JSON 데이터를 보다 직관적으로 이해할 수 있도록 계층별로 나누어 출력해주기도 합니다.</p><figure class=center style=width:50%><img src=/image/owm-02.png alt=/image/owm-02.png></figure><br><br><h3 id=json-parsing>JSON Parsing<a class=anchor href=#json-parsing>#</a></h3><p>위와 같이 복잡한 형태로 출력되는 날씨 데이터 중에서 필요한 날씨 정보를 추출하기 위하여 JSON (JavaScript Object Notation) 파싱 과정을 거쳐야 하는데요. 이를 위해 아두이노 IDE에서 Json 파싱을 위한 라이브러리를 설치하여야 합니다.</p><br><h4 id=라이브러리-설치>라이브러리 설치<a class=anchor href=#%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac-%ec%84%a4%ec%b9%98>#</a></h4><p>ArduinoJson (by Benoit Blanchon) 라이브러리 (version 6)를 설치합니다.</p><p><strong>스케치</strong>> <strong>라이브러리 포함하기</strong>> <strong>라이브러리 관리</strong></p><figure class=center style=width:75%><img src=/image/json-01.png alt=/image/json-01.png></figure><br><figure class=center style=width:75%><img src=/image/json-02.png alt=/image/json-02.png></figure><br><h4 id=memory-pool-크기-계산>Memory pool 크기 계산<a class=anchor href=#memory-pool-%ed%81%ac%ea%b8%b0-%ea%b3%84%ec%82%b0>#</a></h4><ol><li>JSON 파싱에 사용할 배열의 크기를 계산하여 메모리를 확보합니다. 이를 위해 샘플로 사용할 JSON데이터가 필요하므로, 먼저 웹브라우저에서 OpenWeatherMap에 접속한 뒤,</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>https://api.openweathermap.org/data/2.5/weather?q=Shanghai,CN&amp;units=metric&amp;APPID=1bf3d5e1bd2e5934aadd86..........</span></span></span></code></pre></div><br><ol start=2><li>출력되는 JSON 데이터를 드래그하여 복사합니다.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;coord&#34;</span><span class=p>:{</span><span class=nt>&#34;lon&#34;</span><span class=p>:</span><span class=mf>-0.13</span><span class=p>,</span><span class=nt>&#34;lat&#34;</span><span class=p>:</span><span class=mf>51.51</span><span class=p>},</span><span class=nt>&#34;weather&#34;</span><span class=p>:[{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=mi>804</span><span class=p>,</span><span class=nt>&#34;main&#34;</span><span class=p>:</span><span class=s2>&#34;Clouds&#34;</span><span class=p>,</span><span class=nt>&#34;description&#34;</span><span class=p>:</span><span class=s2>&#34;overcast clouds&#34;</span><span class=p>,</span><span class=nt>&#34;icon&#34;</span><span class=p>:</span><span class=s2>&#34;04n&#34;</span><span class=p>}],</span><span class=nt>&#34;base&#34;</span><span class=p>:</span><span class=s2>&#34;stations&#34;</span><span class=p>,</span><span class=nt>&#34;main&#34;</span><span class=p>:{</span><span class=nt>&#34;temp&#34;</span><span class=p>:</span><span class=mf>277.16</span><span class=p>,</span><span class=nt>&#34;pressure&#34;</span><span class=p>:</span><span class=mi>1007</span><span class=p>,</span><span class=nt>&#34;humidity&#34;</span><span class=p>:</span><span class=mi>86</span><span class=p>,</span><span class=nt>&#34;temp_min&#34;</span><span class=p>:</span><span class=mf>274.82</span><span class=p>,</span><span class=nt>&#34;temp_max&#34;</span><span class=p>:</span><span class=mf>279.26</span><span class=p>},</span><span class=nt>&#34;visibility&#34;</span><span class=p>:</span><span class=mi>8000</span><span class=p>,</span><span class=nt>&#34;wind&#34;</span><span class=p>:{</span><span class=nt>&#34;speed&#34;</span><span class=p>:</span><span class=mf>5.1</span><span class=p>,</span><span class=nt>&#34;deg&#34;</span><span class=p>:</span><span class=mi>90</span><span class=p>},</span><span class=nt>&#34;clouds&#34;</span><span class=p>:{</span><span class=nt>&#34;all&#34;</span><span class=p>:</span><span class=mi>90</span><span class=p>},</span><span class=nt>&#34;dt&#34;</span><span class=p>:</span><span class=mi>1574300635</span><span class=p>,</span><span class=nt>&#34;sys&#34;</span><span class=p>:{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=mi>1414</span><span class=p>,</span><span class=nt>&#34;country&#34;</span><span class=p>:</span><span class=s2>&#34;GB&#34;</span><span class=p>,</span><span class=nt>&#34;sunrise&#34;</span><span class=p>:</span><span class=mi>1574321288</span><span class=p>,</span><span class=nt>&#34;sunset&#34;</span><span class=p>:</span><span class=mi>1574352288</span><span class=p>},</span><span class=nt>&#34;timezone&#34;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=mi>2643743</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;London&#34;</span><span class=p>,</span><span class=nt>&#34;cod&#34;</span><span class=p>:</span><span class=mi>200</span><span class=p>}</span></span></span></code></pre></div><br><ol start=3><li><a href=https://arduinojson.org/assistant>https://arduinojson.org/assistant</a> 에 접속한 뒤, <strong>Input</strong>란에 있는 내용을 모두 지우고 복사한 JSON데이터를 붙여넣기하면, Memory pool size가 자동으로 계산됩니다.</li></ol><figure class=center style=width:75%><img src=/image/owm-04.png alt=/image/owm-04.png></figure><br><ol start=4><li>Memory pool size의 Expression부분을 드래그하여 복사하고, Additional bytes for strings dubplucation 부분의 숫자를 이용하여 스케치에서 다음의 형식으로 변수를 생성합니다.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=k>const</span> <span class=n>size_t</span> <span class=n>capacity</span> <span class=o>=</span> <span class=n>JSON_ARRAY_SIZE</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>13</span><span class=p>)</span> <span class=o>+</span> <span class=mi>240</span><span class=p>;</span></span></span></code></pre></div><blockquote class=book-hint><p>실제로는 아래 Parsing Program에 이미 변수가 설정되어 있으므로, 이 과정은 수행하지 않아도 됩니다.</p></blockquote><br><h4 id=parsing-program>Parsing program<a class=anchor href=#parsing-program>#</a></h4><ol><li>Memory pool size가 출력된 화면의 아래쪽에 Parsing program도 함께 출력됩니다.</li></ol><figure class=center style=width:75%><img src=/image/owm-05.png alt=/image/owm-05.png></figure><br><ol start=2><li>우선 Parsing Program 전체를 복사한 뒤, 스케치의 void loop() 부분에 붙여넣기 합니다.</li></ol><br><ol start=3><li>밑줄친 부분의 json 변수가 나타나 있는 라인을 모두 지우고</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{</span><span class=se>\&#34;</span><span class=s>coord</span><span class=se>\&#34;</span><span class=s>:{</span><span class=se>\&#34;</span><span class=s>lon</span><span class=se>\&#34;</span><span class=s>:121.49,</span><span class=se>\&#34;</span><span class=s>lat</span><span class=se>\&#34;</span><span class=s>:31.23},</span><span class=se>\&#34;</span><span class=s>weather</span><span class=se>\&#34;</span><span class=s>:[{</span><span class=se>\&#34;</span><span class=s>id</span><span class=se>\&#34;</span><span class=s>:804,</span><span class=se>\&#34;</span><span class=s>main</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>Clouds</span><span class=se>\&#34;</span><span class=s>,</span><span class=se>\&#34;</span><span class=s>description</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>overcast clouds</span><span class=se>\&#34;</span><span class=s>,</span><span class=se>\&#34;</span><span class=s>icon</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>04d</span><span class=se>\&#34;</span><span class=s>}],</span><span class=se>\&#34;</span><span class=s>base</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>stations</span><span class=se>\&#34;</span><span class=s>,</span><span class=se>\&#34;</span><span class=s>main</span><span class=se>\&#34;</span><span class=s>:{</span><span class=se>\&#34;</span><span class=s>temp</span><span class=se>\&#34;</span><span class=s>:293.02,</span><span class=se>\&#34;</span><span class=s>pressure</span><span class=se>\&#34;</span><span class=s>:1027,</span><span class=se>\&#34;</span><span class=s>humidity</span><span class=se>\&#34;</span><span class=s>:55,</span><span class=se>\&#34;</span><span class=s>temp_min</span><span class=se>\&#34;</span><span class=s>:289.82,</span><span class=se>\&#34;</span><span class=s>temp_max</span><span class=se>\&#34;</span><span class=s>:298.71},</span><span class=se>\&#34;</span><span class=s>visibility</span><span class=se>\&#34;</span><span class=s>:10000,</span><span class=se>\&#34;</span><span class=s>wind</span><span class=se>\&#34;</span><span class=s>:{</span><span class=se>\&#34;</span><span class=s>speed</span><span class=se>\&#34;</span><span class=s>:3,</span><span class=se>\&#34;</span><span class=s>deg</span><span class=se>\&#34;</span><span class=s>:60},</span><span class=se>\&#34;</span><span class=s>clouds</span><span class=se>\&#34;</span><span class=s>:{</span><span class=se>\&#34;</span><span class=s>all</span><span class=se>\&#34;</span><span class=s>:94},</span><span class=se>\&#34;</span><span class=s>dt</span><span class=se>\&#34;</span><span class=s>:1574303919,</span><span class=se>\&#34;</span><span class=s>sys</span><span class=se>\&#34;</span><span class=s>:{</span><span class=se>\&#34;</span><span class=s>type</span><span class=se>\&#34;</span><span class=s>:1,</span><span class=se>\&#34;</span><span class=s>id</span><span class=se>\&#34;</span><span class=s>:9659,</span><span class=se>\&#34;</span><span class=s>country</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>CN</span><span class=se>\&#34;</span><span class=s>,</span><span class=se>\&#34;</span><span class=s>sunrise</span><span class=se>\&#34;</span><span class=s>:1574288762,</span><span class=se>\&#34;</span><span class=s>sunset</span><span class=se>\&#34;</span><span class=s>:1574326426},</span><span class=se>\&#34;</span><span class=s>timezone</span><span class=se>\&#34;</span><span class=s>:28800,</span><span class=se>\&#34;</span><span class=s>id</span><span class=se>\&#34;</span><span class=s>:1796236,</span><span class=se>\&#34;</span><span class=s>name</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>Shanghai</span><span class=se>\&#34;</span><span class=s>,</span><span class=se>\&#34;</span><span class=s>cod</span><span class=se>\&#34;</span><span class=s>:200}&#34;</span><span class=p>;</span></span></span></code></pre></div><br><ol start=4><li>OpenWeatherMap에서 실시간으로 받는 String 형식의 데이터 변수로 바꿔줍니다.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=n>http</span><span class=p>.</span><span class=n>getString</span><span class=p>();</span></span></span></code></pre></div><br><ol start=5><li>Timezone 반영을 위하여, 붙여넣기 한 Parsing program의 아래 부분에 아래 내용을 추가합니다.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>                     <span class=c1>// for GMT+8 -&gt; +28800, for GMT+9 -&gt; +32400
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>sys_sunrise</span> <span class=o>=</span> <span class=n>sys_sunrise</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>sys_sunset</span> <span class=o>=</span> <span class=n>sys_sunset</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span></span></span></code></pre></div><br><ol start=6><li><p>UNIX Timestamp로 표기되는 시간을 일반적인 날짜, 시간으로 표기되도록 변환해줍니다. 이를 위해서 timelib.h 파일을 이용해야하는데, 이 파일은 Time 라이브러리(by Michael Margolis)에 포함되어 있지요. 그러므로 라이브러리 매니저를 통해 Time라이브러리를 찾아 설치해줍니다.</p><figure class=center style=width:75%><img src=/image/owm-10.png alt=/image/owm-10.png></figure></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=n>year</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>month</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>day</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>hour</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>minute</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>second</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>weekday</span><span class=p>(</span><span class=n>dt</span><span class=p>));</span></span></span></code></pre></div><p>​ 위의 스케치를 통해서 UTC를 YYYY.MM.DD HH:MM:SS(요일) 형태의 날짜를 변환하며, printf문을 통해 출력할 수 있습니다.</p><br><h4 id=data-출력에-사용한-variables>Data 출력에 사용한 variables<a class=anchor href=#data-%ec%b6%9c%eb%a0%a5%ec%97%90-%ec%82%ac%ec%9a%a9%ed%95%9c-variables>#</a></h4><p>JSON 형식의 데이터를 파싱할때 사용한 변수들입니다.</p><table><thead><tr><th>내용</th><th>형식</th><th>변수</th><th>unit</th></tr></thead><tbody><tr><td>UNIX Time(UTC)</td><td>long</td><td>dt</td><td></td></tr><tr><td>Weather ID</td><td>int</td><td>weather_0_id</td><td></td></tr><tr><td>Weather Main</td><td>const char*</td><td>weather_0_main</td><td></td></tr><tr><td>Weather Description</td><td>const char*</td><td>weather_0_description</td><td></td></tr><tr><td>Weather Icon ID</td><td>const char*</td><td>weather_0_icon</td><td></td></tr><tr><td>Temperature</td><td>float</td><td>main_temp</td><td>℃</td></tr><tr><td>Temperature Max.</td><td>float</td><td>main_temp_max</td><td>℃</td></tr><tr><td>Temperature Min.</td><td>float</td><td>main_temp_min</td><td>℃</td></tr><tr><td>Pressure</td><td>int</td><td>main_pressure</td><td>hPa</td></tr><tr><td>Humidity</td><td>int</td><td>main_humidity</td><td>%</td></tr><tr><td>Visibility</td><td>int</td><td>visibility</td><td>m</td></tr><tr><td>Wind Speed</td><td>int</td><td>wind_speed</td><td>m/s</td></tr><tr><td>Wind Degree</td><td>int</td><td>wind_deg</td><td>º</td></tr><tr><td>Clouds</td><td>int</td><td>clouds_all</td><td></td></tr><tr><td>Sunrise</td><td>long</td><td>sys_sunrise</td><td></td></tr><tr><td>Sunset</td><td>long</td><td>sys_sunset</td><td></td></tr><tr><td>City ID</td><td>long</td><td>id</td><td></td></tr><tr><td>City name</td><td>const char*</td><td>name</td><td></td></tr><tr><td>Country</td><td>const char*</td><td>sys_country</td><td></td></tr><tr><td>Longitude</td><td>float</td><td>coord_lon</td><td>º</td></tr><tr><td>Latitude</td><td>float</td><td>coord_lat</td><td>º</td></tr><tr><td>GMT</td><td>int</td><td>timezone (※timezone/3600)</td><td>hour</td></tr><tr><td></td><td>int</td><td>sys_type</td><td></td></tr><tr><td></td><td>int</td><td>sys_id</td><td></td></tr><tr><td>Base</td><td>const char*</td><td>base</td><td></td></tr><tr><td>COD</td><td>int</td><td>cod</td><td></td></tr></tbody></table><br><br><h4 id=sketch-전체>sketch: 전체<a class=anchor href=#sketch-%ec%a0%84%ec%b2%b4>#</a></h4><p>위의 과정을 통해 만들진 부분 스케치를 병합하여 JSON 파싱을 위한 전체 스케치를 구성해봅니다.</p><blockquote class=book-hint><p>ArduinoJson 라이브러리의 경우 version 5와 6의 사용 문법이 조금 다릅니다. 현재 Arduino IDE에서 라이브러리 추가과정을 통해 다운로드 받을 수 있는 최신 라이브러리 버전이 ArduinoJson 6이므로, 이에 맞게 작성하여야합니다. (기존의 ArduinoJson 5에 맞게 작성된 스케치는 컴파일이 되지 않으므로, <a href=https://arduinojson.org/v6/doc/upgrade/>Migrating from version 5 to 6</a> 문서를 참고하여 스케치를 변경해야 합니다.)</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;WiFi.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;HTTPClient.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;ArduinoJson.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;TimeLib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span> 
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>ssid</span>     <span class=o>=</span> <span class=s>&#34;your ssid&#34;</span><span class=p>;</span>                  <span class=c1>// 연결할 SSID
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>password</span> <span class=o>=</span> <span class=s>&#34;your password&#34;</span><span class=p>;</span>              <span class=c1>// 연결할 SSID의 비밀번호
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>endpoint</span> <span class=o>=</span> <span class=s>&#34;https://api.openweathermap.org&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>ver</span> <span class=o>=</span> <span class=s>&#34;/data/2.5/weather?q=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>city</span> <span class=o>=</span> <span class=s>&#34;Shanghai,CN&#34;</span><span class=p>;</span>                 <span class=c1>// City,Country (띄어쓰기 금지)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>appid</span> <span class=o>=</span> <span class=s>&#34;&amp;units=metric&amp;APPID=&#34;</span><span class=p>;</span>       <span class=c1>// Units: metric
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>key</span> <span class=o>=</span> <span class=s>&#34;1bf3d5e1bd2e5934aadd86..........&#34;</span><span class=p>;</span>    <span class=c1>// API Key
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>offset_days</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>     <span class=c1>// 3 days for convert unix timestamp to datetime
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=mi>115200</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>WiFi</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=n>ssid</span><span class=p>,</span> <span class=n>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=n>WiFi</span><span class=p>.</span><span class=n>status</span><span class=p>()</span> <span class=o>!=</span> <span class=n>WL_CONNECTED</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>delay</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Connecting to WiFi..&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Connected to the WiFi network&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>((</span><span class=n>WiFi</span><span class=p>.</span><span class=n>status</span><span class=p>()</span> <span class=o>==</span> <span class=n>WL_CONNECTED</span><span class=p>))</span> <span class=p>{</span>      <span class=c1>// Check the current connection status
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    <span class=n>HTTPClient</span> <span class=n>http</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>http</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=n>endpoint</span> <span class=o>+</span> <span class=n>ver</span> <span class=o>+</span> <span class=n>city</span> <span class=o>+</span> <span class=n>appid</span> <span class=o>+</span> <span class=n>key</span><span class=p>);</span> <span class=c1>// Specify the URL
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>httpCode</span> <span class=o>=</span> <span class=n>http</span><span class=p>.</span><span class=n>GET</span><span class=p>();</span>                       <span class=c1>// Make the request
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>httpCode</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>                              <span class=c1>// Check for the returning code
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// 데이터 파싱
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=n>size_t</span> <span class=n>capacity</span> <span class=o>=</span> <span class=n>JSON_ARRAY_SIZE</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>13</span><span class=p>)</span> <span class=o>+</span> <span class=mi>270</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>DynamicJsonDocument</span> <span class=n>doc</span><span class=p>(</span><span class=n>capacity</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=n>http</span><span class=p>.</span><span class=n>getString</span><span class=p>();</span>                <span class=c1>// get JSON format data
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>deserializeJson</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>json</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=kt>float</span> <span class=n>coord_lon</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;coord&#34;</span><span class=p>][</span><span class=s>&#34;lon&#34;</span><span class=p>];</span> <span class=c1>// 121.49
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>float</span> <span class=n>coord_lat</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;coord&#34;</span><span class=p>][</span><span class=s>&#34;lat&#34;</span><span class=p>];</span> <span class=c1>// 31.23
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>JsonObject</span> <span class=n>weather_0</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;weather&#34;</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>weather_0_id</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;id&#34;</span><span class=p>];</span> <span class=c1>// 804
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>weather_0_main</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;main&#34;</span><span class=p>];</span> <span class=c1>// &#34;Clouds&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>weather_0_description</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;description&#34;</span><span class=p>];</span> <span class=c1>// &#34;overcast clouds&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>weather_0_icon</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;icon&#34;</span><span class=p>];</span> <span class=c1>// &#34;04d&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>      JsonObject weather_1 = weather[1];
</span></span></span><span class=line><span class=cl><span class=cm>      int weather_1_id = weather_1[&#34;id&#34;]; // 701
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_1_main = weather_1[&#34;main&#34;]; // &#34;Mist&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_1_description = weather_1[&#34;description&#34;]; // &#34;mist&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_1_icon = weather_1[&#34;icon&#34;]; // &#34;50n&#34;
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>      JsonObject weather_2 = weather[2];
</span></span></span><span class=line><span class=cl><span class=cm>      int weather_2_id = weather_2[&#34;id&#34;]; // 741
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_2_main = weather_2[&#34;main&#34;]; // &#34;Fog&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_2_description = weather_2[&#34;description&#34;]; // &#34;fog&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_2_icon = weather_2[&#34;icon&#34;]; // &#34;50n&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>base</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;base&#34;</span><span class=p>];</span> <span class=c1>// &#34;stations&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>JsonObject</span> <span class=n>main</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;main&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=kt>float</span> <span class=n>main_temp</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;temp&#34;</span><span class=p>];</span> <span class=c1>// 293.02
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>main_pressure</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;pressure&#34;</span><span class=p>];</span> <span class=c1>// 1027
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>main_humidity</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;humidity&#34;</span><span class=p>];</span> <span class=c1>// 55
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>float</span> <span class=n>main_temp_min</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;temp_min&#34;</span><span class=p>];</span> <span class=c1>// 289.82
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>float</span> <span class=n>main_temp_max</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;temp_max&#34;</span><span class=p>];</span> <span class=c1>// 298.71
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>visibility</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;visibility&#34;</span><span class=p>];</span> <span class=c1>// 10000
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>wind_speed</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;wind&#34;</span><span class=p>][</span><span class=s>&#34;speed&#34;</span><span class=p>];</span> <span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>wind_deg</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;wind&#34;</span><span class=p>][</span><span class=s>&#34;deg&#34;</span><span class=p>];</span> <span class=c1>// 60
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>clouds_all</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;clouds&#34;</span><span class=p>][</span><span class=s>&#34;all&#34;</span><span class=p>];</span> <span class=c1>// 94
</span></span></span><span class=line><span class=cl><span class=c1></span>      
</span></span><span class=line><span class=cl>      <span class=kt>long</span> <span class=n>dt</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;dt&#34;</span><span class=p>];</span> <span class=c1>// 1574303919
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>JsonObject</span> <span class=n>sys</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;sys&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>sys_type</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;type&#34;</span><span class=p>];</span> <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>sys_id</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;id&#34;</span><span class=p>];</span> <span class=c1>// 9659
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//float sys_message = sys[&#34;message&#34;]; // Internal parameter (0.0226)
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>sys_country</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;country&#34;</span><span class=p>];</span> <span class=c1>// &#34;CN&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>long</span> <span class=n>sys_sunrise</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;sunrise&#34;</span><span class=p>];</span> <span class=c1>// 1574288762
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>long</span> <span class=n>sys_sunset</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;sunset&#34;</span><span class=p>];</span> <span class=c1>// 1574326426
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>timezone</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;timezone&#34;</span><span class=p>];</span> <span class=c1>// 28800
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>long</span> <span class=n>id</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;id&#34;</span><span class=p>];</span> <span class=c1>// 1796236
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>name</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;name&#34;</span><span class=p>];</span> <span class=c1>// &#34;Shanghai&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>cod</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;cod&#34;</span><span class=p>];</span> <span class=c1>// 200
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>                <span class=c1>// for GMT+8 -&gt; +28800, for GMT+9 -&gt; +32400
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=n>sys_sunrise</span> <span class=o>=</span> <span class=n>sys_sunrise</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>sys_sunset</span> <span class=o>=</span> <span class=n>sys_sunset</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>//int main_sea_level = main[&#34;sea_level&#34;]; // Atmospheric pressure hPa on the sea level
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int main_grnd_level = main[&#34;grnd_level&#34;]; // Atmospheric pressure hPa on the ground level     
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int rain_1h = doc[&#34;rain&#34;][&#34;1h&#34;]; // Rain volume for the last 1 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int rain_3h = doc[&#34;rain&#34;][&#34;3h&#34;]; // Rain volume for the last 3 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int snow_1h = doc[&#34;snow&#34;][&#34;1h&#34;]; // Snow volume for the last 1 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int snow_3h = doc[&#34;snow&#34;][&#34;3h&#34;]; // Snow volume for the last 3 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=c1>//데이터 출력
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;UNIX Time of Weather: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>dt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>printf</span><span class=p>(</span><span class=s>&#34;Time of Weather: %4d-%02d-%02d %02d:%02d:%02d(%1d)</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>year</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>month</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>day</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>hour</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>minute</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>second</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>weekday</span><span class=p>(</span><span class=n>dt</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather ID: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather Main: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_main</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather Description: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_description</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather Icon: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_icon</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Temperature(℃): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_temp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Temperature Max(℃): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_temp_max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Temperature Min(℃): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_temp_min</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Pressure(hPa): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_pressure</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Humidity(%): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_humidity</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Visibility(m): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>visibility</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Wind Speed(m/s): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>wind_speed</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Wind Degree(º): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>wind_deg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Clouds: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>clouds_all</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>printf</span><span class=p>(</span><span class=s>&#34;Sunrise: %02d:%02d:%02d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>hour</span><span class=p>(</span><span class=n>sys_sunrise</span><span class=p>),</span> <span class=n>minute</span><span class=p>(</span><span class=n>sys_sunrise</span><span class=p>),</span> <span class=n>second</span><span class=p>(</span><span class=n>sys_sunrise</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>printf</span><span class=p>(</span><span class=s>&#34;Sunset:  %02d:%02d:%02d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>hour</span><span class=p>(</span><span class=n>sys_sunset</span><span class=p>),</span> <span class=n>minute</span><span class=p>(</span><span class=n>sys_sunset</span><span class=p>),</span> <span class=n>second</span><span class=p>(</span><span class=n>sys_sunset</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;City/Country: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>name</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>sys_country</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;longitude/latidude: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>coord_lon</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>coord_lat</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Timezone: GMT+&#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>timezone</span><span class=o>/</span><span class=mi>3600</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Sea Level(hPa): &#34;); Serial.println(main_sea_level);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Ground Level(hPa): &#34;); Serial.println(main_grnd_level);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Rain 1h(mm): &#34;); Serial.println(rain_1h);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Rain 3h(mm): &#34;); Serial.println(rain_3h);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Snow 1h(mm): &#34;); Serial.println(snow_1h);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Snow 3h(mm): &#34;); Serial.println(snow_3h);
</span></span></span><span class=line><span class=cl><span class=cm>      */</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Error on HTTP request&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>http</span><span class=p>.</span><span class=n>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>30000</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><br><h4 id=출력-data-1>출력 Data<a class=anchor href=#%ec%b6%9c%eb%a0%a5-data-1>#</a></h4><figure class=center style=width:75%><img src=/image/owm-03.png alt=/image/owm-03.png></figure><br><br><h3 id=weather-condition-code>Weather Condition Code<a class=anchor href=#weather-condition-code>#</a></h3><h4 id=group-2xx-thunderstorm>Group 2xx: Thunderstorm<a class=anchor href=#group-2xx-thunderstorm>#</a></h4><table><thead><tr><th>ID</th><th>Main</th><th>Description</th><th>Icon</th></tr></thead><tbody><tr><td>200</td><td>Thunderstorm</td><td>thunderstorm with light rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>201</td><td>Thunderstorm</td><td>thunderstorm with rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>202</td><td>Thunderstorm</td><td>thunderstorm with heavy rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>210</td><td>Thunderstorm</td><td>light thunderstorm</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>211</td><td>Thunderstorm</td><td>thunderstorm</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>212</td><td>Thunderstorm</td><td>heavy thunderstorm</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>221</td><td>Thunderstorm</td><td>ragged thunderstorm</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>230</td><td>Thunderstorm</td><td>thunderstorm with light drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>231</td><td>Thunderstorm</td><td>thunderstorm with drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr><tr><td>232</td><td>Thunderstorm</td><td>thunderstorm with heavy drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/11d@2x.png alt=img></figure>11d</td></tr></tbody></table><br><h4 id=group-3xx-drizzle>Group 3xx: Drizzle<a class=anchor href=#group-3xx-drizzle>#</a></h4><table><thead><tr><th>ID</th><th>Main</th><th>Description</th><th>Icon</th></tr></thead><tbody><tr><td>300</td><td>Drizzle</td><td>light intensity drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>301</td><td>Drizzle</td><td>drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>302</td><td>Drizzle</td><td>heavy intensity drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>310</td><td>Drizzle</td><td>light intensity drizzle rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>311</td><td>Drizzle</td><td>drizzle rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>312</td><td>Drizzle</td><td>heavy intensity drizzle rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>313</td><td>Drizzle</td><td>shower rain and drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>314</td><td>Drizzle</td><td>heavy shower rain and drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>321</td><td>Drizzle</td><td>shower drizzle</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr></tbody></table><br><h4 id=group-5xx-rain>Group 5xx: Rain<a class=anchor href=#group-5xx-rain>#</a></h4><table><thead><tr><th>ID</th><th>Main</th><th>Description</th><th>Icon</th></tr></thead><tbody><tr><td>500</td><td>Rain</td><td>light rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/10d@2x.png alt=img></figure>10d</td></tr><tr><td>501</td><td>Rain</td><td>moderate rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/10d@2x.png alt=img></figure>10d</td></tr><tr><td>502</td><td>Rain</td><td>heavy intensity rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/10d@2x.png alt=img></figure>10d</td></tr><tr><td>503</td><td>Rain</td><td>very heavy rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/10d@2x.png alt=img></figure>10d</td></tr><tr><td>504</td><td>Rain</td><td>extreme rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/10d@2x.png alt=img></figure>10d</td></tr><tr><td>511</td><td>Rain</td><td>freezing rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>520</td><td>Rain</td><td>light intensity shower rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>521</td><td>Rain</td><td>shower rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>522</td><td>Rain</td><td>heavy intensity shower rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr><tr><td>531</td><td>Rain</td><td>ragged shower rain</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/09d@2x.png alt=img></figure>09d</td></tr></tbody></table><br><h4 id=group-6xx-snow>Group 6xx: Snow<a class=anchor href=#group-6xx-snow>#</a></h4><table><thead><tr><th>ID</th><th>Main</th><th>Description</th><th>Icon</th></tr></thead><tbody><tr><td>600</td><td>Snow</td><td>light snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>601</td><td>Snow</td><td>Snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>602</td><td>Snow</td><td>Heavy snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>611</td><td>Snow</td><td>Sleet</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>612</td><td>Snow</td><td>Light shower sleet</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>613</td><td>Snow</td><td>Shower sleet</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>615</td><td>Snow</td><td>Light rain and snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>616</td><td>Snow</td><td>Rain and snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>620</td><td>Snow</td><td>Light shower snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>621</td><td>Snow</td><td>Shower snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr><tr><td>622</td><td>Snow</td><td>Heavy shower snow</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/13d@2x.png alt=img></figure>13d</td></tr></tbody></table><br><h4 id=group-7xx-atmosphere>Group 7xx: Atmosphere<a class=anchor href=#group-7xx-atmosphere>#</a></h4><table><thead><tr><th>ID</th><th>Main</th><th>Description</th><th>Icon</th></tr></thead><tbody><tr><td>701</td><td>Mist</td><td>mist</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>711</td><td>Smoke</td><td>Smoke</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>721</td><td>Haze</td><td>Haze</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>731</td><td>Dust</td><td>sand/ dust whirls</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>741</td><td>Fog</td><td>fog</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>751</td><td>Sand</td><td>sand</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>761</td><td>Dust</td><td>dust</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>762</td><td>Ash</td><td>volcanic ash</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>771</td><td>Squall</td><td>squalls</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr><tr><td>781</td><td>Tornado</td><td>tornado</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/50d@2x.png alt=img></figure>50d</td></tr></tbody></table><br><h4 id=group-800-clear>Group 800: Clear<a class=anchor href=#group-800-clear>#</a></h4><table><thead><tr><th>ID</th><th>Main</th><th>Description</th><th>Icon</th></tr></thead><tbody><tr><td>800</td><td>Clear</td><td>clear sky</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/01d@2x.png alt=img></figure>01n</td></tr></tbody></table><br><h4 id=group-80x-clouds>Group 80x: Clouds<a class=anchor href=#group-80x-clouds>#</a></h4><table><thead><tr><th>ID</th><th>Main</th><th>Description</th><th>Icon</th></tr></thead><tbody><tr><td>801</td><td>Clouds</td><td>few clouds: 11-25%</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/02d@2x.png alt=img></figure>02n</td></tr><tr><td>802</td><td>Clouds</td><td>scattered clouds: 25-50%</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/03d@2x.png alt=img></figure>03n</td></tr><tr><td>803</td><td>Clouds</td><td>broken clouds: 51-84%</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/04d@2x.png alt=img></figure>04n</td></tr><tr><td>804</td><td>Clouds</td><td>overcast clouds: 85-100%</td><td><figure class=center style=width:50%><img src=http://openweathermap.org/img/wn/04d@2x.png alt=img></figure>04n</td></tr></tbody></table><br><h4 id=icon-출력방법>ICON 출력방법<a class=anchor href=#icon-%ec%b6%9c%eb%a0%a5%eb%b0%a9%eb%b2%95>#</a></h4><p>Weather ID 801에 해당하는 아이콘 code가 02d이므로 URL을 다음과 같이 지정하면</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>http://openweathermap.org/img/wn/10d.png</span></span></code></pre></div><figure class=center style=width:10%><img src=http://openweathermap.org/img/wn/10d.png alt=http://openweathermap.org/img/wn/10d.png></figure><p>ICON크기를 크게 출력하고 싶은 경우에는 아이콘 code에 <strong>@2x</strong>를 덧붙입니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>http://openweathermap.org/img/wn/10d@2x.png</span></span></code></pre></div><figure class=center style=width:10%><img src=http://openweathermap.org/img/wn/10d@2x.png alt=http://openweathermap.org/img/wn/10d@2x.png></figure><br><br><h3 id=1602-lcd에-날씨-정보-출력하기>1602 LCD에 날씨 정보 출력하기<a class=anchor href=#1602-lcd%ec%97%90-%eb%82%a0%ec%94%a8-%ec%a0%95%eb%b3%b4-%ec%b6%9c%eb%a0%a5%ed%95%98%ea%b8%b0>#</a></h3><p>여러가지 날씨 정보 중에서 현재 온도를 1602 LCD(I2C)에 출력해보겠습니다.</p><br><h4 id=라이브러리-설치하기>라이브러리 설치하기<a class=anchor href=#%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac-%ec%84%a4%ec%b9%98%ed%95%98%ea%b8%b0>#</a></h4><p><strong>스케치</strong>> <strong>라이브러리 포함하기</strong>> <strong>라이브러리 관리</strong></p><ul><li>LiquidCrystal I2C (by Frank de Brabander) 검색하여 설치</li></ul><br><h4 id=schematic>schematic<a class=anchor href=#schematic>#</a></h4><figure class=center style=width:75%><img src=/image/owm-06.png alt=/image/owm-06.png></figure><br><h4 id=sketch-1>sketch<a class=anchor href=#sketch-1>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;WiFi.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;HTTPClient.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;ArduinoJson.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;TimeLib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>ssid</span>     <span class=o>=</span> <span class=s>&#34;your ssid&#34;</span><span class=p>;</span>                  <span class=c1>// 연결할 SSID
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>password</span> <span class=o>=</span> <span class=s>&#34;your password&#34;</span><span class=p>;</span>              <span class=c1>// 연결할 SSID의 비밀번호
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>endpoint</span> <span class=o>=</span> <span class=s>&#34;https://api.openweathermap.org&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>ver</span> <span class=o>=</span> <span class=s>&#34;/data/2.5/weather?q=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>String</span> <span class=n>city</span> <span class=o>=</span> <span class=s>&#34;Shanghai,CN&#34;</span><span class=p>;</span>                 <span class=c1>// City,Country (띄어쓰기 금지)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>appid</span> <span class=o>=</span> <span class=s>&#34;&amp;units=metric&amp;APPID=&#34;</span><span class=p>;</span>       <span class=c1>// Units: metric
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>String</span> <span class=n>key</span> <span class=o>=</span> <span class=s>&#34;1bf3d5e1bd2e5934aadd86..........&#34;</span><span class=p>;</span>    <span class=c1>// API Key
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>offset_days</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>                            <span class=c1>// 3 days for convert unix timestamp to datetime
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>float</span> <span class=n>main_temp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// set the LCD
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;LiquidCrystal_I2C.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>lcdColumns</span> <span class=o>=</span> <span class=mi>16</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>lcdRows</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// set LCD address, number of columns and rows
</span></span></span><span class=line><span class=cl><span class=c1>// if you don&#39;t know your display address, run an I2C scanner sketch
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>LiquidCrystal_I2C</span> <span class=nf>lcd</span><span class=p>(</span><span class=mh>0x27</span><span class=p>,</span> <span class=n>lcdColumns</span><span class=p>,</span> <span class=n>lcdRows</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=mi>115200</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>WiFi</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=n>ssid</span><span class=p>,</span> <span class=n>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=n>WiFi</span><span class=p>.</span><span class=n>status</span><span class=p>()</span> <span class=o>!=</span> <span class=n>WL_CONNECTED</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>delay</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Connecting to WiFi..&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Connected to the WiFi network&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// initialize LCD
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>lcd</span><span class=p>.</span><span class=n>init</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=c1>// turn on LCD backlight                      
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>lcd</span><span class=p>.</span><span class=n>backlight</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>((</span><span class=n>WiFi</span><span class=p>.</span><span class=n>status</span><span class=p>()</span> <span class=o>==</span> <span class=n>WL_CONNECTED</span><span class=p>))</span> <span class=p>{</span>            <span class=c1>// Check the current connection status
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    <span class=n>HTTPClient</span> <span class=n>http</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>http</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=n>endpoint</span> <span class=o>+</span> <span class=n>ver</span> <span class=o>+</span> <span class=n>city</span> <span class=o>+</span> <span class=n>appid</span> <span class=o>+</span> <span class=n>key</span><span class=p>);</span> <span class=c1>// Specify the URL
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>httpCode</span> <span class=o>=</span> <span class=n>http</span><span class=p>.</span><span class=n>GET</span><span class=p>();</span>                       <span class=c1>// Make the request
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>httpCode</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>                              <span class=c1>// Check for the returning code
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// 데이터 파싱
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=n>size_t</span> <span class=n>capacity</span> <span class=o>=</span> <span class=n>JSON_ARRAY_SIZE</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>JSON_OBJECT_SIZE</span><span class=p>(</span><span class=mi>13</span><span class=p>)</span> <span class=o>+</span> <span class=mi>270</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>DynamicJsonDocument</span> <span class=n>doc</span><span class=p>(</span><span class=n>capacity</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=n>http</span><span class=p>.</span><span class=n>getString</span><span class=p>();</span>                <span class=c1>// get JSON format data
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>deserializeJson</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>json</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=kt>float</span> <span class=n>coord_lon</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;coord&#34;</span><span class=p>][</span><span class=s>&#34;lon&#34;</span><span class=p>];</span> <span class=c1>// 121.49
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>float</span> <span class=n>coord_lat</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;coord&#34;</span><span class=p>][</span><span class=s>&#34;lat&#34;</span><span class=p>];</span> <span class=c1>// 31.23
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>JsonObject</span> <span class=n>weather_0</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;weather&#34;</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>weather_0_id</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;id&#34;</span><span class=p>];</span> <span class=c1>// 804
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>weather_0_main</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;main&#34;</span><span class=p>];</span> <span class=c1>// &#34;Clouds&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>weather_0_description</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;description&#34;</span><span class=p>];</span> <span class=c1>// &#34;overcast clouds&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>weather_0_icon</span> <span class=o>=</span> <span class=n>weather_0</span><span class=p>[</span><span class=s>&#34;icon&#34;</span><span class=p>];</span> <span class=c1>// &#34;04d&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>      JsonObject weather_1 = weather[1];
</span></span></span><span class=line><span class=cl><span class=cm>      int weather_1_id = weather_1[&#34;id&#34;]; // 701
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_1_main = weather_1[&#34;main&#34;]; // &#34;Mist&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_1_description = weather_1[&#34;description&#34;]; // &#34;mist&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_1_icon = weather_1[&#34;icon&#34;]; // &#34;50n&#34;
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>      JsonObject weather_2 = weather[2];
</span></span></span><span class=line><span class=cl><span class=cm>      int weather_2_id = weather_2[&#34;id&#34;]; // 741
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_2_main = weather_2[&#34;main&#34;]; // &#34;Fog&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_2_description = weather_2[&#34;description&#34;]; // &#34;fog&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      const char* weather_2_icon = weather_2[&#34;icon&#34;]; // &#34;50n&#34;
</span></span></span><span class=line><span class=cl><span class=cm>      */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>base</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;base&#34;</span><span class=p>];</span> <span class=c1>// &#34;stations&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>JsonObject</span> <span class=n>main</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;main&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=kt>float</span> <span class=n>main_temp</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;temp&#34;</span><span class=p>];</span> <span class=c1>// 293.02
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>main_pressure</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;pressure&#34;</span><span class=p>];</span> <span class=c1>// 1027
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>main_humidity</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;humidity&#34;</span><span class=p>];</span> <span class=c1>// 55
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>float</span> <span class=n>main_temp_min</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;temp_min&#34;</span><span class=p>];</span> <span class=c1>// 289.82
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>float</span> <span class=n>main_temp_max</span> <span class=o>=</span> <span class=n>main</span><span class=p>[</span><span class=s>&#34;temp_max&#34;</span><span class=p>];</span> <span class=c1>// 298.71
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>visibility</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;visibility&#34;</span><span class=p>];</span> <span class=c1>// 10000
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>wind_speed</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;wind&#34;</span><span class=p>][</span><span class=s>&#34;speed&#34;</span><span class=p>];</span> <span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>wind_deg</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;wind&#34;</span><span class=p>][</span><span class=s>&#34;deg&#34;</span><span class=p>];</span> <span class=c1>// 60
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>clouds_all</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;clouds&#34;</span><span class=p>][</span><span class=s>&#34;all&#34;</span><span class=p>];</span> <span class=c1>// 94
</span></span></span><span class=line><span class=cl><span class=c1></span>      
</span></span><span class=line><span class=cl>      <span class=kt>long</span> <span class=n>dt</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;dt&#34;</span><span class=p>];</span> <span class=c1>// 1574303919
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>JsonObject</span> <span class=n>sys</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;sys&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>sys_type</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;type&#34;</span><span class=p>];</span> <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>sys_id</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;id&#34;</span><span class=p>];</span> <span class=c1>// 9659
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//float sys_message = sys[&#34;message&#34;]; // Internal parameter (0.0226)
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>sys_country</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;country&#34;</span><span class=p>];</span> <span class=c1>// &#34;CN&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>long</span> <span class=n>sys_sunrise</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;sunrise&#34;</span><span class=p>];</span> <span class=c1>// 1574288762
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>long</span> <span class=n>sys_sunset</span> <span class=o>=</span> <span class=n>sys</span><span class=p>[</span><span class=s>&#34;sunset&#34;</span><span class=p>];</span> <span class=c1>// 1574326426
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=kt>int</span> <span class=n>timezone</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;timezone&#34;</span><span class=p>];</span> <span class=c1>// 28800
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>long</span> <span class=n>id</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;id&#34;</span><span class=p>];</span> <span class=c1>// 1796236
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>name</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;name&#34;</span><span class=p>];</span> <span class=c1>// &#34;Shanghai&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>cod</span> <span class=o>=</span> <span class=n>doc</span><span class=p>[</span><span class=s>&#34;cod&#34;</span><span class=p>];</span> <span class=c1>// 200
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>                     <span class=c1>// for GMT+8 -&gt; +28800, for GMT+9 -&gt; +32400
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=n>sys_sunrise</span> <span class=o>=</span> <span class=n>sys_sunrise</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>sys_sunset</span> <span class=o>=</span> <span class=n>sys_sunset</span> <span class=o>+</span> <span class=n>timezone</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>//int main_sea_level = main[&#34;sea_level&#34;]; // Atmospheric pressure hPa on the sea level
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int main_grnd_level = main[&#34;grnd_level&#34;]; // Atmospheric pressure hPa on the ground level     
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int rain_1h = doc[&#34;rain&#34;][&#34;1h&#34;]; // Rain volume for the last 1 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int rain_3h = doc[&#34;rain&#34;][&#34;3h&#34;]; // Rain volume for the last 3 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int snow_1h = doc[&#34;snow&#34;][&#34;1h&#34;]; // Snow volume for the last 1 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>//int snow_3h = doc[&#34;snow&#34;][&#34;3h&#34;]; // Snow volume for the last 3 hour, mm
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>      <span class=c1>//데이터 출력
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;UNIX Time of Weather: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>dt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>printf</span><span class=p>(</span><span class=s>&#34;Time of Weather: %4d-%02d-%02d %02d:%02d:%02d(%1d)</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>year</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>month</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>day</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>hour</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>minute</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>second</span><span class=p>(</span><span class=n>dt</span><span class=p>),</span> <span class=n>weekday</span><span class=p>(</span><span class=n>dt</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather ID: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather Main: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_main</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather Description: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_description</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Weather Icon: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>weather_0_icon</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Temperature(℃): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_temp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Temperature Max(℃): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_temp_max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Temperature Min(℃): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_temp_min</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Pressure(hPa): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_pressure</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Humidity(%): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>main_humidity</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Visibility(m): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>visibility</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Wind Speed(m/s): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>wind_speed</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Wind Degree(º): &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>wind_deg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Clouds: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>clouds_all</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>printf</span><span class=p>(</span><span class=s>&#34;Sunrise: %02d:%02d:%02d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>hour</span><span class=p>(</span><span class=n>sys_sunrise</span><span class=p>),</span> <span class=n>minute</span><span class=p>(</span><span class=n>sys_sunrise</span><span class=p>),</span> <span class=n>second</span><span class=p>(</span><span class=n>sys_sunrise</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>printf</span><span class=p>(</span><span class=s>&#34;Sunset:  %02d:%02d:%02d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>hour</span><span class=p>(</span><span class=n>sys_sunset</span><span class=p>),</span> <span class=n>minute</span><span class=p>(</span><span class=n>sys_sunset</span><span class=p>),</span> <span class=n>second</span><span class=p>(</span><span class=n>sys_sunset</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;City/Country: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>name</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>sys_country</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;longitude/latidude: &#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>coord_lon</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>coord_lat</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Timezone: GMT+&#34;</span><span class=p>);</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>timezone</span><span class=o>/</span><span class=mi>3600</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Sea Level(hPa): &#34;); Serial.println(main_sea_level);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Ground Level(hPa): &#34;); Serial.println(main_grnd_level);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Rain 1h(mm): &#34;); Serial.println(rain_1h);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Rain 3h(mm): &#34;); Serial.println(rain_3h);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Snow 1h(mm): &#34;); Serial.println(snow_1h);
</span></span></span><span class=line><span class=cl><span class=cm>      Serial.print(&#34;Snow 3h(mm): &#34;); Serial.println(snow_3h);
</span></span></span><span class=line><span class=cl><span class=cm>      */</span>
</span></span><span class=line><span class=cl>      <span class=n>lcd</span><span class=p>.</span><span class=n>setCursor</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>lcd</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Temperature : &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>lcd</span><span class=p>.</span><span class=n>setCursor</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>lcd</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>main_temp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;Error on HTTP request&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>http</span><span class=p>.</span><span class=n>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>30000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>lcd</span><span class=p>.</span><span class=n>setCursor</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>lcd</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;                &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><blockquote class=book-hint><p>Arduino IDE에서 컴파일시 *&ldquo;&ldquo;경고: 라이브러리 LiquidCrystal_I2C가 avr 아키텍처에서 실행되며 esp32아키텍처에서 실행되는 현재보드에서는 호환되지 않을 수 있습니다.&rdquo;"*라는 메세지가 나타나지만, LCD 출력에는 문제가 없습니다.</p></blockquote><br><br><h3 id=공공데이터-활용하기>공공데이터 활용하기<a class=anchor href=#%ea%b3%b5%ea%b3%b5%eb%8d%b0%ec%9d%b4%ed%84%b0-%ed%99%9c%ec%9a%a9%ed%95%98%ea%b8%b0>#</a></h3><p>위의 방법을 응용하면 국가별, 관련 업체별로 제공되는 여러가지 공공데이터를 활용할 수 있습니다.</p><ul><li>대기질 관련 데이터 : <a href=https://aqicn.org/api/>https://aqicn.org/api/</a></li><li>(한국)공공데이터포털 : <a href=https://www.data.go.kr/>https://www.data.go.kr/</a></li><li>(미국)공공데이터포털 : <a href=https://www.data.gov/>https://www.data.gov/</a></li></ul><p>그밖에 활용가능한 공공데이터가 어떤 것이 있는지, 살펴보세요~</p></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a href=/posts/arduino-geiger-counter/ class="flex align-center"><img src=/icons/backward.svg class=book-icon alt=Previous title="Arduino, Geiger Counter">
<span>Arduino, Geiger Counter</span></a></div><div><a href=/posts/%EC%97%91%EC%85%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9C%A0%ED%9A%A8%EC%84%B1%EA%B2%80%EC%82%AC-%EB%8F%99%EC%A0%81%EB%B2%94%EC%9C%84%EC%84%A4%EC%A0%95/ class="flex align-center"><span>엑셀, 데이터 유효성 검사의 목록 구성시 동적 범위 설정</span>
<img src=/icons/forward.svg class=book-icon alt=Next title="엑셀, 데이터 유효성 검사의 목록 구성시 동적 범위 설정"></a></div></div><div class=book-comments></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#openweathermaporg>OpenWeatherMap.org</a></li><li><a href=#esp32에서-사용하는-경우>ESP32에서 사용하는 경우</a></li><li><a href=#json-parsing>JSON Parsing</a></li><li><a href=#weather-condition-code>Weather Condition Code</a></li><li><a href=#1602-lcd에-날씨-정보-출력하기>1602 LCD에 날씨 정보 출력하기</a></li><li><a href=#공공데이터-활용하기>공공데이터 활용하기</a></li></ul></li></ul></nav></div></aside></main></body></html>